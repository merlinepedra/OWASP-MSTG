
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo_circle.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>iOS Basic Security Testing - OWASP Mobile Security Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ios-basic-security-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OWASP Mobile Security Project" class="md-header__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Mobile Security Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              iOS Basic Security Testing
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../donate/" class="md-tabs__link">
      ♡ Donations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../news/" class="md-tabs__link">
      News
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0x01-Foreword/" class="md-tabs__link md-tabs__link--active">
        MSTG
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Mobile Security Project" class="md-nav__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    OWASP Mobile Security Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../donate/" class="md-nav__link">
        ♡ Donations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        News
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          MSTG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSTG" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          MSTG
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x01-Foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02a-Frontispiece/" class="md-nav__link">
        Frontispiece
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02b-MASVS-MSTG-Adoption/" class="md-nav__link">
        OWASP MASVS and MSTG Adoption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02c-Acknowledgements/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x03-Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04a-Mobile-App-Taxonomy/" class="md-nav__link">
        Mobile App Taxonomy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04b-Mobile-App-Security-Testing/" class="md-nav__link">
        Mobile App Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04c-Tampering-and-Reverse-Engineering/" class="md-nav__link">
        Mobile App Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04e-Testing-Authentication-and-Session-Management/" class="md-nav__link">
        Mobile App Authentication Architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04f-Testing-Network-Communication/" class="md-nav__link">
        Mobile App Network Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04g-Testing-Cryptography/" class="md-nav__link">
        Mobile App Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04h-Testing-Code-Quality/" class="md-nav__link">
        Mobile App Code Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04i-Testing-User-Privacy-Protection/" class="md-nav__link">
        Mobile App User Privacy Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05a-Platform-Overview/" class="md-nav__link">
        Android Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05b-Basic-Security_Testing/" class="md-nav__link">
        Android Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        Android Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05d-Testing-Data-Storage/" class="md-nav__link">
        Android Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05e-Testing-Cryptography/" class="md-nav__link">
        Android Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05f-Testing-Local-Authentication/" class="md-nav__link">
        Android Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05g-Testing-Network-Communication/" class="md-nav__link">
        Android Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05h-Testing-Platform-Interaction/" class="md-nav__link">
        Android Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        Android Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        Android Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06a-Platform-Overview/" class="md-nav__link">
        iOS Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          iOS Basic Security Testing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        iOS Basic Security Testing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ios-testing-setup" class="md-nav__link">
    iOS Testing Setup
  </a>
  
    <nav class="md-nav" aria-label="iOS Testing Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-device" class="md-nav__link">
    Host Device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-device" class="md-nav__link">
    Testing Device
  </a>
  
    <nav class="md-nav" aria-label="Testing Device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-on-a-real-device" class="md-nav__link">
    Testing on a Real Device
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-on-the-ios-simulator" class="md-nav__link">
    Testing on the iOS Simulator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-on-an-emulator" class="md-nav__link">
    Testing on an Emulator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-privileged-access" class="md-nav__link">
    Getting Privileged Access
  </a>
  
    <nav class="md-nav" aria-label="Getting Privileged Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benefits-of-jailbreaking" class="md-nav__link">
    Benefits of Jailbreaking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jailbreak-types" class="md-nav__link">
    Jailbreak Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jailbreak-device-strategy" class="md-nav__link">
    Jailbreak Device Strategy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jailbreak-software" class="md-nav__link">
    Jailbreak Software
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-jailbreak-detection" class="md-nav__link">
    Testing Jailbreak Detection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-the-udid-of-an-ios-device" class="md-nav__link">
    Getting the UDID of an iOS device
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-testing-operations" class="md-nav__link">
    Basic Testing Operations
  </a>
  
    <nav class="md-nav" aria-label="Basic Testing Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-the-device-shell" class="md-nav__link">
    Accessing the Device Shell
  </a>
  
    <nav class="md-nav" aria-label="Accessing the Device Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remote-shell" class="md-nav__link">
    Remote Shell
  </a>
  
    <nav class="md-nav" aria-label="Remote Shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connect-to-a-device-via-ssh-over-usb" class="md-nav__link">
    Connect to a Device via SSH over USB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-device-shell-app" class="md-nav__link">
    On-device Shell App
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-device-data-transfer" class="md-nav__link">
    Host-Device Data Transfer
  </a>
  
    <nav class="md-nav" aria-label="Host-Device Data Transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copying-app-data-files-via-ssh-and-scp" class="md-nav__link">
    Copying App Data Files via SSH and SCP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passionfruit" class="md-nav__link">
    Passionfruit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objection" class="md-nav__link">
    Objection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtaining-and-extracting-apps" class="md-nav__link">
    Obtaining and Extracting Apps
  </a>
  
    <nav class="md-nav" aria-label="Obtaining and Extracting Apps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-the-ipa-file-from-an-ota-distribution-link" class="md-nav__link">
    Getting the IPA File from an OTA Distribution Link
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acquiring-the-app-binary" class="md-nav__link">
    Acquiring the App Binary
  </a>
  
    <nav class="md-nav" aria-label="Acquiring the App Binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-clutch" class="md-nav__link">
    Using Clutch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-frida-ios-dump" class="md-nav__link">
    Using Frida-ios-dump
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-apps" class="md-nav__link">
    Installing Apps
  </a>
  
    <nav class="md-nav" aria-label="Installing Apps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cydia-impactor" class="md-nav__link">
    Cydia Impactor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libimobiledevice" class="md-nav__link">
    libimobiledevice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipainstaller" class="md-nav__link">
    ipainstaller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ios-deploy" class="md-nav__link">
    ios-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcode" class="md-nav__link">
    Xcode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow-application-installation-on-a-non-ipad-device" class="md-nav__link">
    Allow Application Installation on a Non-iPad Device
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#information-gathering" class="md-nav__link">
    Information Gathering
  </a>
  
    <nav class="md-nav" aria-label="Information Gathering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-installed-apps" class="md-nav__link">
    Listing Installed Apps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploring-the-app-package" class="md-nav__link">
    Exploring the App Package
  </a>
  
    <nav class="md-nav" aria-label="Exploring the App Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-infoplist-file" class="md-nav__link">
    The Info.plist File
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app-binary" class="md-nav__link">
    App Binary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-libraries" class="md-nav__link">
    Native Libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-app-resources" class="md-nav__link">
    Other App Resources
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-app-data-directories" class="md-nav__link">
    Accessing App Data Directories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-system-logs" class="md-nav__link">
    Monitoring System Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumping-keychain-data" class="md-nav__link">
    Dumping KeyChain Data
  </a>
  
    <nav class="md-nav" aria-label="Dumping KeyChain Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objection-jailbroken-non-jailbroken" class="md-nav__link">
    Objection (Jailbroken / non-Jailbroken)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passionfruit-jailbroken-non-jailbroken" class="md-nav__link">
    Passionfruit (Jailbroken / non-Jailbroken)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keychain-dumper-jailbroken" class="md-nav__link">
    Keychain-dumper (Jailbroken)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-network-testing-environment" class="md-nav__link">
    Setting Up a Network Testing Environment
  </a>
  
    <nav class="md-nav" aria-label="Setting Up a Network Testing Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-network-monitoringsniffing" class="md-nav__link">
    Basic Network Monitoring/Sniffing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-an-interception-proxy" class="md-nav__link">
    Setting up an Interception Proxy
  </a>
  
    <nav class="md-nav" aria-label="Setting up an Interception Proxy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-burp-via-usb-on-a-jailbroken-device" class="md-nav__link">
    Using Burp via USB on a Jailbroken Device
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-pinning" class="md-nav__link">
    Certificate Pinning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        iOS Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06d-Testing-Data-Storage/" class="md-nav__link">
        iOS Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06e-Testing-Cryptography/" class="md-nav__link">
        iOS Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06f-Testing-Local-Authentication/" class="md-nav__link">
        iOS Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06g-Testing-Network-Communication/" class="md-nav__link">
        iOS Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06h-Testing-Platform-Interaction/" class="md-nav__link">
        iOS Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        iOS Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        iOS Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x07-Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x08-Testing-Tools/" class="md-nav__link">
        Testing Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x09-Suggested-Reading/" class="md-nav__link">
        Suggested Reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-nav__link">
        How Can You Contribute?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/2_Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/3_PRs_and_Reviews/" class="md-nav__link">
        Pull Requests & Reviews
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/4_Add_new_Language/" class="md-nav__link">
        Add a New Language
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/5_Style_Guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/OWASP/owasp-mstg/edit/master/docs/MSTG/0x06b-Basic-Security-Testing.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="ios-basic-security-testing">iOS Basic Security Testing<a class="headerlink" href="#ios-basic-security-testing" title="Permanent link">&para;</a></h1>
<p>In the previous chapter, we provided an overview of the iOS platform and described the structure of its apps. In this chapter, we'll talk about setting up a security testing environment and introduce basic processes and techniques you can use to test iOS apps for security flaws. These basic processes are the foundation for the test cases outlined in the following chapters.</p>
<h2 id="ios-testing-setup">iOS Testing Setup<a class="headerlink" href="#ios-testing-setup" title="Permanent link">&para;</a></h2>
<p>Although you can use a Linux or Windows host computer for testing, you'll find that many tasks are difficult or impossible on these platforms. In addition, the Xcode development environment and the iOS SDK are only available for macOS. This means that you'll definitely want to work on macOS for source code analysis and debugging (it also makes black box testing easier).</p>
<h3 id="host-device">Host Device<a class="headerlink" href="#host-device" title="Permanent link">&para;</a></h3>
<p>The following is the most basic iOS app testing setup:</p>
<ul>
<li>Ideally macOS host computer with admin rights.</li>
<li><a href="../0x08-Testing-Tools/#xcode">Xcode</a> and <a href="../0x08-Testing-Tools/#xcode-command-line-tools">Xcode Command Line Tools</a>.</li>
<li>An interception proxy tool such as <a href="../0x08-Testing-Tools/#burp-suite">Burp Suite</a>.</li>
<li><a href="../0x08-Testing-Tools/#frida">Frida via python-pip</a></li>
<li>At least one jailbroken iOS device (with the target iOS version installed).</li>
<li><a href="../0x08-Testing-Tools/#frida-for-ios">Frida for iOS</a></li>
<li>A Wi-Fi network that permits client-to-client traffic.</li>
</ul>
<h3 id="testing-device">Testing Device<a class="headerlink" href="#testing-device" title="Permanent link">&para;</a></h3>
<h4 id="testing-on-a-real-device">Testing on a Real Device<a class="headerlink" href="#testing-on-a-real-device" title="Permanent link">&para;</a></h4>
<p>We recommend having a jailbroken iPhone or iPad for testing. These devices allow root access and tool installation, making the security testing process more straightforward. See the next section <a href="#getting-privileged-access">"Getting Privileged Access"</a> for more information.</p>
<p>If you don't have access to a jailbroken device, you can apply the workarounds described later in this chapter, but be prepared for a more difficult experience.</p>
<h4 id="testing-on-the-ios-simulator">Testing on the iOS Simulator<a class="headerlink" href="#testing-on-the-ios-simulator" title="Permanent link">&para;</a></h4>
<p>Unlike the Android emulator, which fully emulates the hardware of an actual Android device, the iOS SDK simulator offers a higher-level <em>simulation</em> of an iOS device. Most importantly, emulator binaries are compiled to x86 code instead of ARM code. Apps compiled for a real device don't run, making the simulator useless for black box analysis and reverse engineering.</p>
<h4 id="testing-on-an-emulator">Testing on an Emulator<a class="headerlink" href="#testing-on-an-emulator" title="Permanent link">&para;</a></h4>
<p><a href="../0x06c-Reverse-Engineering-and-Tampering/#corellium">Corellium</a> is the only publicly available iOS emulator. It is an enterprise SaaS solution with a per user license model and does not offer community licenses.</p>
<h4 id="getting-privileged-access">Getting Privileged Access<a class="headerlink" href="#getting-privileged-access" title="Permanent link">&para;</a></h4>
<p>iOS jailbreaking is often compared to Android rooting, but the process is actually quite different. To explain the difference, we'll first review the concepts of "rooting" and "flashing" on Android.</p>
<ul>
<li><strong>Rooting</strong>: This typically involves installing the <code>su</code> binary on the system or replacing the whole system with a rooted custom ROM. Exploits aren't required to obtain root access as long as the bootloader is accessible.</li>
<li><strong>Flashing custom ROMs</strong>: This allows you to replace the OS that's running on the device after you unlock the bootloader. The bootloader may require an exploit to unlock it.</li>
</ul>
<p>On iOS devices, flashing a custom ROM is impossible because the iOS bootloader only allows Apple-signed images to be booted and flashed. This is why even official iOS images can't be installed if they aren't signed by Apple, and it makes iOS downgrades only possible for as long as the previous iOS version is still signed.</p>
<p>The purpose of jailbreaking is to disable iOS protections (Apple's code signing mechanisms in particular) so that arbitrary unsigned code can run on the device (e.g. custom code or downloaded from alternative app stores such as <a href="../0x08-Testing-Tools/#cydia">Cydia</a> or <a href="../0x08-Testing-Tools/#sileo">Sileo</a>). The word "jailbreak" is a colloquial reference to all-in-one tools that automate the disabling process.</p>
<p>Developing a jailbreak for a given version of iOS is not easy. As a security tester, you'll most likely want to use publicly available jailbreak tools. Still, we recommend studying the techniques that have been used to jailbreak various versions of iOS-you'll encounter many interesting exploits and learn a lot about OS internals. For example, Pangu9 for iOS 9.x <a href="https://www.theiphonewiki.com/wiki/Jailbreak_Exploits" title="Jailbreak Exploits">exploited at least five vulnerabilities</a>, including a use-after-free kernel bug (CVE-2015-6794) and an arbitrary file system access vulnerability in the Photos app (CVE-2015-7037).</p>
<h5 id="benefits-of-jailbreaking">Benefits of Jailbreaking<a class="headerlink" href="#benefits-of-jailbreaking" title="Permanent link">&para;</a></h5>
<p>End users often jailbreak their devices to tweak the iOS system's appearance, add new features, and install third-party apps from unofficial app stores. For a security tester, however, jailbreaking an iOS device has even more benefits. They include, but aren't limited to, the following:</p>
<ul>
<li>Root access to the file system.</li>
<li>Possibility of executing applications that haven't been signed by Apple (which includes many security tools).</li>
<li>Unrestricted debugging and dynamic analysis.</li>
<li>Access to the Objective-C or Swift runtime.</li>
</ul>
<h5 id="jailbreak-types">Jailbreak Types<a class="headerlink" href="#jailbreak-types" title="Permanent link">&para;</a></h5>
<p>There are <em>tethered</em>, <em>semi-tethered</em>, <em>semi-untethered</em>, and <em>untethered</em> jailbreaks.</p>
<ul>
<li>
<p>Tethered jailbreaks don't persist through reboots, so re-applying jailbreaks requires the device to be connected (tethered) to a computer during every reboot. The device may not reboot at all if the computer is not connected.</p>
</li>
<li>
<p>Semi-tethered jailbreaks can't be re-applied unless the device is connected to a computer during reboot. The device can also boot into non-jailbroken mode on its own.</p>
</li>
<li>
<p>Semi-untethered jailbreaks allow the device to boot on its own, but the kernel patches (or user-land modifications) for disabling code signing aren't applied automatically. The user must re-jailbreak the device by starting an app or visiting a website (not requiring a connection to a computer, hence the term untethered).</p>
</li>
<li>
<p>Untethered jailbreaks are the most popular choice for end users because they need to be applied only once, after which the device will be permanently jailbroken. They are usually rare and benefit from vulnerabilities allowing an exploit to write persistent code on the device. Examples include <a href="https://www.theiphonewiki.com/wiki/Limera1n">limera1n</a>, <a href="https://www.theiphonewiki.com/wiki/Pangu9">Pangu9</a> and <a href="https://github.com/LinusHenze/Fugu14">Fugu14</a>.</p>
</li>
</ul>
<h5 id="jailbreak-device-strategy">Jailbreak Device Strategy<a class="headerlink" href="#jailbreak-device-strategy" title="Permanent link">&para;</a></h5>
<p>Jailbreaking an iOS device has become more and more challenging and a very time-sensitive procedure, which is understandable since Apple keeps hardening the system, patching the exploited vulnerabilities and quickly releasing upgrades.</p>
<p>iOS upgrades are based on a challenge-response process (generating the so-called SHSH blobs as a result). The device will allow the OS installation only if the response to the challenge is signed by Apple. This is what researchers call a "signing window", and it is the reason you can't simply store the OTA firmware package you downloaded and load it onto the device whenever you want to. During minor iOS upgrades, two versions may both be signed by Apple (the latest one, and the previous iOS version). This is the only situation in which you can downgrade the iOS device. You can check the current signing window and download OTA firmware from the <a href="https://ipsw.me" title="IPSW Downloads">IPSW Downloads website</a>.</p>
<p><strong>Recommendation:</strong> if you have a jailbroken device that you use for security testing, keep it as-is unless you're 100% sure that you can re-jailbreak it after upgrading to the latest iOS version.</p>
<p>Also consider getting one or more spare devices (which you will be updating with every major iOS release) and wait for new jailbreak software to be released publicly (see next section). Apple is usually quick to release a patch once a jailbreak has been released publicly, so you have only a couple of days to downgrade to the affected iOS version and apply the jailbreak.</p>
<h5 id="jailbreak-software">Jailbreak Software<a class="headerlink" href="#jailbreak-software" title="Permanent link">&para;</a></h5>
<p>The iOS jailbreak scene evolves so rapidly that providing up-to-date instructions is very challenging. At the time of this writing we can recommend using the very complete <a href="https://docs.google.com/spreadsheets/u/0/d/11DABHIIqwYQKj1L83AK9ywk_hYMjEkcaxpIg6phbTf0/htmlview#">"Jailbreak Chart by the r/jailbreak Reddit community"</a>.</p>
<p>Other sources that have been, and might still be, reliable include:</p>
<ul>
<li><a href="https://www.reddit.com/r/jailbreak/" title="Reddit Jailbreak">r/jailbreak Reddit Community Page</a></li>
<li><a href="https://canijailbreak.com/" title="Can I Jailbreak?">Can I Jailbreak?</a></li>
<li><a href="https://www.redmondpie.com/" title="Redmone Pie">Redmond Pie</a></li>
</ul>
<blockquote>
<p><strong>IMPORTANT NOTE</strong>:
Beware of fake tools and spyware, which are often hiding behind domain names that are similar to the name of the jailbreaking group/author.</p>
<p>Note that any modification you make to your device is at your own risk. While jailbreaking is typically safe, things can go wrong and you may end up bricking your device. No other party except yourself can be held accountable for any damage.</p>
</blockquote>
<h5 id="testing-jailbreak-detection">Testing Jailbreak Detection<a class="headerlink" href="#testing-jailbreak-detection" title="Permanent link">&para;</a></h5>
<p>Some apps attempt to detect whether the iOS device on which they're running is jailbroken. This is because jailbreaking deactivates some of iOS' default security mechanisms. However, there are several ways to get around these detections, and we'll introduce them in the chapter <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/">"iOS Anti-Reversing Defenses"</a>.</p>
<h4 id="getting-the-udid-of-an-ios-device">Getting the UDID of an iOS device<a class="headerlink" href="#getting-the-udid-of-an-ios-device" title="Permanent link">&para;</a></h4>
<p>The UDID is a 40-digit unique sequence of letters and numbers to identify an iOS device. You can find the UDID of your iOS device on macOS Catalina onwards in the Finder app, as iTunes is not available anymore in Catalina. Select the connected iOS device in Finder and click on the information under the name of the iOS device to iterate through it. Besides the UDID, you can find the serial number, IMEI and other useful information.</p>
<p><img src="../../assets/Images/Chapters/0x06b/UDID-Finder.png" width="400px" /></p>
<p>If you are using a macOS version before Catalina, you can find the <a href="http://www.iclarified.com/52179/how-to-find-your-iphones-udid" title="How to Find Your iPhone\'s UDID">UDID of your iOS device via iTunes</a>, by selecting your device and clicking on "Serial Number" in the summary tab. When clicking on this you will iterate through different metadata of the iOS device including its UDID.</p>
<p>It is also possible to get the UDID via various command line tools on macOS while the device is attached via USB:</p>
<ul>
<li>
<p>By using the <a href="https://developer.apple.com/library/archive/documentation/DeviceDrivers/Conceptual/IOKitFundamentals/TheRegistry/TheRegistry.html" title="I/O Registry Explorer">I/O Registry Explorer</a> tool <code>ioreg</code>:</p>
<div class="highlight"><pre><span></span><code>$ ioreg -p IOUSB -l <span class="p">|</span> grep <span class="s2">&quot;USB Serial&quot;</span>
<span class="p">|</span>         <span class="s2">&quot;USB Serial Number&quot;</span> <span class="o">=</span> <span class="s2">&quot;9e8ada44246cee813e2f8c1407520bf2f84849ec&quot;</span>
</code></pre></div>
</li>
<li>
<p>By using <a href="https://github.com/libimobiledevice/ideviceinstaller">ideviceinstaller</a> (also available on Linux):</p>
<div class="highlight"><pre><span></span><code>$ brew install ideviceinstaller
$ idevice_id -l
316f01bd160932d2bf2f95f1f142bc29b1c62dbc
</code></pre></div>
</li>
<li>
<p>By using the system_profiler:</p>
<div class="highlight"><pre><span></span><code>$ system_profiler SPUSBDataType <span class="p">|</span> sed -n -e <span class="s1">&#39;/iPad/,/Serial/p;/iPhone/,/Serial/p;/iPod/,/Serial/p&#39;</span> <span class="p">|</span> grep <span class="s2">&quot;Serial Number:&quot;</span>
<span class="m">2019</span>-09-08 <span class="m">10</span>:18:03.920 system_profiler<span class="o">[</span><span class="m">13251</span>:1050356<span class="o">]</span> SPUSBDevice: IOCreatePlugInInterfaceForService failed 0xe00002be
            Serial Number: 64655621de6ef5e56a874d63f1e1bdd14f7103b1
</code></pre></div>
</li>
<li>
<p>By using instruments:</p>
<div class="highlight"><pre><span></span><code>$ instruments -s devices
</code></pre></div>
</li>
</ul>
<h2 id="basic-testing-operations">Basic Testing Operations<a class="headerlink" href="#basic-testing-operations" title="Permanent link">&para;</a></h2>
<h3 id="accessing-the-device-shell">Accessing the Device Shell<a class="headerlink" href="#accessing-the-device-shell" title="Permanent link">&para;</a></h3>
<p>One of the most common things you do when testing an app is accessing the device shell. In this section we'll see how to access the iOS shell both remotely from your host computer with/without a USB cable and locally from the device itself.</p>
<h4 id="remote-shell">Remote Shell<a class="headerlink" href="#remote-shell" title="Permanent link">&para;</a></h4>
<p>In contrast to Android where you can easily access the device shell using the adb tool, on iOS you only have the option to access the remote shell via SSH. This also means that your iOS device must be jailbroken in order to connect to its shell from your host computer. For this section we assume that you've properly jailbroken your device and have either <a href="../0x08-Testing-Tools/#cydia">Cydia</a> (see screenshot below) or <a href="../0x08-Testing-Tools/#sileo">Sileo</a> installed. In the rest of the guide we will reference to Cydia, but the same packages should be available in Sileo.</p>
<p><img src="../../assets/Images/Chapters/0x06b/cydia.png" width="300px" /></p>
<p>In order to enable SSH access to your iOS device you can install the OpenSSH package. Once installed, be sure to connect both devices to the same Wi-Fi network and take a note of the device IP address, which you can find in the <strong>Settings -&gt; Wi-Fi</strong> menu and tapping once on the info icon of the network you're connected to.</p>
<p>You can now access the remote device's shell by running <code>ssh root@&lt;device_ip_address&gt;</code>, which will log you in as the root user:</p>
<div class="highlight"><pre><span></span><code>$ ssh root@192.168.197.234
root@192.168.197.234<span class="err">&#39;</span>s password:
iPhone:~ root#
</code></pre></div>
<p>Press Control + D or type <code>exit</code> to quit.</p>
<p>When accessing your iOS device via SSH consider the following:</p>
<ul>
<li>The default users are <code>root</code> and <code>mobile</code>.</li>
<li>The default password for both is <code>alpine</code>.</li>
</ul>
<blockquote>
<p>Remember to change the default password for both users <code>root</code> and <code>mobile</code> as anyone on the same network can find the IP address of your device and connect via the well-known default password, which will give them root access to your device.</p>
</blockquote>
<p>If you forget your password and want to reset it to the default <code>alpine</code>:</p>
<ol>
<li>Edit the file <code>/private/etc/master.password</code> on your jailbroken iOS device (using an on-device shell as shown below)</li>
<li>Find the lines:</li>
</ol>
<div class="highlight"><pre><span></span><code> root:xxxxxxxxx:0:0::0:0:System Administrator:/var/root:/bin/sh
 mobile:xxxxxxxxx:501:501::0:0:Mobile User:/var/mobile:/bin/sh
</code></pre></div>
<ol>
<li>Change <code>xxxxxxxxx</code> to <code>/smx7MYTQIi2M</code> (which is the hashed password <code>alpine</code>)</li>
<li>Save and exit</li>
</ol>
<h5 id="connect-to-a-device-via-ssh-over-usb">Connect to a Device via SSH over USB<a class="headerlink" href="#connect-to-a-device-via-ssh-over-usb" title="Permanent link">&para;</a></h5>
<p>During a real black box test, a reliable Wi-Fi connection may not be available. In this situation, you can use <a href="../0x08-Testing-Tools/#usbmuxd">usbmuxd</a> to connect to your device's SSH server via USB.</p>
<p>Connect macOS to an iOS device by installing and starting <a href="../0x08-Testing-Tools/#iproxy">iproxy</a>:</p>
<div class="highlight"><pre><span></span><code>$ brew install libimobiledevice
$ iproxy <span class="m">2222</span> <span class="m">22</span>
waiting <span class="k">for</span> connection
</code></pre></div>
<p>The above command maps port <code>22</code> on the iOS device to port <code>2222</code> on localhost. You can also <a href="https://iphonedevwiki.net/index.php/SSH_Over_USB" title="Making iproxy run automatically in the background on OS X">make iproxy run automatically in the background</a> if you don't want to run the binary every time you want to SSH over USB.</p>
<p>With the following command in a new terminal window, you can connect to the device:</p>
<div class="highlight"><pre><span></span><code>$ ssh -p <span class="m">2222</span> root@localhost
root@localhost<span class="err">&#39;</span>s password:
iPhone:~ root#
</code></pre></div>
<blockquote>
<p>Small note on USB of an iDevice: on an iOS device you cannot make data connections anymore after 1 hour of being in a locked state, unless you unlock it again due to the USB Restricted Mode, which was introduced with iOS 11.4.1</p>
</blockquote>
<h4 id="on-device-shell-app">On-device Shell App<a class="headerlink" href="#on-device-shell-app" title="Permanent link">&para;</a></h4>
<p>While usually using an on-device shell (terminal emulator) might be very tedious compared to a remote shell, it can prove handy for debugging in case of, for example, network issues or check some configuration. For example, you can install <a href="https://repo.chariz.io/package/ws.hbang.newterm2/" title="NewTerm 2">NewTerm 2</a> via Cydia for this purpose (it supports iOS 6.0 to 12.1.2 at the time of this writing).</p>
<p>In addition, there are a few jailbreaks that explicitly disable incoming SSH <em>for security reasons</em>. In those cases, it is very convenient to have an on-device shell app, which you can use to first SSH out of the device with a reverse shell, and then connect from your host computer to it.</p>
<p>Opening a reverse shell over SSH can be done by running the command <code>ssh -R &lt;remote_port&gt;:localhost:22 &lt;username&gt;@&lt;host_computer_ip&gt;</code>.</p>
<p>On the on-device shell app run the following command and, when asked, enter the password of the <code>mstg</code> user of the host computer:</p>
<div class="highlight"><pre><span></span><code>ssh -R <span class="m">2222</span>:localhost:22 mstg@192.168.197.235
</code></pre></div>
<p>On your host computer run the following command and, when asked, enter the password of the <code>root</code> user of the iOS device:</p>
<div class="highlight"><pre><span></span><code>$ ssh -p <span class="m">2222</span> root@localhost
</code></pre></div>
<h3 id="host-device-data-transfer">Host-Device Data Transfer<a class="headerlink" href="#host-device-data-transfer" title="Permanent link">&para;</a></h3>
<p>There might be various scenarios where you might need to transfer data from the iOS device or app data sandbox to your host computer or vice versa. The following section will show you different ways on how to achieve that.</p>
<h4 id="copying-app-data-files-via-ssh-and-scp">Copying App Data Files via SSH and SCP<a class="headerlink" href="#copying-app-data-files-via-ssh-and-scp" title="Permanent link">&para;</a></h4>
<p>As we know now, files from our app are stored in the Data directory. You can now simply archive the Data directory with <code>tar</code> and pull it from the device with <code>scp</code>:</p>
<div class="highlight"><pre><span></span><code>iPhone:~ root# tar czvf /tmp/data.tgz /private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693
iPhone:~ root# <span class="nb">exit</span>
$ scp -P <span class="m">2222</span> root@localhost:/tmp/data.tgz .
</code></pre></div>
<h4 id="passionfruit">Passionfruit<a class="headerlink" href="#passionfruit" title="Permanent link">&para;</a></h4>
<p>After starting <a href="../0x08-Testing-Tools/#passionfruit">Passionfruit</a> you can select the app that is in scope for testing. There are various functions available, of which one is called "Files". When selecting it, you will get a listing of the directories of the app sandbox.</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_data_dir.png" width="100%" /></p>
<p>When navigating through the directories and selecting a file, a pop-up will show up and display the data either as hexadecimal or text. When closing this pop-up you have various options available for the file, including:</p>
<ul>
<li>Text viewer</li>
<li>SQLite viewer</li>
<li>Image viewer</li>
<li>Plist viewer</li>
<li>Download</li>
</ul>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_file_download.png" width="100%" /></p>
<h4 id="objection">Objection<a class="headerlink" href="#objection" title="Permanent link">&para;</a></h4>
<p>When you are starting objection you will find the prompt within the Bundle directory.</p>
<div class="highlight"><pre><span></span><code>org.owasp.MSTG on <span class="o">(</span>iPhone: <span class="m">10</span>.3.3<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># pwd print</span>
Current directory: /var/containers/Bundle/Application/DABF849D-493E-464C-B66B-B8B6C53A4E76/org.owasp.MSTG.app
</code></pre></div>
<p>Use the <code>env</code> command to get the directories of the app and navigate to the Documents directory.</p>
<div class="highlight"><pre><span></span><code>org.owasp.MSTG on <span class="o">(</span>iPhone: <span class="m">10</span>.3.3<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># cd /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents</span>
/var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents
</code></pre></div>
<p>With the command <code>file download &lt;filename&gt;</code> you can download a file from the iOS device to your host computer and can analyze it afterwards.</p>
<div class="highlight"><pre><span></span><code>org.owasp.MSTG on <span class="o">(</span>iPhone: <span class="m">10</span>.3.3<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># file download .com.apple.mobile_container_manager.metadata.plist</span>
Downloading /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plist to .com.apple.mobile_container_manager.metadata.plist
Streaming file from device...
Writing bytes to destination...
Successfully downloaded /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plist to .com.apple.mobile_container_manager.metadata.plist
</code></pre></div>
<p>You can also upload files to the iOS device with <code>file upload &lt;local_file_path&gt;</code>.</p>
<h3 id="obtaining-and-extracting-apps">Obtaining and Extracting Apps<a class="headerlink" href="#obtaining-and-extracting-apps" title="Permanent link">&para;</a></h3>
<h4 id="getting-the-ipa-file-from-an-ota-distribution-link">Getting the IPA File from an OTA Distribution Link<a class="headerlink" href="#getting-the-ipa-file-from-an-ota-distribution-link" title="Permanent link">&para;</a></h4>
<p>During development, apps are sometimes provided to testers via over-the-air (OTA) distribution. In that situation, you'll receive an itms-services link, such as the following:</p>
<div class="highlight"><pre><span></span><code>itms-services://?action=download-manifest&amp;url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist
</code></pre></div>
<p>You can use the <a href="https://www.npmjs.com/package/itms-services" title="ITMS services asset downloader">ITMS services asset downloader</a> tool to download the IPA from an OTA distribution URL. Install it via npm:</p>
<div class="highlight"><pre><span></span><code>$ npm install -g itms-services
</code></pre></div>
<p>Save the IPA file locally with the following command:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># itms-services -u &quot;itms-services://?action=download-manifest&amp;url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist&quot; -o - &gt; out.ipa</span>
</code></pre></div>
<h4 id="acquiring-the-app-binary">Acquiring the App Binary<a class="headerlink" href="#acquiring-the-app-binary" title="Permanent link">&para;</a></h4>
<ol>
<li>From an IPA:</li>
</ol>
<p>If you have the IPA (probably including an already decrypted app binary), unzip it and you are ready to go. The app binary is located in the main bundle directory (.app), e.g. <code>Payload/Telegram X.app/Telegram X</code>. See the following subsection for details on the extraction of the property lists.</p>
<pre><code>&gt; On macOS's Finder, .app directories are opened by right-clicking them and selecting "Show Package Content". On the terminal you can just `cd` into them.
</code></pre>
<ol>
<li>
<p>From a Jailbroken device:</p>
<p>If you don't have the original IPA, then you need a jailbroken device where you will install the app (e.g. via App Store). Once installed, you need to extract the app binary from memory and rebuild the IPA file. Because of DRM, the app binary file is encrypted when it is stored on the iOS device, so simply pulling it from the Bundle (either through SSH or Objection) will not be sufficient to reverse engineer it.</p>
</li>
</ol>
<p>The following shows the output of running <a href="../0x08-Testing-Tools/#class-dump">class-dump</a> on the Telegram app, which was directly pulled from the installation directory of the iPhone:</p>
<div class="highlight"><pre><span></span><code>$ class-dump Telegram
//
//     Generated by class-dump <span class="m">3</span>.5 <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span> <span class="o">(</span>Debug version compiled Jun  <span class="m">9</span> <span class="m">2015</span> <span class="m">22</span>:53:21<span class="o">)</span>.
//
//     class-dump is Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">1997</span>-1998, <span class="m">2000</span>-2001, <span class="m">2004</span>-2014 by Steve Nygard.
//

<span class="c1">#pragma mark -</span>

//
// File: Telegram
// UUID: EAF90234-1538-38CF-85B2-91A84068E904
//
//                           Arch: arm64
//                 Source version: <span class="m">0</span>.0.0.0.0
//            Minimum iOS version: <span class="m">8</span>.0.0
//                    SDK version: <span class="m">12</span>.1.0
//
// Objective-C Garbage Collection: Unsupported
//
//                       Run path: @executable_path/Frameworks
//                               <span class="o">=</span> /Frameworks
//         This file is encrypted:
//                                   cryptid: 0x00000001
//                                  cryptoff: 0x00004000
//                                 cryptsize: 0x000fc000
//
</code></pre></div>
<p>In order to retrieve the unencrypted version, you can use tools such as <a href="https://github.com/AloneMonkey/frida-ios-dump" title="frida-ios-dump">frida-ios-dump</a> (all iOS versions) or <a href="../0x08-Testing-Tools/#clutch">Clutch</a> (only up to iOS 11; for iOS 12 and above, it requires a patch). Both will extract the unencrypted version from memory while the application is running on the device. The stability of both Clutch and frida-ios-dump can vary depending on your iOS version and Jailbreak method, so it's useful to have multiple ways of extracting the binary.</p>
<blockquote>
<p><strong>IMPORTANT NOTE:</strong> In the United States, the Digital Millennium Copyright Act 17 U.S.C. 1201, or DMCA, makes it illegal and actionable to circumvent certain types of DRM. However, the DMCA also provides exemptions, such as for certain kinds of security research. A qualified attorney can help you determine if your research qualifies under the DMCA exemptions. (Source: <a href="https://support.corellium.com/en/articles/6181345-testing-third-party-ios-apps">Corellium</a>)</p>
</blockquote>
<h5 id="using-clutch">Using Clutch<a class="headerlink" href="#using-clutch" title="Permanent link">&para;</a></h5>
<p>Build <a href="../0x08-Testing-Tools/#clutch">Clutch</a> as explained on the Clutch GitHub page and push it to the iOS device through <code>scp</code>. Run Clutch with the <code>-i</code> flag to list all installed applications:</p>
<div class="highlight"><pre><span></span><code>root# ./Clutch -i
<span class="m">2019</span>-06-04 <span class="m">20</span>:16:57.807 Clutch<span class="o">[</span><span class="m">2449</span>:440427<span class="o">]</span> command: Prints installed applications
Installed apps:
...
<span class="m">5</span>:   Telegram Messenger &lt;ph.telegra.Telegraph&gt;
...
</code></pre></div>
<p>Once you have the bundle identifier, you can use Clutch to create the IPA:</p>
<div class="highlight"><pre><span></span><code>root# ./Clutch -d ph.telegra.Telegraph
<span class="m">2019</span>-06-04 <span class="m">20</span>:19:28.460 Clutch<span class="o">[</span><span class="m">2450</span>:440574<span class="o">]</span> command: Dump specified bundleID into .ipa file
ph.telegra.Telegraph contains watchOS <span class="m">2</span> compatible application. It<span class="err">&#39;</span>s not possible to dump watchOS <span class="m">2</span> apps with Clutch <span class="o">(</span>null<span class="o">)</span> at this moment.
Zipping Telegram.app
<span class="m">2019</span>-06-04 <span class="m">20</span>:19:29.825 clutch<span class="o">[</span><span class="m">2465</span>:440618<span class="o">]</span> command: Only dump binary files from specified bundleID
...
Successfully dumped framework TelegramUI!
Zipping WebP.framework
Zipping NotificationContent.appex
Zipping NotificationService.appex
Zipping Share.appex
Zipping SiriIntents.appex
Zipping Widget.appex
DONE: /private/var/mobile/Documents/Dumped/ph.telegra.Telegraph-iOS9.0-<span class="o">(</span>Clutch-<span class="o">(</span>null<span class="o">))</span>.ipa
Finished dumping ph.telegra.Telegraph <span class="k">in</span> <span class="m">20</span>.5 seconds
</code></pre></div>
<p>After copying the IPA file over to the host system and unzipping it, you can see that the Telegram app binary can now be parsed by <a href="../0x08-Testing-Tools/#class-dump">class-dump</a>, indicating that it is no longer encrypted:</p>
<div class="highlight"><pre><span></span><code>$ class-dump Telegram
...
//
//     Generated by class-dump <span class="m">3</span>.5 <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span> <span class="o">(</span>Debug version compiled Jun  <span class="m">9</span> <span class="m">2015</span> <span class="m">22</span>:53:21<span class="o">)</span>.
//
//     class-dump is Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">1997</span>-1998, <span class="m">2000</span>-2001, <span class="m">2004</span>-2014 by Steve Nygard.
//

<span class="c1">#pragma mark Blocks</span>

typedef void <span class="o">(</span>^CDUnknownBlockType<span class="o">)(</span>void<span class="o">)</span><span class="p">;</span> // <span class="k">return</span> <span class="nb">type</span> and parameters are unknown

<span class="c1">#pragma mark Named Structures</span>

struct CGPoint <span class="o">{</span>
    double _field1<span class="p">;</span>
    double _field2<span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
...
</code></pre></div>
<p>Note: when you use <a href="../0x08-Testing-Tools/#clutch">Clutch</a> on iOS 12, please check <a href="https://github.com/KJCracks/Clutch/issues/228" title="Getting Clutch to run on iOS 12">Clutch Github issue 228</a></p>
<h5 id="using-frida-ios-dump">Using Frida-ios-dump<a class="headerlink" href="#using-frida-ios-dump" title="Permanent link">&para;</a></h5>
<p>First, make sure that the configuration in <a href="../0x08-Testing-Tools/#frida-ios-dump">Frida-ios-dump</a> <code>dump.py</code> is set to either localhost with port 2222 when using <a href="../0x08-Testing-Tools/#iproxy">iproxy</a>, or to the actual IP address and port of the device from which you want to dump the binary. Next, change the default username (<code>User = 'root'</code>) and password (<code>Password = 'alpine'</code>) in <code>dump.py</code> to the ones you use.</p>
<p>Now you can safely use the tool to enumerate the apps installed:</p>
<div class="highlight"><pre><span></span><code>$ python dump.py -l
 PID  Name             Identifier
----  ---------------  -------------------------------------
 <span class="m">860</span>  Cydia            com.saurik.Cydia
<span class="m">1130</span>  Settings         com.apple.Preferences
 <span class="m">685</span>  Mail             com.apple.mobilemail
 <span class="m">834</span>  Telegram         ph.telegra.Telegraph
   -  Stocks           com.apple.stocks
   ...
</code></pre></div>
<p>and you can dump one of the listed binaries:</p>
<div class="highlight"><pre><span></span><code>$ python dump.py ph.telegra.Telegraph

Start the target app ph.telegra.Telegraph
Dumping Telegram to /var/folders/qw/gz47_8_n6xx1c_lwq7pq5k040000gn/T
<span class="o">[</span>frida-ios-dump<span class="o">]</span>: HockeySDK.framework has been loaded.
<span class="o">[</span>frida-ios-dump<span class="o">]</span>: Load Postbox.framework success.
<span class="o">[</span>frida-ios-dump<span class="o">]</span>: libswiftContacts.dylib has been dlopen.
...
start dump /private/var/containers/Bundle/Application/14002D30-B113-4FDF-BD25-1BF740383149/Telegram.app/Frameworks/libswiftsimd.dylib
libswiftsimd.dylib.fid: <span class="m">100</span>%<span class="p">|</span>██████████<span class="p">|</span> 343k/343k <span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00, <span class="m">1</span>.54MB/s<span class="o">]</span>
start dump /private/var/containers/Bundle/Application/14002D30-B113-4FDF-BD25-1BF740383149/Telegram.app/Frameworks/libswiftCoreData.dylib
libswiftCoreData.dylib.fid: <span class="m">100</span>%<span class="p">|</span>██████████<span class="p">|</span> <span class="m">82</span>.5k/82.5k <span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00, 477kB/s<span class="o">]</span>
<span class="m">5</span>.m4a: <span class="m">80</span>.9MB <span class="o">[</span><span class="m">00</span>:14, <span class="m">5</span>.85MB/s<span class="o">]</span>
<span class="m">0</span>.00B <span class="o">[</span><span class="m">00</span>:00, ?B/s<span class="o">]</span>Generating <span class="s2">&quot;Telegram.ipa&quot;</span>
</code></pre></div>
<p>After this, the <code>Telegram.ipa</code> file will be created in your current directory. You can validate the success of the dump by removing the app and reinstalling it (e.g. using <a href="../0x08-Testing-Tools/#ios-deploy">ios-deploy</a> <code>ios-deploy -b Telegram.ipa</code>). Note that this will only work on jailbroken devices, as otherwise the signature won't be valid.</p>
<h3 id="installing-apps">Installing Apps<a class="headerlink" href="#installing-apps" title="Permanent link">&para;</a></h3>
<p>When you install an application without using Apple's App Store, this is called sideloading. There are various ways of sideloading which are described below. On the iOS device, the actual installation process is then handled by the installd daemon, which will unpack and install the application. To integrate app services or be installed on an iOS device, all applications must be signed with a certificate issued by Apple. This means that the application can be installed only after successful code signature verification. On a jailbroken phone, however, you can circumvent this security feature with <a href="http://repo.hackyouriphone.org/appsyncunified" title="AppSync">AppSync</a>, a package available in the Cydia store. It contains numerous useful applications that leverage jailbreak-provided root privileges to execute advanced functionality. AppSync is a tweak that patches installd, allowing the installation of fake-signed IPA packages.</p>
<p>Different methods exist for installing an IPA package onto an iOS device, which are described in detail below.</p>
<blockquote>
<p>Please note that iTunes is no longer available in macOS Catalina. If you are using an older version of macOS, iTunes is still available but since iTunes 12.7 it is not possible to install apps.</p>
</blockquote>
<h4 id="cydia-impactor">Cydia Impactor<a class="headerlink" href="#cydia-impactor" title="Permanent link">&para;</a></h4>
<p><a href="http://www.cydiaimpactor.com/" title="Cydia Impactor">Cydia Impactor</a> was originally created to jailbreak iPhones, but has been rewritten to sign and install IPA packages to iOS devices via sideloading (and even APK files to Android devices). Cydia Impactor is available for Windows, macOS and Linux. A <a href="https://yalujailbreak.net/how-to-use-cydia-impactor/" title="How to use Cydia Impactor">step by step guide and troubleshooting steps are available on yalujailbreak.net</a>.</p>
<h4 id="libimobiledevice">libimobiledevice<a class="headerlink" href="#libimobiledevice" title="Permanent link">&para;</a></h4>
<p>On Linux and also macOS, you can alternatively use <a href="https://www.libimobiledevice.org/" title="libimobiledevice">libimobiledevice</a>, a cross-platform software protocol library and a set of tools for native communication with iOS devices. This allows you to install apps over a USB connection by executing ideviceinstaller. The connection is implemented with the USB multiplexing daemon <a href="https://www.theiphonewiki.com/wiki/Usbmux" title="Usbmux">usbmuxd</a>, which provides a TCP tunnel over USB.</p>
<p>The package for libimobiledevice will be available in your Linux package manager. On macOS you can install libimobiledevice via brew:</p>
<div class="highlight"><pre><span></span><code>$ brew install libimobiledevice
$ brew install ideviceinstaller
</code></pre></div>
<p>After the installation you have several new command line tools available, such as <code>ideviceinfo</code>, <code>ideviceinstaller</code> or <code>idevicedebug</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># The following command will show detailed information about the iOS device connected via USB.</span>
$ ideviceinfo
<span class="c1"># The following command will install the IPA to your iOS device.</span>
$ ideviceinstaller -i iGoat-Swift_v1.0-frida-codesigned.ipa
...
Install: Complete
<span class="c1"># The following command will start the app in debug mode, by providing the bundle name. The bundle name can be found in the previous command after &quot;Installing&quot;.</span>
$ idevicedebug -d run OWASP.iGoat-Swift
</code></pre></div>
<h4 id="ipainstaller">ipainstaller<a class="headerlink" href="#ipainstaller" title="Permanent link">&para;</a></h4>
<p>The IPA can also be directly installed on the iOS device via the command line with <a href="https://github.com/autopear/ipainstaller" title="IPA Installer">ipainstaller</a>. After copying the file over to the device, for example via scp, you can execute ipainstaller with the IPA's filename:</p>
<div class="highlight"><pre><span></span><code>$ ipainstaller App_name.ipa
</code></pre></div>
<h4 id="ios-deploy">ios-deploy<a class="headerlink" href="#ios-deploy" title="Permanent link">&para;</a></h4>
<p>On macOS you can also use the <a href="../0x08-Testing-Tools/#ios-deploy">ios-deploy</a> tool to install iOS apps from the command line. You'll need to unzip your IPA since ios-deploy uses the app bundles to install apps.</p>
<div class="highlight"><pre><span></span><code>$ unzip Name.ipa
$ ios-deploy --bundle <span class="s1">&#39;Payload/Name.app&#39;</span> -W -d -v
</code></pre></div>
<p>After the app is installed on the iOS device, you can simply start it by adding the <code>-m</code> flag which will directly start debugging without installing the app again.</p>
<div class="highlight"><pre><span></span><code>$ ios-deploy --bundle <span class="s1">&#39;Payload/Name.app&#39;</span> -W -d -v -m
</code></pre></div>
<h4 id="xcode">Xcode<a class="headerlink" href="#xcode" title="Permanent link">&para;</a></h4>
<p>It is also possible to use the Xcode IDE to install iOS apps by doing the following steps:</p>
<ol>
<li>Start Xcode</li>
<li>Select <strong>Window/Devices and Simulators</strong></li>
<li>Select the connected iOS device and click on the <strong>+</strong> sign in <strong>Installed Apps</strong>.</li>
</ol>
<h4 id="allow-application-installation-on-a-non-ipad-device">Allow Application Installation on a Non-iPad Device<a class="headerlink" href="#allow-application-installation-on-a-non-ipad-device" title="Permanent link">&para;</a></h4>
<p>Sometimes an application can require to be used on an iPad device. If you only have iPhone or iPod touch devices then you can force the application to accept to be installed and used on these kinds of devices. You can do this by changing the value of the property <strong>UIDeviceFamily</strong> to the value <strong>1</strong> in the <strong>Info.plist</strong> file.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>

  <span class="nt">&lt;key&gt;</span>UIDeviceFamily<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;array&gt;</span>
    <span class="nt">&lt;integer&gt;</span>1<span class="nt">&lt;/integer&gt;</span>
  <span class="nt">&lt;/array&gt;</span>

<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>  
</code></pre></div>
<p>It is important to note that changing this value will break the original signature of the IPA file so you need to re-sign the IPA, after the update, in order to install it on a device on which the signature validation has not been disabled.</p>
<p>This bypass might not work if the application requires capabilities that are specific to modern iPads while your iPhone or iPod is a bit older.</p>
<p>Possible values for the property <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW11" title="UIDeviceFamily property">UIDeviceFamily</a> can be found in the Apple Developer documentation.</p>
<h3 id="information-gathering">Information Gathering<a class="headerlink" href="#information-gathering" title="Permanent link">&para;</a></h3>
<p>One fundamental step when analyzing apps is information gathering. This can be done by inspecting the app package on your host computer or remotely by accessing the app data on the device. You'll find more advance techniques in the subsequent chapters but, for now, we will focus on the basics: getting a list of all installed apps, exploring the app package and accessing the app data directories on the device itself. This should give you a bit of context about what the app is all about without even having to reverse engineer it or perform more advanced analysis. We will be answering questions such as:</p>
<ul>
<li>Which files are included in the package?</li>
<li>Which Frameworks does the app use?</li>
<li>Which capabilities does the app require?</li>
<li>Which permissions does the app request to the user and for what reason?</li>
<li>Does the app allow any unsecured connections?</li>
<li>Does the app create any new files when being installed?</li>
</ul>
<h4 id="listing-installed-apps">Listing Installed Apps<a class="headerlink" href="#listing-installed-apps" title="Permanent link">&para;</a></h4>
<p>When targeting apps that are installed on the device, you'll first have to figure out the correct bundle identifier of the application you want to analyze. You can use <code>frida-ps -Uai</code> to get all apps (<code>-a</code>) currently installed (<code>-i</code>) on the connected USB device (<code>-U</code>):</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -Uai
 PID  Name                 Identifier
----  -------------------  -----------------------------------------
<span class="m">6847</span>  Calendar             com.apple.mobilecal
<span class="m">6815</span>  Mail                 com.apple.mobilemail
   -  App Store            com.apple.AppStore
   -  Apple Store          com.apple.store.Jolly
   -  Calculator           com.apple.calculator
   -  Camera               com.apple.camera
   -  iGoat-Swift          OWASP.iGoat-Swift
</code></pre></div>
<p>It also shows which of them are currently running. Take a note of the "Identifier" (bundle identifier) and the PID if any as you'll need them afterwards.</p>
<p>You can also directly open passionfruit and after selecting your iOS device you'll get the list of installed apps.</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_installed_apps.png" width="400px" /></p>
<h4 id="exploring-the-app-package">Exploring the App Package<a class="headerlink" href="#exploring-the-app-package" title="Permanent link">&para;</a></h4>
<p>Once you have collected the package name of the application you want to target, you'll want to start gathering information about it. First, retrieve the IPA as explained in <a href="#obtaining-and-extracting-apps" title="Obtaining and Extracting Apps">Basic Testing Operations - Obtaining and Extracting Apps</a>.</p>
<p>You can unzip the IPA using the standard <code>unzip</code> or any other ZIP utility. Inside you'll find a <code>Payload</code> folder containing the so-called Application Bundle (.app). The following is an example in the following output, note that it was truncated for better readability and overview:</p>
<div class="highlight"><pre><span></span><code>$ ls -1 Payload/iGoat-Swift.app
rutger.html
mansi.html
splash.html
about.html

LICENSE.txt
Sentinel.txt
README.txt

URLSchemeAttackExerciseVC.nib
CutAndPasteExerciseVC.nib
RandomKeyGenerationExerciseVC.nib
KeychainExerciseVC.nib
CoreData.momd
archived-expanded-entitlements.xcent
SVProgressHUD.bundle

Base.lproj
Assets.car
PkgInfo
_CodeSignature
AppIcon60x60@3x.png

Frameworks

embedded.mobileprovision

Credentials.plist
Assets.plist
Info.plist

iGoat-Swift
</code></pre></div>
<p>The most relevant items are:</p>
<ul>
<li><code>Info.plist</code> contains configuration information for the application, such as its bundle ID, version number, and display name.</li>
<li><code>_CodeSignature/</code> contains a plist file with a signature over all files in the bundle.</li>
<li><code>Frameworks/</code> contains the app native libraries as .dylib or .framework files.</li>
<li><code>PlugIns/</code> may contain app extensions as .appex files (not present in the example).</li>
<li><code>iGoat-Swift</code> is the app binary containing the app’s code. Its name is the same as the bundle's name minus the .app extension.</li>
<li>Various resources such as images/icons, <code>*.nib</code> files (storing the user interfaces of iOS app), localized content (<code>&lt;language&gt;.lproj</code>), text files, audio files, etc.</li>
</ul>
<h5 id="the-infoplist-file">The Info.plist File<a class="headerlink" href="#the-infoplist-file" title="Permanent link">&para;</a></h5>
<p>The information property list or <code>Info.plist</code> (named by convention) is the main source of information for an iOS app. It consists of a structured file containing key-value pairs describing essential configuration information about the app. Actually, all bundled executables (app extensions, frameworks and apps) are expected to have an <code>Info.plist</code> file. You can find all possible keys in the <a href="https://developer.apple.com/documentation/bundleresources/information_property_list?language=objc" title="Information Property List">Apple Developer Documentation</a>.</p>
<p>The file might be formatted in XML or binary (bplist). You can convert it to XML format with one simple command:</p>
<ul>
<li>On macOS with <code>plutil</code>, which is a tool that comes natively with macOS 10.2 and above versions (no official online documentation is currently available):</li>
</ul>
<div class="highlight"><pre><span></span><code>$ plutil -convert xml1 Info.plist
</code></pre></div>
<ul>
<li>On Linux:</li>
</ul>
<div class="highlight"><pre><span></span><code>$ apt install libplist-utils
$ plistutil -i Info.plist -o Info_xml.plist
</code></pre></div>
<p>Here's a non-exhaustive list of some info and the corresponding keywords that you can easily search for in the <code>Info.plist</code> file by just inspecting the file or by using <code>grep -i &lt;keyword&gt; Info.plist</code>:</p>
<ul>
<li>App permissions Purpose Strings: <code>UsageDescription</code> (see "<a href="../0x06h-Testing-Platform-Interaction/">iOS Platform APIs</a>")</li>
<li>Custom URL schemes: <code>CFBundleURLTypes</code> (see "<a href="../0x06h-Testing-Platform-Interaction/">iOS Platform APIs</a>")</li>
<li>Exported/imported <em>custom document types</em>: <code>UTExportedTypeDeclarations</code> / <code>UTImportedTypeDeclarations</code> (see "<a href="../0x06h-Testing-Platform-Interaction/">iOS Platform APIs</a>")</li>
<li>App Transport Security (ATS) configuration: <code>NSAppTransportSecurity</code> (see "<a href="../0x06g-Testing-Network-Communication/">iOS Network APIs</a>")</li>
</ul>
<p>Please refer to the mentioned chapters to learn more about how to test each of these points.</p>
<h5 id="app-binary">App Binary<a class="headerlink" href="#app-binary" title="Permanent link">&para;</a></h5>
<p>iOS app binaries are fat binaries (they can be deployed on all devices 32- and 64-bit). In contrast to Android, where you can actually decompile the app binary to Java code, the iOS app binaries can only be disassembled.</p>
<p>Refer to the chapter <a href="../0x06c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on iOS</a> for more details.</p>
<h5 id="native-libraries">Native Libraries<a class="headerlink" href="#native-libraries" title="Permanent link">&para;</a></h5>
<p>iOS native libraries are known as Frameworks.</p>
<p>You can easily visualize them from Passionfruit by clicking on "Modules":</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_modules.png" width="100%" /></p>
<p>And get a more detailed view including their imports/exports:</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_modules_detail.png" width="100%" /></p>
<p>They are available in the <code>Frameworks</code> folder in the IPA, you can also inspect them from the terminal:</p>
<div class="highlight"><pre><span></span><code>$ ls -1 Frameworks/
Realm.framework
libswiftCore.dylib
libswiftCoreData.dylib
libswiftCoreFoundation.dylib
</code></pre></div>
<p>or from the device with objection (as well as per SSH of course):</p>
<div class="highlight"><pre><span></span><code>OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">11</span>.1.2<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ls</span>
NSFileType      Perms  NSFileProtection    ...  Name
------------  -------  ------------------  ...  ----------------------------
Directory         <span class="m">493</span>  None                ...  Realm.framework
Regular           <span class="m">420</span>  None                ...  libswiftCore.dylib
Regular           <span class="m">420</span>  None                ...  libswiftCoreData.dylib
Regular           <span class="m">420</span>  None                ...  libswiftCoreFoundation.dylib
...
</code></pre></div>
<p>Please note that this might not be the complete list of native code elements being used by the app as some can be part of the source code, meaning that they'll be compiled in the app binary and therefore cannot be found as standalone libraries or Frameworks in the <code>Frameworks</code> folder.</p>
<p>For now this is all information you can get about the Frameworks unless you start reverse engineering them. Refer to the chapter <a href="../0x06c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on iOS</a> for more information about how to reverse engineer Frameworks.</p>
<h5 id="other-app-resources">Other App Resources<a class="headerlink" href="#other-app-resources" title="Permanent link">&para;</a></h5>
<p>It is normally worth taking a look at the rest of the resources and files that you may find in the Application Bundle (.app) inside the IPA as some times they contain additional goodies like encrypted databases, certificates, etc.</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_db_view.png" width="100%" /></p>
<h4 id="accessing-app-data-directories">Accessing App Data Directories<a class="headerlink" href="#accessing-app-data-directories" title="Permanent link">&para;</a></h4>
<p>Once you have installed the app, there is further information to explore. Let's go through a short overview of the app folder structure on iOS apps to understand which data is stored where. The following illustration represents the application folder structure:</p>
<p><img src="../../assets/Images/Chapters/0x06a/iOS_Folder_Structure.png" width="400px" /></p>
<p>On iOS, system applications can be found in the <code>/Applications</code> directory while user-installed apps are available under <code>/private/var/containers/</code>. However, finding the right folder just by navigating the file system is not a trivial task as every app gets a random 128-bit UUID (Universal Unique Identifier) assigned for its directory names.</p>
<p>In order to easily obtain the installation directory information for user-installed apps you can follow the following methods:</p>
<p>Connect to the terminal on the device and run the command <code>ipainstaller</code> (<a href="https://cydia.saurik.com/package/com.autopear.installipa" title="IPA Installer Console">IPA Installer Console</a>) as follows:</p>
<div class="highlight"><pre><span></span><code>iPhone:~ root# ipainstaller -l
...
OWASP.iGoat-Swift

iPhone:~ root# ipainstaller -i OWASP.iGoat-Swift
...
Bundle: /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67
Application: /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app
Data: /private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693
</code></pre></div>
<p>Using objection's command <code>env</code> will also show you all the directory information of the app. Connecting to the application with objection is described in the section "<a href="#using-objection" title="Recommended Tools - Objection">Recommended Tools - Objection</a>".</p>
<div class="highlight"><pre><span></span><code>OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">11</span>.1.2<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># env</span>

Name               Path
-----------------  -------------------------------------------------------------------------------------------
BundlePath         /var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app
CachesDirectory    /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library/Caches
DocumentDirectory  /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Documents
LibraryDirectory   /var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/Library
</code></pre></div>
<p>As you can see, apps have two main locations:</p>
<ul>
<li>The Bundle directory (<code>/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/</code>).</li>
<li>The Data directory (<code>/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693/</code>).</li>
</ul>
<p>These folders contain information that must be examined closely during application security assessments (for example when analyzing the stored data for sensitive data).</p>
<p>Bundle directory:</p>
<ul>
<li><strong>AppName.app</strong></li>
<li>This is the Application Bundle as seen before in the IPA, it contains essential application data, static content as well as the application's compiled binary.</li>
<li>This directory is visible to users, but users can't write to it.</li>
<li>Content in this directory is not backed up.</li>
<li>The contents of this folder are used to validate the code signature.</li>
</ul>
<p>Data directory:</p>
<ul>
<li><strong>Documents/</strong></li>
<li>Contains all the user-generated data. The application end user initiates the creation of this data.</li>
<li>Visible to users and users can write to it.</li>
<li>Content in this directory is backed up.</li>
<li>The app can disable paths by setting <code>NSURLIsExcludedFromBackupKey</code>.</li>
<li><strong>Library/</strong></li>
<li>Contains all files that aren't user-specific, such as caches, preferences, cookies, and property list (plist) configuration files.</li>
<li>iOS apps usually use the <code>Application Support</code> and <code>Caches</code> subdirectories, but the app can create custom subdirectories.</li>
<li><strong>Library/Caches/</strong></li>
<li>Contains semi-persistent cached files.</li>
<li>Invisible to users and users can't write to it.</li>
<li>Content in this directory is not backed up.</li>
<li>The OS may delete this directory's files automatically when the app is not running and storage space is running low.</li>
<li><strong>Library/Application Support/</strong></li>
<li>Contains persistent files necessary for running the app.</li>
<li>Invisible to users and users can't write to it.</li>
<li>Content in this directory is backed up.</li>
<li>The app can disable paths by setting <code>NSURLIsExcludedFromBackupKey</code>.</li>
<li><strong>Library/Preferences/</strong></li>
<li>Used for storing properties that can persist even after an application is restarted.</li>
<li>Information is saved, unencrypted, inside the application sandbox in a plist file called [BUNDLE_ID].plist.</li>
<li>All the key/value pairs stored using <code>NSUserDefaults</code> can be found in this file.</li>
<li><strong>tmp/</strong></li>
<li>Use this directory to write temporary files that do not need to persist between app launches.</li>
<li>Contains non-persistent cached files.</li>
<li>Invisible to users.</li>
<li>Content in this directory is not backed up.</li>
<li>The OS may delete this directory's files automatically when the app is not running and storage space is running low.</li>
</ul>
<p>Let's take a closer look at iGoat-Swift's Application Bundle (.app) directory inside the Bundle directory (<code>/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app</code>):</p>
<div class="highlight"><pre><span></span><code>OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">11</span>.1.2<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ls</span>
NSFileType      Perms  NSFileProtection    ...  Name
------------  -------  ------------------  ...  --------------------------------------
Regular           <span class="m">420</span>  None                ...  rutger.html
Regular           <span class="m">420</span>  None                ...  mansi.html
Regular           <span class="m">420</span>  None                ...  splash.html
Regular           <span class="m">420</span>  None                ...  about.html

Regular           <span class="m">420</span>  None                ...  LICENSE.txt
Regular           <span class="m">420</span>  None                ...  Sentinel.txt
Regular           <span class="m">420</span>  None                ...  README.txt

Directory         <span class="m">493</span>  None                ...  URLSchemeAttackExerciseVC.nib
Directory         <span class="m">493</span>  None                ...  CutAndPasteExerciseVC.nib
Directory         <span class="m">493</span>  None                ...  RandomKeyGenerationExerciseVC.nib
Directory         <span class="m">493</span>  None                ...  KeychainExerciseVC.nib
Directory         <span class="m">493</span>  None                ...  CoreData.momd
Regular           <span class="m">420</span>  None                ...  archived-expanded-entitlements.xcent
Directory         <span class="m">493</span>  None                ...  SVProgressHUD.bundle

Directory         <span class="m">493</span>  None                ...  Base.lproj
Regular           <span class="m">420</span>  None                ...  Assets.car
Regular           <span class="m">420</span>  None                ...  PkgInfo
Directory         <span class="m">493</span>  None                ...  _CodeSignature
Regular           <span class="m">420</span>  None                ...  AppIcon60x60@3x.png

Directory         <span class="m">493</span>  None                ...  Frameworks

Regular           <span class="m">420</span>  None                ...  embedded.mobileprovision

Regular           <span class="m">420</span>  None                ...  Credentials.plist
Regular           <span class="m">420</span>  None                ...  Assets.plist
Regular           <span class="m">420</span>  None                ...  Info.plist

Regular           <span class="m">493</span>  None                ...  iGoat-Swift
</code></pre></div>
<p>You can also visualize the Bundle directory from Passionfruit by clicking on <strong>Files</strong> -&gt; <strong>App Bundle</strong>:</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_bundle_dir.png" width="100%" /></p>
<p>Including the <code>Info.plist</code> file:</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_plist_view.png" width="100%" /></p>
<p>As well as the Data directory in <strong>Files</strong> -&gt; <strong>Data</strong>:</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_data_dir.png" width="100%" /></p>
<p>Refer to the <a href="../0x06d-Testing-Data-Storage/" title="Data Storage on iOS">Testing Data Storage</a> chapter for more information and best practices on securely storing sensitive data.</p>
<h4 id="monitoring-system-logs">Monitoring System Logs<a class="headerlink" href="#monitoring-system-logs" title="Permanent link">&para;</a></h4>
<p>Many apps log informative (and potentially sensitive) messages to the console log. The log also contains crash reports and other useful information. You can collect console logs through the Xcode <strong>Devices</strong> window as follows:</p>
<ol>
<li>Launch Xcode.</li>
<li>Connect your device to your host computer.</li>
<li>Choose <strong>Window</strong> -&gt; <strong>Devices and Simulators</strong>.</li>
<li>Click on your connected iOS device in the left section of the Devices window.</li>
<li>Reproduce the problem.</li>
<li>Click on the <strong>Open Console</strong> button located in the upper right-hand area of the Devices window to view the console logs on a separate window.</li>
</ol>
<p><img src="../../assets/Images/Chapters/0x06b/open_device_console.png" width="100%" /></p>
<p>To save the console output to a text file, go to the top right side of the Console window and click on the <strong>Save</strong> button.</p>
<p><img src="../../assets/Images/Chapters/0x06b/device_console.png" width="100%" /></p>
<p>You can also connect to the device shell as explained in <a href="./#accessing-the-device-shell">Accessing the Device Shell</a>, install socat via apt-get and run the following command:</p>
<div class="highlight"><pre><span></span><code>iPhone:~ root# socat - UNIX-CONNECT:/var/run/lockdown/syslog.sock

<span class="o">========================</span>
ASL is here to serve you
&gt; watch
OK

Jun  <span class="m">7</span> <span class="m">13</span>:42:14 iPhone chmod<span class="o">[</span><span class="m">9705</span><span class="o">]</span> &lt;Notice&gt;: MS:Notice: Injecting: <span class="o">(</span>null<span class="o">)</span> <span class="o">[</span>chmod<span class="o">]</span> <span class="o">(</span><span class="m">1556</span>.00<span class="o">)</span>
Jun  <span class="m">7</span> <span class="m">13</span>:42:14 iPhone readlink<span class="o">[</span><span class="m">9706</span><span class="o">]</span> &lt;Notice&gt;: MS:Notice: Injecting: <span class="o">(</span>null<span class="o">)</span> <span class="o">[</span>readlink<span class="o">]</span> <span class="o">(</span><span class="m">1556</span>.00<span class="o">)</span>
Jun  <span class="m">7</span> <span class="m">13</span>:42:14 iPhone rm<span class="o">[</span><span class="m">9707</span><span class="o">]</span> &lt;Notice&gt;: MS:Notice: Injecting: <span class="o">(</span>null<span class="o">)</span> <span class="o">[</span>rm<span class="o">]</span> <span class="o">(</span><span class="m">1556</span>.00<span class="o">)</span>
Jun  <span class="m">7</span> <span class="m">13</span>:42:14 iPhone touch<span class="o">[</span><span class="m">9708</span><span class="o">]</span> &lt;Notice&gt;: MS:Notice: Injecting: <span class="o">(</span>null<span class="o">)</span> <span class="o">[</span>touch<span class="o">]</span> <span class="o">(</span><span class="m">1556</span>.00<span class="o">)</span>
...
</code></pre></div>
<p>Additionally, Passionfruit offers a view of all the NSLog-based application logs. Simply click on the <strong>Console</strong> -&gt; <strong>Output</strong> tab:</p>
<p><img src="../../assets/Images/Chapters/0x06b/passionfruit_console_logs.png" width="100%" /></p>
<h4 id="dumping-keychain-data">Dumping KeyChain Data<a class="headerlink" href="#dumping-keychain-data" title="Permanent link">&para;</a></h4>
<p>Dumping the KeyChain data can be done with multiple tools, but not all of them will work on any iOS version. As is more often the case, try the different tools or look up their documentation for information on the latest supported versions.</p>
<h5 id="objection-jailbroken-non-jailbroken">Objection (Jailbroken / non-Jailbroken)<a class="headerlink" href="#objection-jailbroken-non-jailbroken" title="Permanent link">&para;</a></h5>
<p>The KeyChain data can easily be viewed using Objection. First, connect objection to the app as described in "Recommended Tools - Objection". Then, use the <code>ios keychain dump</code> command to get an overview of the keychain:</p>
<div class="highlight"><pre><span></span><code>$ objection --gadget<span class="o">=</span><span class="s2">&quot;iGoat-Swift&quot;</span> explore
... <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ios keychain dump</span>
...
Note: You may be asked to authenticate using the devices passcode or TouchID
Save the output by adding <span class="sb">`</span>--json keychain.json<span class="sb">`</span> to this <span class="nb">command</span>
Dumping the iOS keychain...
Created                    Accessible                      ACL    Type      Account              Service                     Data
-------------------------  ------------------------------  -----  --------  -------------------  --------------------------  ----------------------------------------------------------------------
<span class="m">2019</span>-06-06 <span class="m">10</span>:53:09 +0000  WhenUnlocked                    None   Password  keychainValue        com.highaltitudehacks.dvia  mypassword123
<span class="m">2019</span>-06-06 <span class="m">10</span>:53:30 +0000  WhenUnlockedThisDeviceOnly      None   Password  SCAPILazyVector      com.toyopagroup.picaboo     <span class="o">(</span>failed to decode<span class="o">)</span>
<span class="m">2019</span>-06-06 <span class="m">10</span>:53:30 +0000  AfterFirstUnlockThisDeviceOnly  None   Password  fideliusDeviceGraph  com.toyopagroup.picaboo     <span class="o">(</span>failed to decode<span class="o">)</span>
<span class="m">2019</span>-06-06 <span class="m">10</span>:53:30 +0000  AfterFirstUnlockThisDeviceOnly  None   Password  SCDeviceTokenKey2    com.toyopagroup.picaboo     <span class="m">00001</span>:FKsDMgVISiavdm70v9Fhv5z+pZfBTTN7xkwSwNvVr2IhVBqLsC7QBhsEjKMxrEjh
<span class="m">2019</span>-06-06 <span class="m">10</span>:53:30 +0000  AfterFirstUnlockThisDeviceOnly  None   Password  SCDeviceTokenValue2  com.toyopagroup.picaboo     <span class="nv">CJ8Y8K2oE3rhOFUhnxJxDS1Zp8Z25XzgY2EtFyMbW3U</span><span class="o">=</span>
OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">12</span>.0<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># quit  </span>
</code></pre></div>
<p>Note that currently, the latest versions of frida-server and objection do not correctly decode all keychain data. Different combinations can be tried to increase compatibility. For example, the previous printout was created with <code>frida-tools==1.3.0</code>, <code>frida==12.4.8</code> and <code>objection==1.5.0</code>.</p>
<p>Finally, since the keychain dumper is executed from within the application context, it will only print out keychain items that can be accessed by the application and <strong>not</strong> the entire keychain of the iOS device.</p>
<h5 id="passionfruit-jailbroken-non-jailbroken">Passionfruit (Jailbroken / non-Jailbroken)<a class="headerlink" href="#passionfruit-jailbroken-non-jailbroken" title="Permanent link">&para;</a></h5>
<p>With <a href="../0x08-Testing-Tools/#passionfruit">Passionfruit</a> it's possible to access the keychain data of the app you have selected. Click on <strong>Storage</strong> -&gt; <strong>Keychain</strong> and you can see a listing of the stored Keychain information.</p>
<p><img src="../../assets/Images/Chapters/0x06b/Passionfruit_Keychain.png" width="100%" /></p>
<h5 id="keychain-dumper-jailbroken">Keychain-dumper (Jailbroken)<a class="headerlink" href="#keychain-dumper-jailbroken" title="Permanent link">&para;</a></h5>
<p>You can use <a href="../0x08-Testing-Tools/#keychain-dumper">Keychain-dumper</a> dump the jailbroken device's KeyChain contents. Once you have it running on your device:</p>
<div class="highlight"><pre><span></span><code>iPhone:~ root# /tmp/keychain_dumper

<span class="o">(</span>...<span class="o">)</span>

Generic Password
----------------
Service: myApp
Account: key3
Entitlement Group: RUD9L355Y.sg.vantagepoint.example
Label: <span class="o">(</span>null<span class="o">)</span>
Generic Field: <span class="o">(</span>null<span class="o">)</span>
Keychain Data: SmJSWxEs

Generic Password
----------------
Service: myApp
Account: key7
Entitlement Group: RUD9L355Y.sg.vantagepoint.example
Label: <span class="o">(</span>null<span class="o">)</span>
Generic Field: <span class="o">(</span>null<span class="o">)</span>
Keychain Data: WOg1DfuH
</code></pre></div>
<p>In newer versions of iOS (iOS 11 and up), additional steps are necessary. See the README.md for more details.
Note that this binary is signed with a self-signed certificate that has a "wildcard" entitlement. The entitlement grants access to <em>all</em> items in the Keychain. If you are paranoid or have very sensitive private data on your test device, you may want to build the tool from source and manually sign the appropriate entitlements into your build; instructions for doing this are available in the GitHub repository.</p>
<h2 id="setting-up-a-network-testing-environment">Setting Up a Network Testing Environment<a class="headerlink" href="#setting-up-a-network-testing-environment" title="Permanent link">&para;</a></h2>
<h3 id="basic-network-monitoringsniffing">Basic Network Monitoring/Sniffing<a class="headerlink" href="#basic-network-monitoringsniffing" title="Permanent link">&para;</a></h3>
<p>You can remotely sniff all traffic in real-time on iOS by <a href="https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819" title="Wireshark + OSX + iOS">creating a Remote Virtual Interface</a> for your iOS device. First make sure you have <a href="../0x08-Testing-Tools/#wireshark">Wireshark</a> installed on your macOS host computer.</p>
<ol>
<li>Connect your iOS device to your macOS host computer via USB.</li>
<li>You would need to know the UDID of your iOS device, before you can start sniffing. Check the section "Getting the UDID of an iOS device" on how to retrieve it. Open the Terminal on macOS and enter the following command, filling in the UDID of your iOS device.</li>
</ol>
<div class="highlight"><pre><span></span><code>$ rvictl -s &lt;UDID&gt;
Starting device &lt;UDID&gt; <span class="o">[</span>SUCCEEDED<span class="o">]</span> with interface rvi0
</code></pre></div>
<ol>
<li>Launch Wireshark and select "rvi0" as the capture interface.</li>
<li>Filter the traffic with Capture Filters in Wireshark to display what you want to monitor (for example, all HTTP traffic sent/received via the IP address 192.168.1.1).</li>
</ol>
<div class="highlight"><pre><span></span><code>ip.addr == 192.168.1.1 &amp;&amp; http
</code></pre></div>
<p><img src="../../assets/Images/Chapters/0x06b/wireshark_filters.png" width="100%" /></p>
<p>The documentation of Wireshark offers many examples for <a href="https://wiki.wireshark.org/CaptureFilters" title="Capture Filters">Capture Filters</a> that should help you to filter the traffic to get the information you want.</p>
<h3 id="setting-up-an-interception-proxy">Setting up an Interception Proxy<a class="headerlink" href="#setting-up-an-interception-proxy" title="Permanent link">&para;</a></h3>
<p><a href="../0x08-Testing-Tools/#burp-suite">Burp Suite</a> is an integrated platform for security testing mobile and web applications. Its tools work together seamlessly to support the entire testing process, from initial mapping and analysis of attack surfaces to finding and exploiting security vulnerabilities. Burp Proxy operates as a web proxy server for Burp Suite, which is positioned as a man-in-the-middle between the browser and web server(s). Burp Suite allows you to intercept, inspect, and modify incoming and outgoing raw HTTP traffic.</p>
<p>Setting up Burp to proxy your traffic is pretty straightforward. We assume that both your iOS device and host computer are connected to a Wi-Fi network that permits client-to-client traffic. If client-to-client traffic is not permitted, you can use usbmuxd to connect to Burp via USB.</p>
<p>PortSwigger provides a good <a href="https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp" title="Configuring an iOS Device to Work With Burp">tutorial on setting up an iOS device to work with Burp</a> and a <a href="https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device" title="Installing Burp\'s CA Certificate in an iOS Device">tutorial on installing Burp's CA certificate to an iOS device</a>.</p>
<h4 id="using-burp-via-usb-on-a-jailbroken-device">Using Burp via USB on a Jailbroken Device<a class="headerlink" href="#using-burp-via-usb-on-a-jailbroken-device" title="Permanent link">&para;</a></h4>
<p>In the section <a href="./#accessing-the-device-shell">Accessing the Device Shell</a> we've already learned how we can use <a href="../0x08-Testing-Tools/#iproxy">iproxy</a> to use SSH via USB. When doing dynamic analysis, it's interesting to use the SSH connection to route our traffic to Burp that is running on our computer. Let's get started:</p>
<p>First we need to use iproxy to make SSH from iOS available on localhost.</p>
<div class="highlight"><pre><span></span><code>$ iproxy <span class="m">2222</span> <span class="m">22</span>
waiting <span class="k">for</span> connection
</code></pre></div>
<p>The next step is to make a remote port forwarding of port 8080 on the iOS device to the localhost interface on our computer to port 8080.</p>
<div class="highlight"><pre><span></span><code>ssh -R <span class="m">8080</span>:localhost:8080 root@localhost -p <span class="m">2222</span>
</code></pre></div>
<p>You should now be able to reach Burp on your iOS device. Open Safari on iOS and go to 127.0.0.1:8080 and you should see the Burp Suite Page. This would also be a good time to <a href="https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device" title="Installing Burp\'s CA Certificate in an iOS Device">install the CA certificate</a> of Burp on your iOS device.</p>
<p>The last step would be to set the proxy globally on your iOS device:</p>
<ol>
<li>Go to <strong>Settings</strong> -&gt; <strong>Wi-Fi</strong></li>
<li>Connect to <em>any</em> Wi-Fi (you can literally connect to any Wi-Fi as the traffic for port 80 and 443 will be routed through USB, as we are just using the Proxy Setting for the Wi-Fi so we can set a global Proxy)</li>
<li>Once connected click on the small blue icon on the right side of the connect Wi-Fi</li>
<li>Configure your Proxy by selecting <strong>Manual</strong></li>
<li>Type in 127.0.0.1 as <strong>Server</strong></li>
<li>Type in 8080 as <strong>Port</strong></li>
</ol>
<p>Open Safari and go to any webpage, you should see now the traffic in Burp. Thanks @hweisheimer for the <a href="https://twitter.com/hweisheimer/status/1095383526885724161" title="Port Forwarding via USB on iOS">initial idea</a>!</p>
<h3 id="certificate-pinning">Certificate Pinning<a class="headerlink" href="#certificate-pinning" title="Permanent link">&para;</a></h3>
<p>Some applications will implement SSL Pinning, which prevents the application from accepting your intercepting certificate as a valid certificate. This means that you will not be able to monitor the traffic between the application and the server.</p>
<p>For information on disabling SSL Pinning both statically and dynamically, refer to "Bypassing SSL Pinning" in the "Testing Network Communication" chapter.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Jailbreak Exploits - <a href="https://www.theiphonewiki.com/wiki/Jailbreak_Exploits">https://www.theiphonewiki.com/wiki/Jailbreak_Exploits</a></li>
<li>limera1n exploit - <a href="https://www.theiphonewiki.com/wiki/Limera1n">https://www.theiphonewiki.com/wiki/Limera1n</a></li>
<li>IPSW Downloads website - <a href="https://ipsw.me">https://ipsw.me</a></li>
<li>Can I Jailbreak? - <a href="https://canijailbreak.com/">https://canijailbreak.com/</a></li>
<li>The iPhone Wiki - <a href="https://www.theiphonewiki.com/">https://www.theiphonewiki.com/</a></li>
<li>Redmond Pie - <a href="https://www.redmondpie.com/">https://www.redmondpie.com/</a></li>
<li>Reddit Jailbreak - <a href="https://www.reddit.com/r/jailbreak/">https://www.reddit.com/r/jailbreak/</a></li>
<li>Information Property List - <a href="https://developer.apple.com/documentation/bundleresources/information_property_list?language=objc">https://developer.apple.com/documentation/bundleresources/information_property_list?language=objc</a></li>
<li>UIDeviceFamily - <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW11">https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW11</a></li>
</ul>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0x06a-Platform-Overview/" class="md-footer__link md-footer__link--prev" aria-label="Previous: iOS Platform Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              iOS Platform Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="../0x06c-Reverse-Engineering-and-Tampering/" class="md-footer__link md-footer__link--next" aria-label="Next: iOS Tampering and Reverse Engineering" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              iOS Tampering and Reverse Engineering
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="float: left; padding-right: 1em;">
  <a href="https://www.owasp.org"><img src="https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/OWASP_logo_white.png?raw=true" width="100px" /></a>
</div>
<span>
  &#169; OWASP Foundation 2022. This work is licensed under 
  <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>. For any reuse or distribution, you must make clear to others the license terms of this work.
</span>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://owasp.slack.com/messages/project-mobile_omtg/details/" target="_blank" rel="noopener" title="owasp.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/OWASP_MSTG" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/OWASP/owasp-mstg/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>