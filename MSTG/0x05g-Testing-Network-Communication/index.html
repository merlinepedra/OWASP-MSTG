
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo_circle.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Android Network APIs - OWASP Mobile Security Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#android-network-apis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OWASP Mobile Security Project" class="md-header__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Mobile Security Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Android Network APIs
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../donate/" class="md-tabs__link">
      ♡ Donations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../news/" class="md-tabs__link">
      News
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0x01-Foreword/" class="md-tabs__link md-tabs__link--active">
        MSTG
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Mobile Security Project" class="md-nav__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    OWASP Mobile Security Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../donate/" class="md-nav__link">
        ♡ Donations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        News
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          MSTG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSTG" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          MSTG
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x01-Foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02a-Frontispiece/" class="md-nav__link">
        Frontispiece
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02b-MASVS-MSTG-Adoption/" class="md-nav__link">
        OWASP MASVS and MSTG Adoption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02c-Acknowledgements/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x03-Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04a-Mobile-App-Taxonomy/" class="md-nav__link">
        Mobile App Taxonomy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04b-Mobile-App-Security-Testing/" class="md-nav__link">
        Mobile App Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04c-Tampering-and-Reverse-Engineering/" class="md-nav__link">
        Mobile App Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04e-Testing-Authentication-and-Session-Management/" class="md-nav__link">
        Mobile App Authentication Architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04f-Testing-Network-Communication/" class="md-nav__link">
        Mobile App Network Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04g-Testing-Cryptography/" class="md-nav__link">
        Mobile App Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04h-Testing-Code-Quality/" class="md-nav__link">
        Mobile App Code Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04i-Testing-User-Privacy-Protection/" class="md-nav__link">
        Mobile App User Privacy Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05a-Platform-Overview/" class="md-nav__link">
        Android Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05b-Basic-Security_Testing/" class="md-nav__link">
        Android Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        Android Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05d-Testing-Data-Storage/" class="md-nav__link">
        Android Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05e-Testing-Cryptography/" class="md-nav__link">
        Android Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05f-Testing-Local-Authentication/" class="md-nav__link">
        Android Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Android Network APIs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Android Network APIs
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#testing-endpoint-identify-verification-mstg-network-3" class="md-nav__link">
    Testing Endpoint Identify Verification (MSTG-NETWORK-3)
  </a>
  
    <nav class="md-nav" aria-label="Testing Endpoint Identify Verification (MSTG-NETWORK-3)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    Static Analysis
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifying-the-server-certificate" class="md-nav__link">
    Verifying the Server Certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webview-server-certificate-verification" class="md-nav__link">
    WebView Server Certificate Verification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-cordova-certificate-verification" class="md-nav__link">
    Apache Cordova Certificate Verification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hostname-verification" class="md-nav__link">
    Hostname Verification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-custom-certificate-stores-and-certificate-pinning-mstg-network-4" class="md-nav__link">
    Testing Custom Certificate Stores and Certificate Pinning (MSTG-NETWORK-4)
  </a>
  
    <nav class="md-nav" aria-label="Testing Custom Certificate Stores and Certificate Pinning (MSTG-NETWORK-4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-the-pin-fails" class="md-nav__link">
    When the Pin Fails
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_1" class="md-nav__link">
    Static Analysis
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-security-configuration" class="md-nav__link">
    Network Security Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trustmanager" class="md-nav__link">
    TrustManager
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-libraries-and-webviews" class="md-nav__link">
    Network Libraries and WebViews
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xamarin-applications" class="md-nav__link">
    Xamarin Applications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cordova-applications" class="md-nav__link">
    Cordova Applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_1" class="md-nav__link">
    Dynamic Analysis
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bypassing-certificate-pinning" class="md-nav__link">
    Bypassing Certificate Pinning
  </a>
  
    <nav class="md-nav" aria-label="Bypassing Certificate Pinning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bypass-custom-certificate-pinning-statically" class="md-nav__link">
    Bypass Custom Certificate Pinning Statically
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-custom-certificate-pinning-dynamically" class="md-nav__link">
    Bypass Custom Certificate Pinning Dynamically
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-network-security-configuration-settings-mstg-network-4" class="md-nav__link">
    Testing the Network Security Configuration Settings (MSTG-NETWORK-4)
  </a>
  
    <nav class="md-nav" aria-label="Testing the Network Security Configuration Settings (MSTG-NETWORK-4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trust-anchors" class="md-nav__link">
    Trust Anchors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_2" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_2" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-security-provider-mstg-network-6" class="md-nav__link">
    Testing the Security Provider (MSTG-NETWORK-6)
  </a>
  
    <nav class="md-nav" aria-label="Testing the Security Provider (MSTG-NETWORK-6)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_2" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_3" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_3" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#owasp-masvs" class="md-nav__link">
    OWASP MASVS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-developer-documentation" class="md-nav__link">
    Android Developer Documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xamarin-certificate-pinning" class="md-nav__link">
    Xamarin Certificate Pinning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cordova-certificate-pinning" class="md-nav__link">
    Cordova Certificate Pinning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05h-Testing-Platform-Interaction/" class="md-nav__link">
        Android Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        Android Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        Android Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06a-Platform-Overview/" class="md-nav__link">
        iOS Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06b-Basic-Security-Testing/" class="md-nav__link">
        iOS Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        iOS Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06d-Testing-Data-Storage/" class="md-nav__link">
        iOS Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06e-Testing-Cryptography/" class="md-nav__link">
        iOS Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06f-Testing-Local-Authentication/" class="md-nav__link">
        iOS Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06g-Testing-Network-Communication/" class="md-nav__link">
        iOS Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06h-Testing-Platform-Interaction/" class="md-nav__link">
        iOS Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        iOS Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        iOS Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x07-Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x08-Testing-Tools/" class="md-nav__link">
        Testing Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x09-Suggested-Reading/" class="md-nav__link">
        Suggested Reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-nav__link">
        How Can You Contribute?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/2_Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/3_PRs_and_Reviews/" class="md-nav__link">
        Pull Requests & Reviews
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/4_Add_new_Language/" class="md-nav__link">
        Add a New Language
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/5_Style_Guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/OWASP/owasp-mstg/edit/master/docs/MSTG/0x05g-Testing-Network-Communication.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="android-network-apis">Android Network APIs<a class="headerlink" href="#android-network-apis" title="Permanent link">&para;</a></h1>
<h2 id="testing-endpoint-identify-verification-mstg-network-3">Testing Endpoint Identify Verification (MSTG-NETWORK-3)<a class="headerlink" href="#testing-endpoint-identify-verification-mstg-network-3" title="Permanent link">&para;</a></h2>
<p>Using TLS to transport sensitive information over the network is essential for security. However, encrypting communication between a mobile application and its backend API is not trivial. Developers often decide on simpler but less secure solutions (e.g., those that accept any certificate) to facilitate the development process, and sometimes these weak solutions <a href="https://saschafahl.de/static/paper/androidssl2012.pdf" title="Hunting Down Broken SSL in Android Apps">make it into the production version</a>, potentially exposing users to <a href="https://cwe.mitre.org/data/definitions/295.html" title="CWE-295: Improper Certificate Validation">man-in-the-middle attacks</a>.</p>
<p>Two key issues should be addressed:</p>
<ul>
<li>Verify that a certificate comes from a trusted source, i.e. a trusted CA (Certificate Authority).</li>
<li>Determine whether the endpoint server presents the right certificate.</li>
</ul>
<p>Make sure that the hostname and the certificate itself are verified correctly. Examples and common pitfalls are available in the <a href="https://developer.android.com/training/articles/security-ssl.html" title="Android Documentation - SSL">official Android documentation</a>. Search the code for examples of <code>TrustManager</code> and <code>HostnameVerifier</code> usage. In the sections below, you can find examples of the kind of insecure usage that you should look for.</p>
<blockquote>
<p>Note that from Android 8.0 (API level 26) onward, there is no support for SSLv3 and <code>HttpsURLConnection</code> will no longer perform a fallback to an insecure TLS/SSL protocol.</p>
</blockquote>
<h3 id="static-analysis">Static Analysis<a class="headerlink" href="#static-analysis" title="Permanent link">&para;</a></h3>
<h4 id="verifying-the-server-certificate">Verifying the Server Certificate<a class="headerlink" href="#verifying-the-server-certificate" title="Permanent link">&para;</a></h4>
<p><code>TrustManager</code> is a means of verifying conditions necessary for establishing a trusted connection in Android. The following conditions should be checked at this point:</p>
<ul>
<li>Has the certificate been signed by a trusted CA?</li>
<li>Has the certificate expired?</li>
<li>Is the certificate self-signed?</li>
</ul>
<p>The following code snippet is sometimes used during development and will accept any certificate, overwriting the functions <code>checkClientTrusted</code>, <code>checkServerTrusted</code>, and <code>getAcceptedIssuers</code>. Such implementations should be avoided, and, if they are necessary, they should be clearly separated from production builds to avoid built-in security flaws.</p>
<div class="highlight"><pre><span></span><code><span class="n">TrustManager</span><span class="o">[]</span><span class="w"> </span><span class="n">trustAllCerts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TrustManager</span><span class="o">[]</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">X509TrustManager</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">X509Certificate</span><span class="o">[]</span><span class="w"> </span><span class="nf">getAcceptedIssuers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">security</span><span class="p">.</span><span class="na">cert</span><span class="p">.</span><span class="na">X509Certificate</span><span class="o">[]</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">checkClientTrusted</span><span class="p">(</span><span class="n">X509Certificate</span><span class="o">[]</span><span class="w"> </span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authType</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">CertificateException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">checkServerTrusted</span><span class="p">(</span><span class="n">X509Certificate</span><span class="o">[]</span><span class="w"> </span><span class="n">chain</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authType</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">CertificateException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="c1">// SSLContext context</span><span class="w"></span>
<span class="n">context</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">trustAllCerts</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">());</span><span class="w"></span>
</code></pre></div>
<h4 id="webview-server-certificate-verification">WebView Server Certificate Verification<a class="headerlink" href="#webview-server-certificate-verification" title="Permanent link">&para;</a></h4>
<p>Sometimes applications use a WebView to render the website associated with the application. This is true of HTML/JavaScript-based frameworks such as Apache Cordova, which uses an internal WebView for application interaction. When a WebView is used, the mobile browser performs the server certificate validation. Ignoring any TLS error that occurs when the WebView tries to connect to the remote website is a bad practice.</p>
<p>The following code will ignore TLS issues, exactly like the WebViewClient custom implementation provided to the WebView:</p>
<div class="highlight"><pre><span></span><code><span class="n">WebView</span><span class="w"> </span><span class="n">myWebView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">WebView</span><span class="p">)</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">webview</span><span class="p">);</span><span class="w"></span>
<span class="n">myWebView</span><span class="p">.</span><span class="na">setWebViewClient</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WebViewClient</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onReceivedSslError</span><span class="p">(</span><span class="n">WebView</span><span class="w"> </span><span class="n">view</span><span class="p">,</span><span class="w"> </span><span class="n">SslErrorHandler</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span><span class="w"> </span><span class="n">SslError</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//Ignore TLS certificate errors and instruct the WebViewClient to load the website</span><span class="w"></span>
<span class="w">        </span><span class="n">handler</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<h4 id="apache-cordova-certificate-verification">Apache Cordova Certificate Verification<a class="headerlink" href="#apache-cordova-certificate-verification" title="Permanent link">&para;</a></h4>
<p>Implementation of the Apache Cordova framework's internal WebView usage will ignore <a href="https://github.com/apache/cordova-android/blob/master/framework/src/org/apache/cordova/engine/SystemWebViewClient.java" title="TLS errors ignoring by Apache Cordova in WebView">TLS errors</a> in the method <code>onReceivedSslError</code> if the flag <code>android:debuggable</code> is enabled in the application manifest. Therefore, make sure that the app is not debuggable. See the test case "Testing If the App is Debuggable".</p>
<h4 id="hostname-verification">Hostname Verification<a class="headerlink" href="#hostname-verification" title="Permanent link">&para;</a></h4>
<p>Another security flaw in client-side TLS implementations is the lack of hostname verification. Development environments usually use internal addresses instead of valid domain names, so developers often disable hostname verification (or force an application to allow any hostname) and simply forget to change it when their application goes to production. The following code disables hostname verification:</p>
<div class="highlight"><pre><span></span><code><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">HostnameVerifier</span><span class="w"> </span><span class="n">NO_VERIFY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HostnameVerifier</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"> </span><span class="n">SSLSession</span><span class="w"> </span><span class="n">session</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>With a built-in <code>HostnameVerifier</code>, accepting any hostname is possible:</p>
<div class="highlight"><pre><span></span><code><span class="n">HostnameVerifier</span><span class="w"> </span><span class="n">NO_VERIFY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">apache</span><span class="p">.</span><span class="na">http</span><span class="p">.</span><span class="na">conn</span><span class="p">.</span><span class="na">ssl</span><span class="p">.</span><span class="na">SSLSocketFactory</span><span class="w"></span>
<span class="w">                             </span><span class="p">.</span><span class="na">ALLOW_ALL_HOSTNAME_VERIFIER</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Make sure that your application verifies a hostname before setting a trusted connection.</p>
<h3 id="dynamic-analysis">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis" title="Permanent link">&para;</a></h3>
<p>Dynamic analysis requires an interception proxy. To test improper certificate verification, check the following controls:</p>
<ul>
<li>Self-signed certificate</li>
</ul>
<p>In Burp, go to the <strong>Proxy</strong> tab, select the <strong>Options</strong> tab, then go to the <strong>Proxy Listeners</strong> section, highlight your listener, and click <strong>Edit</strong>. Then go to the <strong>Certificate</strong> tab, check <strong>Use a self-signed certificate</strong>, and click <strong>Ok</strong>. Now, run your application. If you're able to see HTTPS traffic, your application is accepting self-signed certificates.</p>
<ul>
<li>Accepting certificates with an untrusted CA</li>
</ul>
<p>In Burp, go to the <strong>Proxy</strong> tab, select the <strong>Options</strong> tab, then go to the <strong>Proxy Listeners</strong> section, highlight your listener, and click <strong>Edit</strong>. Then go to the <strong>Certificate</strong> tab, check <strong>Generate a CA-signed certificate with a specific hostname</strong>, and type in the backend server's hostname. Now, run your application. If you're able to see HTTPS traffic, your application is accepting certificates with an untrusted CA.</p>
<ul>
<li>Accepting incorrect hostnames</li>
</ul>
<p>In Burp, go to the <strong>Proxy</strong> tab, select the <strong>Options</strong> tab, then go to the <strong>Proxy Listeners</strong> section, highlight your listener, and click <strong>Edit</strong>. Then go to the <strong>Certificate</strong> tab, check <strong>Generate a CA-signed certificate with a specific hostname</strong>, and type in an invalid hostname, e.g., example.org. Now, run your application. If you're able to see HTTPS traffic, your application is accepting all hostnames.</p>
<p>If you're interested in further MITM analysis or you have problems with the configuration of your interception proxy, consider using <a href="https://insights.sei.cmu.edu/cert/2014/08/-announcing-cert-tapioca-for-mitm-analysis.html" title="Announcing CERT Tapioca for MITM Analysis">Tapioca</a>. It's a CERT pre-configured <a href="http://www.cert.org/download/mitm/CERT_Tapioca.ova" title="CERT Tapioca Virtual Machine Download">VM appliance</a> for MITM software analysis. All you have to do is <a href="https://insights.sei.cmu.edu/cert/2014/09/-finding-android-ssl-vulnerabilities-with-cert-tapioca.html" title="Finding Android SSL vulnerabilities with CERT Tapioca">deploy a tested application on an emulator and start capturing traffic</a>.</p>
<h2 id="testing-custom-certificate-stores-and-certificate-pinning-mstg-network-4">Testing Custom Certificate Stores and Certificate Pinning (MSTG-NETWORK-4)<a class="headerlink" href="#testing-custom-certificate-stores-and-certificate-pinning-mstg-network-4" title="Permanent link">&para;</a></h2>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h3>
<p>Certificate pinning is the process of associating the backend server with a particular X.509 certificate or public key instead of accepting any certificate signed by a trusted certificate authority. After storing ("pinning") the server certificate or public key, the mobile app will subsequently connect to the known server only. Withdrawing trust from external certificate authorities reduces the attack surface (after all, there are many cases of certificate authorities that have been compromised or tricked into issuing certificates to impostors).</p>
<p>The certificate can be pinned and hardcoded into the app or retrieved at the time the app first connects to the backend. In the latter case, the certificate is associated with ("pinned" to) the host when the host is seen for the first time. This alternative is less secure because attackers intercepting the initial connection can inject their own certificates.</p>
<h4 id="when-the-pin-fails">When the Pin Fails<a class="headerlink" href="#when-the-pin-fails" title="Permanent link">&para;</a></h4>
<p>Note that there are various options when dealing with a failing pin:</p>
<ul>
<li>Inform the user about not being able to connect to the backend and stop all operations. The app can check whether there is an update and inform the user about updating to the latest version of the app if available. The app allows no longer for any form of interaction with the user until it is updated or the pin works again.</li>
<li>Do a call to a crash-reporting service including information about the failed pin. The responsible developers should get notified about a potential security misconfiguration.</li>
<li>The app calls the backend using a TLS enabled call with no pinning to inform the backend of a pinning failure. The call can either differ in user-agent, JWT token-contents, or have other headers with a flag enabled as an indication of pinning failure.</li>
<li>After calling the backend or crash-reporting service to notify about the failing pinning, the app can still offer limited functionality that shouldn't involve sensitive functions or processing of sensitive data. The communication would happen without SSL Pinning and just validate the X.509 certificate accordingly.</li>
</ul>
<p>Which option(s) you choose depends on how important availability is compared to the complexity of maintaining the application.</p>
<p>When a large amount of pin failures are reported to the backend or crash-reporting service, the developer should understand that there is probably a misconfiguration. There is a large chance that the key materials used at the TLS terminating endpoint (e.g. server/loadbalancer) is different than what the app is expecting. In that case, an update of either that key material or an update of the app should be pushed through.</p>
<p>When only very few pin failures are reported, then the network should be ok, and so should be the configuration of the TLS terminating endpoint. Instead, it might well be that there is a man-in-the-middle attack ongoing at the app instance of which the pin is failing.</p>
<h3 id="static-analysis_1">Static Analysis<a class="headerlink" href="#static-analysis_1" title="Permanent link">&para;</a></h3>
<h4 id="network-security-configuration">Network Security Configuration<a class="headerlink" href="#network-security-configuration" title="Permanent link">&para;</a></h4>
<p>To customize their network security settings in a safe, declarative configuration file without modifying app code, applications can use the <a href="https://developer.android.com/training/articles/security-config.html" title="Network Security Configuration documentation">Network Security Configuration</a> that Android provides for versions 7.0 and above.</p>
<p>The Network Security Configuration can also be used to pin <a href="https://developer.android.com/training/articles/security-config.html#CertificatePinning" title="Certificate Pinning using Network Security Configuration">declarative certificates</a> to specific domains. If an application uses this feature, two things should be checked to identify the defined configuration:</p>
<p>First, find the Network Security Configuration file in the Android application manifest via the <code>android:networkSecurityConfig</code> attribute on the application tag:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="na">package=</span><span class="s">&quot;owasp.com.app&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;application</span> <span class="na">android:networkSecurityConfig=</span><span class="s">&quot;@xml/network_security_config&quot;</span><span class="nt">&gt;</span>
        ...
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<p>Open the identified file. In this case, the file can be found at "res/xml/network_security_config.xml":</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;network-security-config&gt;</span>
    <span class="nt">&lt;domain-config&gt;</span>
        Use certificate pinning for OWASP website access including sub domains
        <span class="nt">&lt;domain</span> <span class="na">includeSubdomains=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>owasp.org<span class="nt">&lt;/domain&gt;</span>
        <span class="nt">&lt;pin-set</span> <span class="na">expiration=</span><span class="s">&quot;2018/8/10&quot;</span><span class="nt">&gt;</span>
            <span class="cm">&lt;!-- Hash of the public key (SubjectPublicKeyInfo of the X.509 certificate) of</span>
<span class="cm">            the Intermediate CA of the OWASP website server certificate --&gt;</span>
            <span class="nt">&lt;pin</span> <span class="na">digest=</span><span class="s">&quot;SHA-256&quot;</span><span class="nt">&gt;</span>YLh1dUR9y6Kja30RrAn7JKnbQG/uEtLMkBgFF2Fuihg=<span class="nt">&lt;/pin&gt;</span>
            <span class="cm">&lt;!-- Hash of the public key (SubjectPublicKeyInfo of the X.509 certificate) of</span>
<span class="cm">            the Root CA of the OWASP website server certificate --&gt;</span>
            <span class="nt">&lt;pin</span> <span class="na">digest=</span><span class="s">&quot;SHA-256&quot;</span><span class="nt">&gt;</span>Vjs8r4z+80wjNcr1YKepWQboSIRi63WsWXhIMN+eWys=<span class="nt">&lt;/pin&gt;</span>
        <span class="nt">&lt;/pin-set&gt;</span>
    <span class="nt">&lt;/domain-config&gt;</span>
<span class="nt">&lt;/network-security-config&gt;</span>
</code></pre></div>
<blockquote>
<p>The pin-set contains a set of public key pins. Each set can define an expiration date. When the expiration date is reached, the network communication will continue to work, but the Certificate Pinning will be disabled for the affected domains.</p>
</blockquote>
<p>If a configuration exists, the following event may be visible in the log:</p>
<div class="highlight"><pre><span></span><code>D/NetworkSecurityConfig: Using Network Security Config from resource network_security_config
</code></pre></div>
<p>If a certificate pinning validation check has failed, the following event will be logged:</p>
<div class="highlight"><pre><span></span><code>I/X509Util: Failed to validate the certificate chain, error: Pin verification failed
</code></pre></div>
<p>Using a decompiler (e.g. jadx or apktool) we will be able to confirm if the <code>&lt;pin&gt;</code> entry is present in the network_security_config.xml file located in the /res/xml/ folder.</p>
<h4 id="trustmanager">TrustManager<a class="headerlink" href="#trustmanager" title="Permanent link">&para;</a></h4>
<p>Implementing certificate pinning involves three main steps:</p>
<ul>
<li>Obtain the certificate of the desired host(s).</li>
<li>Make sure the certificate is in .bks format.</li>
<li>Pin the certificate to an instance of the default Apache Httpclient.</li>
</ul>
<p>To analyze the correct implementation of certificate pinning, the HTTP client should load the KeyStore:</p>
<div class="highlight"><pre><span></span><code><span class="n">InputStream</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resources</span><span class="p">.</span><span class="na">openRawResource</span><span class="p">(</span><span class="n">certificateRawResource</span><span class="p">);</span><span class="w"></span>
<span class="n">keyStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyStore</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;BKS&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">keyStore</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">resourceStream</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Once the KeyStore has been loaded, we can use the TrustManager that trusts the CAs in our KeyStore:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">tmfAlgorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TrustManagerFactory</span><span class="p">.</span><span class="na">getDefaultAlgorithm</span><span class="p">();</span><span class="w"></span>
<span class="n">TrustManagerFactory</span><span class="w"> </span><span class="n">tmf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TrustManagerFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">tmfAlgorithm</span><span class="p">);</span><span class="w"></span>
<span class="n">tmf</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">keyStore</span><span class="p">);</span><span class="w"></span>
<span class="c1">// Create an SSLContext that uses the TrustManager</span><span class="w"></span>
<span class="c1">// SSLContext context = SSLContext.getInstance(&quot;TLS&quot;);</span><span class="w"></span>
<span class="n">sslContext</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">tmf</span><span class="p">.</span><span class="na">getTrustManagers</span><span class="p">(),</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>The app's implementation may be different, pinning against the certificate's public key only, the whole certificate, or a whole certificate chain.</p>
<h4 id="network-libraries-and-webviews">Network Libraries and WebViews<a class="headerlink" href="#network-libraries-and-webviews" title="Permanent link">&para;</a></h4>
<p>Applications that use third-party networking libraries may utilize the libraries' certificate pinning functionality. For example, <a href="https://github.com/square/okhttp/wiki/HTTPS" title="okhttp library">okhttp</a> can be set up with the <code>CertificatePinner</code> as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">OkHttpClient</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OkHttpClient</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">certificatePinner</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CertificatePinner</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sha256/UwQAapahrjCOjYI3oLUx5AQxPBR02Jz6/E2pt0IeLXA=&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w"></span>
</code></pre></div>
<p>Applications that use a WebView component may utilize the WebViewClient's event handler for some kind of "certificate pinning" of each request before the target resource is loaded. The following code shows an example verification:</p>
<div class="highlight"><pre><span></span><code><span class="n">WebView</span><span class="w"> </span><span class="n">myWebView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">WebView</span><span class="p">)</span><span class="w"> </span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">webview</span><span class="p">);</span><span class="w"></span>
<span class="n">myWebView</span><span class="p">.</span><span class="na">setWebViewClient</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WebViewClient</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">expectedIssuerDN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CN=Let&#39;s Encrypt Authority X3,O=Let&#39;s Encrypt,C=US;&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onLoadResource</span><span class="p">(</span><span class="n">WebView</span><span class="w"> </span><span class="n">view</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//From Android API documentation about &quot;WebView.getCertificate()&quot;:</span><span class="w"></span>
<span class="w">        </span><span class="c1">//Gets the SSL certificate for the main top-level page</span><span class="w"></span>
<span class="w">        </span><span class="c1">//or null if there is no certificate (the site is not secure).</span><span class="w"></span>
<span class="w">        </span><span class="c1">//</span><span class="w"></span>
<span class="w">        </span><span class="c1">//Available information on SslCertificate class are &quot;Issuer DN&quot;, &quot;Subject DN&quot; and validity date helpers</span><span class="w"></span>
<span class="w">        </span><span class="n">SslCertificate</span><span class="w"> </span><span class="n">serverCert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">.</span><span class="na">getCertificate</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">serverCert</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="c1">//apply either certificate or public key pinning comparison here</span><span class="w"></span>
<span class="w">                </span><span class="c1">//Throw exception to cancel resource loading...</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>Alternatively, it is better to use an OkHttpClient with configured pins and let it act as a proxy overriding <code>shouldInterceptRequest</code> of the <code>WebViewClient</code>.</p>
<h4 id="xamarin-applications">Xamarin Applications<a class="headerlink" href="#xamarin-applications" title="Permanent link">&para;</a></h4>
<p>Applications developed in Xamarin will typically use ServicePointManager to implement pinning.</p>
<p>Normally a function is created to check the certificate(s) and return the boolean value to the method ServerCertificateValidationCallback:</p>
<div class="highlight"><pre><span></span><code><span class="na">[Activity(Label = &quot;XamarinPinning&quot;, MainLauncher = true)]</span><span class="w"></span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Activity</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// SupportedPublicKey - Hexadecimal value of the public key.</span>
<span class="w">        </span><span class="c1">// Use GetPublicKeyString() method to determine the public key of the certificate we want to pin. Uncomment the debug code in the ValidateServerCertificate function a first time to determine the value to pin.</span>
<span class="w">        </span><span class="k">private</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">SupportedPublicKey</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;3082010A02820101009CD30CF05AE52E47B7725D3783B...&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Shortened for readability</span>

<span class="w">        </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">ValidateServerCertificate</span><span class="p">(</span><span class="w"></span>
<span class="w">                </span><span class="kt">object</span><span class="w"> </span><span class="n">sender</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">X509Certificate</span><span class="w"> </span><span class="n">certificate</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">X509Chain</span><span class="w"> </span><span class="n">chain</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="n">SslPolicyErrors</span><span class="w"> </span><span class="n">sslPolicyErrors</span><span class="w"></span>
<span class="w">            </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//Log.Debug(&quot;Xamarin Pinning&quot;,chain.ChainElements[X].Certificate.GetPublicKeyString());</span>
<span class="w">            </span><span class="c1">//return true;</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">SupportedPublicKey</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">chain</span><span class="p">.</span><span class="n">ChainElements</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">Certificate</span><span class="p">.</span><span class="n">GetPublicKeyString</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">ServicePointManager</span><span class="p">.</span><span class="n">ServerCertificateValidationCallback</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">ValidateServerCertificate</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">base</span><span class="p">.</span><span class="n">OnCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">SetContentView</span><span class="p">(</span><span class="n">Resource</span><span class="p">.</span><span class="n">Layout</span><span class="p">.</span><span class="n">Main</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">TesteAsync</span><span class="p">(</span><span class="s">&quot;https://security.claudio.pt&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>In this particular example we are pinning the intermediate CA of the certificate chain. The output of the HTTP response will be available in the system logs.</p>
<p>Sample Xamarin app with the previous example can be obtained on the <a href="https://github.com/OWASP/owasp-mstg/raw/master/Samples/Android/02_CertificatePinning/certificatePinningXamarin.apk" title="Xamarin app with certificate pinning">MSTG repository</a></p>
<p>After decompressing the APK file, use a .NET decompiler like dotPeak, ILSpy or dnSpy to decompile the app dlls stored inside the 'Assemblies' folder and confirm the usage of the ServicePointManager.</p>
<h4 id="cordova-applications">Cordova Applications<a class="headerlink" href="#cordova-applications" title="Permanent link">&para;</a></h4>
<p>Hybrid applications based on Cordova do not support Certificate Pinning natively, so plugins are used to achieve this. The most common one is PhoneGap SSL Certificate Checker. The <code>check</code> method is used to confirm the fingerprint and callbacks will determine the next steps.</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="c1">// Endpoint to verify against certificate pinning.</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://www.owasp.org&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="c1">// SHA256 Fingerprint (Can be obtained via &quot;openssl s_client -connect hostname:443 | openssl x509 -noout -fingerprint -sha256&quot;</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;D8 EF 3C DF 7E F6 44 BA 04 EC D5 97 14 BB 00 4A 7A F5 26 63 53 87 4E 76 67 77 F0 F4 CC ED 67 B9&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="nb">window</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">sslCertificateChecker</span><span class="p">.</span><span class="nx">check</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="nx">successCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">errorCallback</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">server</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nx">fingerprint</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="kd">function</span><span class="w"> </span><span class="nx">successCallback</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="nx">alert</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Message is always: CONNECTION_SECURE.</span><span class="w"></span>
<span class="w">     </span><span class="c1">// Now do something with the trusted server.</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>

<span class="w">   </span><span class="kd">function</span><span class="w"> </span><span class="nx">errorCallback</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="nx">alert</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;CONNECTION_NOT_SECURE&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="c1">// There is likely a man in the middle attack going on, be careful!</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;CONNECTION_FAILED&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;-</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="c1">// There was no connection (yet). Internet may be down. Try again (a few times) after a little timeout.</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>After decompressing the APK file, Cordova/Phonegap files will be located in the /assets/www folder. The 'plugins' folder will give you the visibility of the plugins used. We will need to search for this methods in the JavaScript code of the application to confirm its usage.</p>
<h3 id="dynamic-analysis_1">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_1" title="Permanent link">&para;</a></h3>
<p>Dynamic analysis can be performed by launching a MITM attack with your preferred interception proxy. This will allow you to monitor the traffic between the client (the mobile application) and the backend server. If the proxy is unable to intercept the HTTP requests and responses, the SSL pinning has been implemented correctly.</p>
<h4 id="bypassing-certificate-pinning">Bypassing Certificate Pinning<a class="headerlink" href="#bypassing-certificate-pinning" title="Permanent link">&para;</a></h4>
<p>There are several ways to bypass certificate pinning for a black box test, depending on the frameworks available on the device:</p>
<ul>
<li>Cydia Substrate: Install the <a href="https://github.com/iSECPartners/Android-SSL-TrustKiller" title="Android-SSL-TrustKiller">Android-SSL-TrustKiller</a> package.</li>
<li>Frida: Use the <a href="https://codeshare.frida.re/@pcipolloni/universal-android-ssl-pinning-bypass-with-frida/" title="Universal Android SSL Pinning Bypass with Frida">Universal Android SSL Pinning Bypass with Frida</a> script.</li>
<li>Objection: Use the <code>android sslpinning disable</code> command.</li>
<li>Xposed: Install the <a href="https://github.com/ViRb3/TrustMeAlready" title="TrustMeAlready">TrustMeAlready</a> or <a href="https://github.com/ac-pm/SSLUnpinning_Xposed" title="SSLUnpinning">SSLUnpinning</a> module.</li>
</ul>
<p>For most applications, certificate pinning can be bypassed within seconds, but only if the app uses the API functions that are covered by these tools. If the app is implementing SSL Pinning with a custom framework or library, the SSL Pinning must be manually patched and deactivated, which can be time-consuming.</p>
<h5 id="bypass-custom-certificate-pinning-statically">Bypass Custom Certificate Pinning Statically<a class="headerlink" href="#bypass-custom-certificate-pinning-statically" title="Permanent link">&para;</a></h5>
<p>Somewhere in the application, both the endpoint and the certificate (or its hash) must be defined. After decompiling the application, you can search for:</p>
<ul>
<li>Certificate hashes: <code>grep -ri "sha256\|sha1" ./smali</code>. Replace the identified hashes with the hash of your proxy's CA. Alternatively, if the hash is accompanied by a domain name, you can try modifying the domain name to a non-existing domain so that the original domain is not pinned. This works well on obfuscated OkHTTP implementations.</li>
<li>Certificate files: <code>find ./assets -type f \( -iname \*.cer -o -iname \*.crt \)</code>. Replace these files with your proxy's certificates, making sure they are in the correct format.</li>
<li>Truststore files: <code>find ./ -type f \( -iname \*.jks -o -iname \*.bks \)</code>. Add your proxy's certificates to the truststore and make sure they are in the correct format.</li>
</ul>
<blockquote>
<p>Keep in mind that an app might contain files without extension. The most common file locations are <code>assets</code> and <code>res</code> directories, which should also be investigated.</p>
</blockquote>
<p>As an example, let's say that you find an application which uses a BKS (BouncyCastle) truststore and it's stored in the file <code>res/raw/truststore.bks</code>. To bypass SSL Pinning you need to add your proxy's certificate to the truststore with the command line tool <code>keytool</code>. <code>Keytool</code> comes with the Java SDK and the following values are needed to execute the command:</p>
<ul>
<li>password - Password for the keystore. Look in the decompiled app code for the hardcoded password.</li>
<li>providerpath - Location of the BouncyCastle Provider jar file. You can download it from <a href="https://www.bouncycastle.org/latest_releases.html" title="https://www.bouncycastle.org/latest_releases.html">The Legion of the Bouncy Castle</a>.</li>
<li>proxy.cer - Your proxy's certificate.</li>
<li>aliascert - Unique value which will be used as alias for your proxy's certificate.</li>
</ul>
<p>To add your proxy's certificate use the following command:</p>
<div class="highlight"><pre><span></span><code>$ keytool -importcert -v -trustcacerts -file proxy.cer -alias aliascert -keystore <span class="s2">&quot;res/raw/truststore.bks&quot;</span> -provider org.bouncycastle.jce.provider.BouncyCastleProvider -providerpath <span class="s2">&quot;providerpath/bcprov-jdk15on-164.jar&quot;</span> -storetype BKS -storepass password
</code></pre></div>
<p>To list certificates in the BKS truststore use the following command:</p>
<div class="highlight"><pre><span></span><code>$ keytool -list -keystore <span class="s2">&quot;res/raw/truststore.bks&quot;</span> -provider org.bouncycastle.jce.provider.BouncyCastleProvider -providerpath <span class="s2">&quot;providerpath/bcprov-jdk15on-164.jar&quot;</span>  -storetype BKS -storepass password
</code></pre></div>
<p>After making these modifications, repackage the application using apktool and install it on your device.</p>
<p>If the application uses native libraries to implement network communication, further reverse engineering is needed. An example of such an approach can be found in the blog post <a href="https://serializethoughts.wordpress.com/2016/08/18/bypassing-ssl-pinning-in-android-applications/" title="Bypassing SSL Pinning in Android Applications">Identifying the SSL Pinning logic in smali code, patching it, and reassembling the APK</a></p>
<h5 id="bypass-custom-certificate-pinning-dynamically">Bypass Custom Certificate Pinning Dynamically<a class="headerlink" href="#bypass-custom-certificate-pinning-dynamically" title="Permanent link">&para;</a></h5>
<p>Bypassing the pinning logic dynamically makes it more convenient as there is no need to bypass any integrity checks and it's much faster to perform trial &amp; error attempts.</p>
<p>Finding the correct method to hook is typically the hardest part and can take quite some time depending on the level of obfuscation. As developers typically reuse existing libraries, it is a good approach to search for strings and license files that identify the used library. Once the library has been identified, examine the non-obfuscated source code to find methods which are suited for dynamic instrumentation.</p>
<p>As an example, let's say that you find an application which uses an obfuscated OkHTTP3 library. The <a href="https://square.github.io/okhttp/3.x/okhttp/" title="OkHTTP3 documentation">documentation</a> shows that the CertificatePinner.Builder class is responsible for adding pins for specific domains. If you can modify the arguments to the <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/CertificatePinner.Builder.html#add-java.lang.String-java.lang.String...-" title="Builder.add method">Builder.add method</a>, you can change the hashes to the correct hashes belonging to your certificate. Finding the correct method can be done in either two ways:</p>
<ul>
<li>Search for hashes and domain names as explained in the previous section. The actual pinning method will typically be used or defined in close proximity to these strings</li>
<li>Search for the method signature in the SMALI code</li>
</ul>
<p>For the Builder.add method, you can find the possible methods by running the following grep command: <code>grep -ri java/lang/String;\[Ljava/lang/String;)L ./</code></p>
<p>This command will search for all methods that take a string and a variable list of strings as arguments, and return a complex object. Depending on the size of the application, this may have one or multiple matches in the code.</p>
<p>Hook each method with Frida and print the arguments. One of them will print out a domain name and a certificate hash, after which you can modify the arguments to circumvent the implemented pinning.</p>
<h2 id="testing-the-network-security-configuration-settings-mstg-network-4">Testing the Network Security Configuration Settings (MSTG-NETWORK-4)<a class="headerlink" href="#testing-the-network-security-configuration-settings-mstg-network-4" title="Permanent link">&para;</a></h2>
<h3 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h3>
<p>Network Security Configuration was introduced on Android 7.0 (API level 24) and lets apps customize their network security settings such as custom trust anchors and certificate pinning.</p>
<h4 id="trust-anchors">Trust Anchors<a class="headerlink" href="#trust-anchors" title="Permanent link">&para;</a></h4>
<p>When running on Android 7.0 (API level 24) or higher, apps targeting those API levels will use a default Network Security Configuration that doesn't trust any user supplied CAs, reducing the possibility of MITM attacks by luring users to install malicious CAs.</p>
<p>This protection can be bypassed by using a custom Network Security Configuration with a custom trust anchor indicating that the app will trust user supplied CAs.</p>
<h3 id="static-analysis_2">Static Analysis<a class="headerlink" href="#static-analysis_2" title="Permanent link">&para;</a></h3>
<p>Use a decompiler (e.g. jadx or apktool) to confirm the target SDK version. After decoding the app you can look for the presence of <code>targetSDK</code> present in the file apktool.yml that was created in the output folder.</p>
<p>The Network Security Configuration should be analyzed to determine what settings are configured. The file is located inside the APK in the /res/xml/ folder with the name network_security_config.xml.</p>
<p>If there are custom <code>&lt;trust-anchors&gt;</code> present in a <code>&lt;base-config&gt;</code> or <code>&lt;domain-config&gt;</code>, that define a <code>&lt;certificates src="user"&gt;</code> the application will trust user supplied CAs for those particular domains or for all domains. Example:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;network-security-config&gt;</span>
    <span class="nt">&lt;base-config&gt;</span>
        <span class="nt">&lt;trust-anchors&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;system&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;user&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/trust-anchors&gt;</span>
    <span class="nt">&lt;/base-config&gt;</span>
    <span class="nt">&lt;domain-config&gt;</span>
        <span class="nt">&lt;domain</span> <span class="na">includeSubdomains=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>owasp.org<span class="nt">&lt;/domain&gt;</span>
        <span class="nt">&lt;trust-anchors&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;system&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;user&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/trust-anchors&gt;</span>
        <span class="nt">&lt;pin-set</span> <span class="na">expiration=</span><span class="s">&quot;2018/8/10&quot;</span><span class="nt">&gt;</span>
            <span class="cm">&lt;!-- Hash of the public key (SubjectPublicKeyInfo of the X.509 certificate) of</span>
<span class="cm">            the Intermediate CA of the OWASP website server certificate --&gt;</span>
            <span class="nt">&lt;pin</span> <span class="na">digest=</span><span class="s">&quot;SHA-256&quot;</span><span class="nt">&gt;</span>YLh1dUR9y6Kja30RrAn7JKnbQG/uEtLMkBgFF2Fuihg=<span class="nt">&lt;/pin&gt;</span>
            <span class="cm">&lt;!-- Hash of the public key (SubjectPublicKeyInfo of the X.509 certificate) of</span>
<span class="cm">            the Root CA of the OWASP website server certificate --&gt;</span>
            <span class="nt">&lt;pin</span> <span class="na">digest=</span><span class="s">&quot;SHA-256&quot;</span><span class="nt">&gt;</span>Vjs8r4z+80wjNcr1YKepWQboSIRi63WsWXhIMN+eWys=<span class="nt">&lt;/pin&gt;</span>
        <span class="nt">&lt;/pin-set&gt;</span>
    <span class="nt">&lt;/domain-config&gt;</span>
<span class="nt">&lt;/network-security-config&gt;</span>
</code></pre></div>
<p>Is important to understand the precedence of entries. If a value is not set in a <code>&lt;domain-config\&gt;</code> entry or in a parent <code>&lt;domain-config\&gt;</code>, the configurations in place will be based on the <code>&lt;base-config\&gt;</code>, and lastly if not defined in this entry, the default configuration will be used.</p>
<p>The default configuration for apps targeting Android 9 (API level 28) and higher is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;base-config</span> <span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;trust-anchors&gt;</span>
        <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;system&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/trust-anchors&gt;</span>
<span class="nt">&lt;/base-config&gt;</span>
</code></pre></div>
<p>The default configuration for apps targeting Android 7.0 (API level 24) to Android 8.1 (API level 27) is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;base-config</span> <span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;trust-anchors&gt;</span>
        <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;system&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/trust-anchors&gt;</span>
<span class="nt">&lt;/base-config&gt;</span>
</code></pre></div>
<p>The default configuration for apps targeting Android 6.0 (API level 23) and lower is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;base-config</span> <span class="na">cleartextTrafficPermitted=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;trust-anchors&gt;</span>
        <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;system&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;certificates</span> <span class="na">src=</span><span class="s">&quot;user&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/trust-anchors&gt;</span>
<span class="nt">&lt;/base-config&gt;</span>
</code></pre></div>
<h3 id="dynamic-analysis_2">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_2" title="Permanent link">&para;</a></h3>
<p>You can test the Network Security Configuration settings of a target app by using a dynamic approach, typically using an interception proxy such as Burp. However, it might be possible that you're not able to see the traffic at first, e.g. when testing an app targeting Android 7.0 (API level 24) or higher and effectively applying the Network Security Configuration. In that situation, you should patch the Network Security Configuration file. You'll find the necessary steps in section "<a href="../0x05b-Basic-Security_Testing/#bypassing-the-network-security-configuration" title="Bypassing the Network Security Configuration">Bypassing the Network Security Configuration</a>" in the "Android Basic Security Testing" chapter.</p>
<p>There might still be scenarios where this is not needed and you can still do MITM attacks without patching:</p>
<ul>
<li>When the app is running on an Android device with Android 7.0 (API level 24) onwards, but the app targets API levels below 24, it will not use the Network Security Configuration file. Instead, the app will still trust any user supplied CAs.</li>
<li>When the app is running on an Android device with Android 7.0 (API level 24) onwards and there is no custom Network Security Configuration implemented in the app.</li>
</ul>
<h2 id="testing-the-security-provider-mstg-network-6">Testing the Security Provider (MSTG-NETWORK-6)<a class="headerlink" href="#testing-the-security-provider-mstg-network-6" title="Permanent link">&para;</a></h2>
<h3 id="overview_2">Overview<a class="headerlink" href="#overview_2" title="Permanent link">&para;</a></h3>
<p>Android relies on a security provider to provide SSL/TLS-based connections. The problem with this kind of security provider (one example is <a href="https://www.openssl.org/news/vulnerabilities.html" title="OpenSSL Vulnerabilities">OpenSSL</a>), which comes with the device, is that it often has bugs and/or vulnerabilities.
To avoid known vulnerabilities, developers need to make sure that the application will install a proper security provider.
Since July 11, 2016, Google <a href="https://support.google.com/faqs/answer/6376725?hl=en" title="How to address OpenSSL vulnerabilities in your apps">has been rejecting Play Store application submissions</a> (both new applications and updates) that use vulnerable versions of OpenSSL.</p>
<h3 id="static-analysis_3">Static Analysis<a class="headerlink" href="#static-analysis_3" title="Permanent link">&para;</a></h3>
<p>Applications based on the Android SDK should depend on GooglePlayServices. For example, in the gradle build file, you will find <code>compile 'com.google.android.gms:play-services-gcm:x.x.x'</code> in the dependencies block. You need to make sure that the <code>ProviderInstaller</code> class is called with either <code>installIfNeeded</code> or <code>installIfNeededAsync</code>. <code>ProviderInstaller</code> needs to be called by a component of the application as early as possible. Exceptions thrown by these methods should be caught and handled correctly.
If the application cannot patch its security provider, it can either inform the API of its less secure state or restrict user actions (because all HTTPS traffic should be deemed riskier in this situation).</p>
<p>Here are two <a href="https://developer.android.com/training/articles/security-gms-provider.html" title="Updating Your Security Provider to Protect Against SSL Exploits">examples from the Android Developer documentation</a> that show how to update Security Provider to prevent SSL exploits. In both cases, the developer needs to handle the exceptions properly, and reporting to the backend when the application is working with an unpatched security provider may be wise.</p>
<p>Patching Synchronously:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//this is a sync adapter that runs in the background, so you can run the synchronous patching.</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SyncAdapter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AbstractThreadedSyncAdapter</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="p">...</span><span class="w"></span>

<span class="w">  </span><span class="c1">// This is called each time a sync is attempted; this is okay, since the</span><span class="w"></span>
<span class="w">  </span><span class="c1">// overhead is negligible if the security provider is up-to-date.</span><span class="w"></span>
<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onPerformSync</span><span class="p">(</span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="p">,</span><span class="w"> </span><span class="n">Bundle</span><span class="w"> </span><span class="n">extras</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authority</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">ContentProviderClient</span><span class="w"> </span><span class="n">provider</span><span class="p">,</span><span class="w"> </span><span class="n">SyncResult</span><span class="w"> </span><span class="n">syncResult</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">ProviderInstaller</span><span class="p">.</span><span class="na">installIfNeeded</span><span class="p">(</span><span class="n">getContext</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">GooglePlayServicesRepairableException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Indicates that Google Play services is out of date, disabled, etc.</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Prompt the user to install/update/enable Google Play services.</span><span class="w"></span>
<span class="w">      </span><span class="n">GooglePlayServicesUtil</span><span class="p">.</span><span class="na">showErrorNotification</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">e</span><span class="p">.</span><span class="na">getConnectionStatusCode</span><span class="p">(),</span><span class="w"> </span><span class="n">getContext</span><span class="p">());</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Notify the SyncManager that a soft error occurred.</span><span class="w"></span>
<span class="w">      </span><span class="n">syncResult</span><span class="p">.</span><span class="na">stats</span><span class="p">.</span><span class="na">numIOExceptions</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">GooglePlayServicesNotAvailableException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Indicates a non-recoverable error; the ProviderInstaller is not able</span><span class="w"></span>
<span class="w">      </span><span class="c1">// to install an up-to-date Provider.</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Notify the SyncManager that a hard error occurred.</span><span class="w"></span>
<span class="w">      </span><span class="c1">//in this case: make sure that you inform your API of it.</span><span class="w"></span>
<span class="w">      </span><span class="n">syncResult</span><span class="p">.</span><span class="na">stats</span><span class="p">.</span><span class="na">numAuthExceptions</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// If this is reached, you know that the provider was already up-to-date,</span><span class="w"></span>
<span class="w">    </span><span class="c1">// or was successfully updated.</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Patching Asynchronously:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//This is the mainactivity/first activity of the application that&#39;s there long enough to make the async installing of the securityprovider work.</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainActivity</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Activity</span><span class="w"></span>
<span class="w">    </span><span class="kd">implements</span><span class="w"> </span><span class="n">ProviderInstaller</span><span class="p">.</span><span class="na">ProviderInstallListener</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ERROR_DIALOG_REQUEST_CODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">mRetryProviderInstall</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="c1">//Update the security provider when the activity is created.</span><span class="w"></span>
<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">savedInstanceState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">ProviderInstaller</span><span class="p">.</span><span class="na">installIfNeededAsync</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * This method is only called if the provider is successfully updated</span>
<span class="cm">   * (or is already up-to-date).</span>
<span class="cm">   */</span><span class="w"></span>
<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onProviderInstalled</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Provider is up-to-date, app can make secure network calls.</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * This method is called if updating fails; the error code indicates</span>
<span class="cm">   * whether the error is recoverable.</span>
<span class="cm">   */</span><span class="w"></span>
<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onProviderInstallFailed</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">errorCode</span><span class="p">,</span><span class="w"> </span><span class="n">Intent</span><span class="w"> </span><span class="n">recoveryIntent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GooglePlayServicesUtil</span><span class="p">.</span><span class="na">isUserRecoverableError</span><span class="p">(</span><span class="n">errorCode</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Recoverable error. Show a dialog prompting the user to</span><span class="w"></span>
<span class="w">      </span><span class="c1">// install/update/enable Google Play services.</span><span class="w"></span>
<span class="w">      </span><span class="n">GooglePlayServicesUtil</span><span class="p">.</span><span class="na">showErrorDialogFragment</span><span class="p">(</span><span class="w"></span>
<span class="w">          </span><span class="n">errorCode</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="k">this</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">ERROR_DIALOG_REQUEST_CODE</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="k">new</span><span class="w"> </span><span class="n">DialogInterface</span><span class="p">.</span><span class="na">OnCancelListener</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCancel</span><span class="p">(</span><span class="n">DialogInterface</span><span class="w"> </span><span class="n">dialog</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="c1">// The user chose not to take the recovery action</span><span class="w"></span>
<span class="w">              </span><span class="n">onProviderInstallerNotAvailable</span><span class="p">();</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Google Play services is not available.</span><span class="w"></span>
<span class="w">      </span><span class="n">onProviderInstallerNotAvailable</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onActivityResult</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">requestCode</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">resultCode</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">Intent</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onActivityResult</span><span class="p">(</span><span class="n">requestCode</span><span class="p">,</span><span class="w"> </span><span class="n">resultCode</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">requestCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ERROR_DIALOG_REQUEST_CODE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Adding a fragment via GooglePlayServicesUtil.showErrorDialogFragment</span><span class="w"></span>
<span class="w">      </span><span class="c1">// before the instance state is restored throws an error. So instead,</span><span class="w"></span>
<span class="w">      </span><span class="c1">// set a flag here, which will cause the fragment to delay until</span><span class="w"></span>
<span class="w">      </span><span class="c1">// onPostResume.</span><span class="w"></span>
<span class="w">      </span><span class="n">mRetryProviderInstall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * On resume, check to see if we flagged that we need to reinstall the</span>
<span class="cm">   * provider.</span>
<span class="cm">   */</span><span class="w"></span>
<span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onPostResume</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">super</span><span class="p">.</span><span class="na">onPostResult</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mRetryProviderInstall</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// We can now safely retry installation.</span><span class="w"></span>
<span class="w">      </span><span class="n">ProviderInstall</span><span class="p">.</span><span class="na">installIfNeededAsync</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">mRetryProviderInstall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onProviderInstallerNotAvailable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// This is reached if the provider cannot be updated for some reason.</span><span class="w"></span>
<span class="w">    </span><span class="c1">// App should consider all HTTP communication to be vulnerable, and take</span><span class="w"></span>
<span class="w">    </span><span class="c1">// appropriate action (e.g. inform backend, block certain high-risk actions, etc.).</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Make sure that NDK-based applications bind only to a recent and properly patched library that provides SSL/TLS functionality.</p>
<h3 id="dynamic-analysis_3">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_3" title="Permanent link">&para;</a></h3>
<p>When you have the source code:</p>
<ul>
<li>Run the application in debug mode, then create a breakpoint where the app will first contact the endpoint(s).</li>
<li>Right click the highlighted code and select <code>Evaluate Expression</code>.</li>
<li>Type <code>Security.getProviders()</code> and press enter.</li>
<li>Check the providers and try to find <code>GmsCore_OpenSSL</code>, which should be the new top-listed provider.</li>
</ul>
<p>When you do not have the source code:</p>
<ul>
<li>Use Xposed to hook into the <code>java.security</code> package, then hook into <code>java.security.Security</code> with the method <code>getProviders</code> (with no arguments). The return value will be an array of <code>Provider</code>.</li>
<li>Determine whether the first provider is <code>GmsCore_OpenSSL</code>.</li>
</ul>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<h4 id="owasp-masvs">OWASP MASVS<a class="headerlink" href="#owasp-masvs" title="Permanent link">&para;</a></h4>
<ul>
<li>MSTG-NETWORK-2: "The TLS settings are in line with current best practices, or as close as possible if the mobile operating system does not support the recommended standards."</li>
<li>MSTG-NETWORK-3: "The app verifies the X.509 certificate of the remote endpoint when the secure channel is established. Only certificates signed by a trusted CA are accepted."</li>
<li>MSTG-NETWORK-4: "The app either uses its own certificate store, or pins the endpoint certificate or public key, and subsequently does not establish connections with endpoints that offer a different certificate or key, even if signed by a trusted CA."</li>
<li>MSTG-NETWORK-6: "The app only depends on up-to-date connectivity and security libraries."</li>
</ul>
<h4 id="android-developer-documentation">Android Developer Documentation<a class="headerlink" href="#android-developer-documentation" title="Permanent link">&para;</a></h4>
<ul>
<li>Network Security Configuration - <a href="https://developer.android.com/training/articles/security-config">https://developer.android.com/training/articles/security-config</a></li>
<li>Network Security Configuration (cached alternative) - <a href="https://webcache.googleusercontent.com/search?q=cache:hOONLxvMTwYJ:https://developer.android.com/training/articles/security-config+&amp;cd=10&amp;hl=nl&amp;ct=clnk&amp;gl=nl">https://webcache.googleusercontent.com/search?q=cache:hOONLxvMTwYJ:https://developer.android.com/training/articles/security-config+&amp;cd=10&amp;hl=nl&amp;ct=clnk&amp;gl=nl</a></li>
</ul>
<h4 id="xamarin-certificate-pinning">Xamarin Certificate Pinning<a class="headerlink" href="#xamarin-certificate-pinning" title="Permanent link">&para;</a></h4>
<ul>
<li>Certificate and Public Key Pinning with Xamarin - <a href="https://thomasbandt.com/certificate-and-public-key-pinning-with-xamarin">https://thomasbandt.com/certificate-and-public-key-pinning-with-xamarin</a></li>
<li>ServicePointManager - <a href="https://msdn.microsoft.com/en-us/library/system.net.servicepointmanager(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/system.net.servicepointmanager(v=vs.110).aspx</a></li>
</ul>
<h4 id="cordova-certificate-pinning">Cordova Certificate Pinning<a class="headerlink" href="#cordova-certificate-pinning" title="Permanent link">&para;</a></h4>
<ul>
<li>PhoneGap SSL Certificate Checker plugin - <a href="https://github.com/EddyVerbruggen/SSLCertificateChecker-PhoneGap-Plugin">https://github.com/EddyVerbruggen/SSLCertificateChecker-PhoneGap-Plugin</a></li>
</ul>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0x05f-Testing-Local-Authentication/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Android Local Authentication" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Android Local Authentication
            </div>
          </div>
        </a>
      
      
        
        <a href="../0x05h-Testing-Platform-Interaction/" class="md-footer__link md-footer__link--next" aria-label="Next: Android Platform APIs" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Android Platform APIs
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="float: left; padding-right: 1em;">
  <a href="https://www.owasp.org"><img src="https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/OWASP_logo_white.png?raw=true" width="100px" /></a>
</div>
<span>
  &#169; OWASP Foundation 2022. This work is licensed under 
  <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>. For any reuse or distribution, you must make clear to others the license terms of this work.
</span>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://owasp.slack.com/messages/project-mobile_omtg/details/" target="_blank" rel="noopener" title="owasp.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/OWASP_MSTG" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/OWASP/owasp-mstg/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>