
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo_circle.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>iOS Tampering and Reverse Engineering - OWASP Mobile Security Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ios-tampering-and-reverse-engineering" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OWASP Mobile Security Project" class="md-header__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Mobile Security Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              iOS Tampering and Reverse Engineering
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../donate/" class="md-tabs__link">
      ♡ Donations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../news/" class="md-tabs__link">
      News
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0x01-Foreword/" class="md-tabs__link md-tabs__link--active">
        MSTG
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Mobile Security Project" class="md-nav__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    OWASP Mobile Security Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../donate/" class="md-nav__link">
        ♡ Donations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        News
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          MSTG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSTG" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          MSTG
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x01-Foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02a-Frontispiece/" class="md-nav__link">
        Frontispiece
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02b-MASVS-MSTG-Adoption/" class="md-nav__link">
        OWASP MASVS and MSTG Adoption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02c-Acknowledgements/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x03-Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04a-Mobile-App-Taxonomy/" class="md-nav__link">
        Mobile App Taxonomy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04b-Mobile-App-Security-Testing/" class="md-nav__link">
        Mobile App Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04c-Tampering-and-Reverse-Engineering/" class="md-nav__link">
        Mobile App Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04e-Testing-Authentication-and-Session-Management/" class="md-nav__link">
        Mobile App Authentication Architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04f-Testing-Network-Communication/" class="md-nav__link">
        Mobile App Network Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04g-Testing-Cryptography/" class="md-nav__link">
        Mobile App Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04h-Testing-Code-Quality/" class="md-nav__link">
        Mobile App Code Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04i-Testing-User-Privacy-Protection/" class="md-nav__link">
        Mobile App User Privacy Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05a-Platform-Overview/" class="md-nav__link">
        Android Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05b-Basic-Security_Testing/" class="md-nav__link">
        Android Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        Android Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05d-Testing-Data-Storage/" class="md-nav__link">
        Android Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05e-Testing-Cryptography/" class="md-nav__link">
        Android Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05f-Testing-Local-Authentication/" class="md-nav__link">
        Android Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05g-Testing-Network-Communication/" class="md-nav__link">
        Android Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05h-Testing-Platform-Interaction/" class="md-nav__link">
        Android Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        Android Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        Android Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06a-Platform-Overview/" class="md-nav__link">
        iOS Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06b-Basic-Security-Testing/" class="md-nav__link">
        iOS Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          iOS Tampering and Reverse Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        iOS Tampering and Reverse Engineering
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reverse-engineering" class="md-nav__link">
    Reverse Engineering
  </a>
  
    <nav class="md-nav" aria-label="Reverse Engineering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disassembling-and-decompiling" class="md-nav__link">
    Disassembling and Decompiling
  </a>
  
    <nav class="md-nav" aria-label="Disassembling and Decompiling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disassembling-with-ida-pro" class="md-nav__link">
    Disassembling With IDA Pro
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    Static Analysis
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-information-gathering" class="md-nav__link">
    Basic Information Gathering
  </a>
  
    <nav class="md-nav" aria-label="Basic Information Gathering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-binary" class="md-nav__link">
    Application Binary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-strings" class="md-nav__link">
    Retrieving Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-references" class="md-nav__link">
    Cross References
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-usage" class="md-nav__link">
    API Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-communication" class="md-nav__link">
    Network Communication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-reversed-code-review" class="md-nav__link">
    Manual (Reversed) Code Review
  </a>
  
    <nav class="md-nav" aria-label="Manual (Reversed) Code Review">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reviewing-disassembled-objective-c-and-swift-code" class="md-nav__link">
    Reviewing Disassembled Objective-C and Swift Code
  </a>
  
    <nav class="md-nav" aria-label="Reviewing Disassembled Objective-C and Swift Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-c" class="md-nav__link">
    Objective-C
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reviewing-disassembled-native-code" class="md-nav__link">
    Reviewing Disassembled Native Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-static-analysis" class="md-nav__link">
    Automated Static Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    Dynamic Analysis
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis-on-non-jailbroken-devices" class="md-nav__link">
    Dynamic Analysis on Non-Jailbroken Devices
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Analysis on Non-Jailbroken Devices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-repackaging-with-objection" class="md-nav__link">
    Automated Repackaging with Objection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-repackaging" class="md-nav__link">
    Manual Repackaging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-a-developer-provisioning-profile-and-certificate" class="md-nav__link">
    Getting a Developer Provisioning Profile and Certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-information-gathering_1" class="md-nav__link">
    Basic Information Gathering
  </a>
  
    <nav class="md-nav" aria-label="Basic Information Gathering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#open-files" class="md-nav__link">
    Open Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loaded-native-libraries" class="md-nav__link">
    Loaded Native Libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sandbox-inspection" class="md-nav__link">
    Sandbox Inspection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Debugging
  </a>
  
    <nav class="md-nav" aria-label="Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-with-lldb" class="md-nav__link">
    Debugging with LLDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-release-apps" class="md-nav__link">
    Debugging Release Apps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracing" class="md-nav__link">
    Tracing
  </a>
  
    <nav class="md-nav" aria-label="Tracing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-tracing" class="md-nav__link">
    Method Tracing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-libraries-tracing" class="md-nav__link">
    Native Libraries Tracing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emulation-based-analysis" class="md-nav__link">
    Emulation-based Analysis
  </a>
  
    <nav class="md-nav" aria-label="Emulation-based Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ios-simulator" class="md-nav__link">
    iOS Simulator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corellium" class="md-nav__link">
    Corellium
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#binary-analysis" class="md-nav__link">
    Binary Analysis
  </a>
  
    <nav class="md-nav" aria-label="Binary Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unicorn" class="md-nav__link">
    Unicorn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#angr" class="md-nav__link">
    Angr
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tampering-and-runtime-instrumentation" class="md-nav__link">
    Tampering and Runtime Instrumentation
  </a>
  
    <nav class="md-nav" aria-label="Tampering and Runtime Instrumentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#patching-repackaging-and-re-signing" class="md-nav__link">
    Patching, Repackaging, and Re-Signing
  </a>
  
    <nav class="md-nav" aria-label="Patching, Repackaging, and Re-Signing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#patching-example-installing-frida-gadget" class="md-nav__link">
    Patching Example: Installing Frida Gadget
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patching-example-making-an-app-debuggable" class="md-nav__link">
    Patching Example: Making an App Debuggable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repackaging-and-re-signing" class="md-nav__link">
    Repackaging and Re-Signing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patching-react-native-applications" class="md-nav__link">
    Patching React Native applications
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-instrumentation" class="md-nav__link">
    Dynamic Instrumentation
  </a>
  
    <nav class="md-nav" aria-label="Dynamic Instrumentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#information-gathering" class="md-nav__link">
    Information Gathering
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-loaded-classes-and-their-methods" class="md-nav__link">
    Getting Loaded Classes and their Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-loaded-libraries" class="md-nav__link">
    Getting Loaded Libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-hooking" class="md-nav__link">
    Method Hooking
  </a>
  
    <nav class="md-nav" aria-label="Method Hooking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frida" class="md-nav__link">
    Frida
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-exploration" class="md-nav__link">
    Process Exploration
  </a>
  
    <nav class="md-nav" aria-label="Process Exploration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-maps-and-inspection" class="md-nav__link">
    Memory Maps and Inspection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-memory-search" class="md-nav__link">
    In-Memory Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-dump" class="md-nav__link">
    Memory Dump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-reverse-engineering" class="md-nav__link">
    Runtime Reverse Engineering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06d-Testing-Data-Storage/" class="md-nav__link">
        iOS Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06e-Testing-Cryptography/" class="md-nav__link">
        iOS Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06f-Testing-Local-Authentication/" class="md-nav__link">
        iOS Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06g-Testing-Network-Communication/" class="md-nav__link">
        iOS Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06h-Testing-Platform-Interaction/" class="md-nav__link">
        iOS Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        iOS Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        iOS Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x07-Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x08-Testing-Tools/" class="md-nav__link">
        Testing Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x09-Suggested-Reading/" class="md-nav__link">
        Suggested Reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-nav__link">
        How Can You Contribute?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/2_Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/3_PRs_and_Reviews/" class="md-nav__link">
        Pull Requests & Reviews
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/4_Add_new_Language/" class="md-nav__link">
        Add a New Language
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/5_Style_Guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/OWASP/owasp-mstg/edit/master/docs/MSTG/0x06c-Reverse-Engineering-and-Tampering.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="ios-tampering-and-reverse-engineering">iOS Tampering and Reverse Engineering<a class="headerlink" href="#ios-tampering-and-reverse-engineering" title="Permanent link">&para;</a></h1>
<h2 id="reverse-engineering">Reverse Engineering<a class="headerlink" href="#reverse-engineering" title="Permanent link">&para;</a></h2>
<p>iOS reverse engineering is a mixed bag. On one hand, apps programmed in Objective-C and Swift can be disassembled nicely. In Objective-C, object methods are called via dynamic function pointers called "selectors", which are resolved by name during runtime. The advantage of runtime name resolution is that these names need to stay intact in the final binary, making the disassembly more readable. Unfortunately, this also means that no direct cross-references between methods are available in the disassembler and constructing a flow graph is challenging.</p>
<p>In this guide, we'll introduce static and dynamic analysis and instrumentation. Throughout this chapter, we refer to the <a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes#ios" title="OWASP UnCrackable Apps for iOS">OWASP UnCrackable Apps for iOS</a>, so download them from the MSTG repository if you're planning to follow the examples.</p>
<h3 id="disassembling-and-decompiling">Disassembling and Decompiling<a class="headerlink" href="#disassembling-and-decompiling" title="Permanent link">&para;</a></h3>
<p>Because Objective-C and Swift are fundamentally different, the programming language in which the app is written affects the possibilities for reverse engineering it. For example, Objective-C allows method invocations to be changed at runtime. This makes hooking into other app functions (a technique heavily used by <a href="http://www.cycript.org/" title="Cycript">Cycript</a> and other reverse engineering tools) easy. This "method swizzling" is not implemented the same way in Swift, and the difference makes the technique harder to execute with Swift than with Objective-C.</p>
<p>On iOS, all the application code (both Swift and Objective-C) is compiled to machine code (e.g. ARM). Thus, to analyze iOS applications a disassembler is needed.</p>
<p>If you want to disassemble an application from the App Store, remove the Fairplay DRM first. Section "<a href="../0x06b-Basic-Security-Testing/#acquiring-the-app-binary" title="Acquiring the App Binary">Acquiring the App Binary</a>" in the chapter "iOS Basic Security Testing" explains how.</p>
<p>In this section the term "app binary" refers to the Macho-O file in the application bundle which contains the compiled code, and should not be confused with the application bundle - the IPA file. See section "<a href="../0x06b-Basic-Security-Testing/#exploring-the-app-package" title="Exploring the App Package">Exploring the App Package</a>" in chapter "Basic iOS Security Testing" for more details on the composition of IPA files.</p>
<h4 id="disassembling-with-ida-pro">Disassembling With IDA Pro<a class="headerlink" href="#disassembling-with-ida-pro" title="Permanent link">&para;</a></h4>
<p>If you have a license for IDA Pro, you can analyze the app binary using IDA Pro as well.</p>
<blockquote>
<p>The free version of IDA unfortunately does not support the ARM processor type.</p>
</blockquote>
<p>To get started, simply open the app binary in IDA Pro.</p>
<p><img src="../../assets/Images/Chapters/0x06c/ida_macho_import.png" width="100%" /></p>
<p>Upon opening the file, IDA Pro will perform auto-analysis, which can take a while depending on the size of the binary. Once the auto-analysis is completed you can browse the disassembly in the <strong>IDA View</strong> (Disassembly) window and explore functions in the <strong>Functions</strong> window, both shown in the screenshot below.</p>
<p><img src="../../assets/Images/Chapters/0x06c/ida_main_window.png" width="100%" /></p>
<p>A regular IDA Pro license does not include a decompiler by default and requires an additional license for the Hex-Rays decompiler, which is expensive. In contrast, Ghidra comes with a very capable free builtin decompiler, making it a compelling alternative to use for reverse engineering.</p>
<p>If you have a regular IDA Pro license and do not want to buy the Hex-Rays decompiler, you can use Ghidra's decompiler by installing the <a href="https://github.com/Cisco-Talos/GhIDA/">GhIDA plugin</a> for IDA Pro.</p>
<p>The majority of this chapter applies to applications written in Objective-C or having bridged types, which are types compatible with both Swift and Objective-C. The Swift compatibility of most tools that work well with Objective-C is being improved. For example, Frida supports <a href="https://github.com/frida/frida-swift" title="Frida-swift">Swift bindings</a>.</p>
<h2 id="static-analysis">Static Analysis<a class="headerlink" href="#static-analysis" title="Permanent link">&para;</a></h2>
<p>The preferred method of statically analyzing iOS apps involves using the original Xcode project files. Ideally, you will be able to compile and debug the app to quickly identify any potential issues with the source code.</p>
<p>Black box analysis of iOS apps without access to the original source code requires reverse engineering. For example, no decompilers are available for iOS apps (although most commercial and open-source disassemblers can provide a pseudo-source code view of the binary), so a deep inspection requires you to read assembly code.</p>
<h3 id="basic-information-gathering">Basic Information Gathering<a class="headerlink" href="#basic-information-gathering" title="Permanent link">&para;</a></h3>
<p>In this section, we will learn about some approaches and tools for collecting basic information about a given application using static analysis.</p>
<h4 id="application-binary">Application Binary<a class="headerlink" href="#application-binary" title="Permanent link">&para;</a></h4>
<p>You can use <a href="../0x08-Testing-Tools/#class-dump">class-dump</a> to get information about methods in the application's source code. The example below uses the <a href="https://damnvulnerableiosapp.com/" title="Damn Vulnerable iOS App">Damn Vulnerable iOS App</a> to demonstrate this. Our binary is a so-called fat binary, which means that it can be executed on 32- and 64-bit platforms:</p>
<div class="highlight"><pre><span></span><code>$ unzip DamnVulnerableiOSApp.ipa

$ <span class="nb">cd</span> Payload/DamnVulnerableIOSApp.app

$ otool -hv DamnVulnerableIOSApp

DamnVulnerableIOSApp <span class="o">(</span>architecture armv7<span class="o">)</span>:
Mach header
     magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
  MH_MAGIC     ARM         V7  0x00     EXECUTE    <span class="m">38</span>       <span class="m">4292</span>   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE

DamnVulnerableIOSApp <span class="o">(</span>architecture arm64<span class="o">)</span>:
Mach header
     magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64   ARM64        ALL  0x00     EXECUTE    <span class="m">38</span>       <span class="m">4856</span>   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE
</code></pre></div>
<p>Note the architectures: <code>armv7</code> (which is 32-bit) and <code>arm64</code>. This design of a fat binary allows an application to be deployed on all devices.
To analyze the application with class-dump, we must create a so-called thin binary, which contains one architecture only:</p>
<div class="highlight"><pre><span></span><code>iOS8-jailbreak:~ root# lipo -thin armv7 DamnVulnerableIOSApp -output DVIA32
</code></pre></div>
<p>And then we can proceed to performing class-dump:</p>
<div class="highlight"><pre><span></span><code>iOS8-jailbreak:~ root# class-dump DVIA32

@interface FlurryUtil : ./DVIA/DVIA/DamnVulnerableIOSApp/DamnVulnerableIOSApp/YapDatabase/Extensions/Views/Internal/
<span class="o">{</span>
<span class="o">}</span>
+ <span class="o">(</span>BOOL<span class="o">)</span>appIsCracked<span class="p">;</span>
+ <span class="o">(</span>BOOL<span class="o">)</span>deviceIsJailbroken<span class="p">;</span>
</code></pre></div>
<p>Note the plus sign, which means that this is a class method that returns a BOOL type.
A minus sign would mean that this is an instance method. Refer to later sections to understand the practical difference between these.</p>
<p>Alternatively, you can easily decompile the application with <a href="https://www.hopperapp.com/" title="Hopper Disassembler">Hopper Disassembler</a>. All these steps would be executed automatically, and you'd be able to see the disassembled binary and class information.</p>
<p>The following command is listing shared libraries:</p>
<div class="highlight"><pre><span></span><code>$ otool -L &lt;binary&gt;
</code></pre></div>
<h4 id="retrieving-strings">Retrieving Strings<a class="headerlink" href="#retrieving-strings" title="Permanent link">&para;</a></h4>
<p>Strings are always a good starting point while analyzing a binary, as they provide context to the associated code. For instance, an error log string such as "Cryptogram generation failed" gives us a hint that the adjoining code might be responsible for the generation of a cryptogram.</p>
<p>In order to extract strings from an iOS binary, you can use GUI tools such as Ghidra or Cutter or rely on CLI-based tools such as the <em>strings</em> Unix utility (<code>strings &lt;path_to_binary&gt;</code>) or radare2's rabin2 (<code>rabin2 -zz &lt;path_to_binary&gt;</code>). When using the CLI-based ones you can take advantage of other tools such as grep (e.g. in conjunction with regular expressions) to further filter and analyze the results.</p>
<h4 id="cross-references">Cross References<a class="headerlink" href="#cross-references" title="Permanent link">&para;</a></h4>
<p>Ghidra can be used for analyzing the iOS binaries and obtaining cross references by right clicking the desired function and selecting <strong>Show References to</strong>.</p>
<h4 id="api-usage">API Usage<a class="headerlink" href="#api-usage" title="Permanent link">&para;</a></h4>
<p>The iOS platform provides many built-in libraries for frequently used functionalities in applications, for example cryptography, Bluetooth, NFC, network and location libraries. Determining the presence of these libraries in an application can give us valuable information about its underlying working.</p>
<p>For instance, if an application is importing the <code>CC_SHA256</code> function, it indicates that the application will be performing some kind of hashing operation using the SHA256 algorithm. Further information on how to analyze iOS's cryptographic APIs is discussed in the section "<a href="../0x06e-Testing-Cryptography/" title="iOS Cryptographic APIs">iOS Cryptographic APIs</a>".</p>
<p>Similarly, the above approach can be used to determine where and how an application is using Bluetooth. For instance, an application performing communication using the Bluetooth channel must use functions from the Core Bluetooth framework such as <code>CBCentralManager</code> or <code>connect</code>. Using the <a href="https://developer.apple.com/documentation/corebluetooth" title="iOS Bluetooth documentation">iOS Bluetooth documentation</a> you can determine the critical functions and start analysis around those function imports.</p>
<h4 id="network-communication">Network Communication<a class="headerlink" href="#network-communication" title="Permanent link">&para;</a></h4>
<p>Most of the apps you might encounter connect to remote endpoints. Even before you perform any dynamic analysis (e.g. traffic capture and analysis), you can obtain some initial inputs or entry points by enumerating the domains to which the application is supposed to communicate to.</p>
<p>Typically these domains will be present as strings within the binary of the application. One can extract domains by retrieving strings (as discussed above) or checking the strings using tools like Ghidra. The latter option has a clear advantage: it can provide you with context, as you'll be able to see in which context each domain is being used by checking the cross-references.</p>
<p>From here on you can use this information to derive more insights which might be of use later during your analysis, e.g. you could match the domains to the pinned certificates or perform further reconnaissance on domain names to know more about the target environment.</p>
<p>The implementation and verification of secure connections can be an intricate process and there are numerous aspects to consider. For instance, many applications use other protocols apart from HTTP such as XMPP or plain TCP packets, or perform certificate pinning in an attempt to deter MITM attacks.</p>
<p>Remember that in most cases, only using static analysis will not be enough and might even turn to be extremely inefficient when compared to the dynamic alternatives which will get much more reliable results (e.g. using an interceptor proxy). In this section we've just slightly touched the surface, so please refer to the section "<a href="../0x06b-Basic-Security-Testing/#basic-network-monitoringsniffing" title="Basic Network Monitoring/Sniffing">Basic Network Monitoring/Sniffing</a>" in the "iOS Basic Security Testing" chapter and check out the test cases in the chapter "<a href="../0x06g-Testing-Network-Communication/" title="iOS Network APIs">iOS Network APIs</a>" for further information.</p>
<h3 id="manual-reversed-code-review">Manual (Reversed) Code Review<a class="headerlink" href="#manual-reversed-code-review" title="Permanent link">&para;</a></h3>
<h4 id="reviewing-disassembled-objective-c-and-swift-code">Reviewing Disassembled Objective-C and Swift Code<a class="headerlink" href="#reviewing-disassembled-objective-c-and-swift-code" title="Permanent link">&para;</a></h4>
<p>In this section we will be exploring iOS application's binary code manually and perform static analysis on it. Manual analysis can be a slow process and requires immense patience. A good manual analysis can make the dynamic analysis more successful.</p>
<p>There are no hard written rules for performing static analysis, but there are few rules of thumb which can be used to have a systematic approach to manual analysis:</p>
<ul>
<li>Understand the working of the application under evaluation - the objective of the application and how it behaves in case of wrong input.</li>
<li>Explore the various strings present in the application binary, this can be very helpful, for example in spotting interesting functionalities and possible error handling logic in the application.</li>
<li>Look for functions and classes having names relevant to our objective.</li>
<li>Lastly, find the various entry points into the application and follow along from there to explore the application.</li>
</ul>
<blockquote>
<p>Techniques discussed in this section are generic and applicable irrespective of the tools used for analysis.</p>
</blockquote>
<h5 id="objective-c">Objective-C<a class="headerlink" href="#objective-c" title="Permanent link">&para;</a></h5>
<p>In addition to the techniques learned in the "<a href="#disassembling-and-decompiling" title="Disassembling and Decompiling">Disassembling and Decompiling</a>" section, for this section you'll need some understanding of the <a href="https://developer.apple.com/documentation/objectivec/objective-c_runtime" title="Objective-C runtime">Objective-C runtime</a>. For instance, functions like <code>_objc_msgSend</code> or <code>_objc_release</code> are specially meaningful for the Objective-C runtime.</p>
<p>We will be using the <a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/iOS/Level_01/UnCrackable_Level1.ipa" title="UnCrackable Level 1 iOS App">UnCrackable Level 1 crackme app</a>, which has the simple goal of finding a <em>secret string</em> hidden somewhere in the binary. The application has a single home screen and a user can interact via inputting custom strings in the provided text field.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_app_home_screen2.png" width="400px" /></p>
<p>When the user inputs the wrong string, the application shows a pop-up with the "Verification Failed" message.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_app_wrong_input.png" width="400px" /></p>
<p>You can keep note of the strings displayed in the pop-up, as this might be helpful when searching for the code where the input is processed and a decision is being made. Luckily, the complexity and interaction with this application is straightforward, which bodes well for our reversing endeavors.</p>
<blockquote>
<p>For static analysis in this section, we will be using Ghidra 9.0.4. Ghidra 9.1_beta auto-analysis has a bug and does not show the Objective-C classes.</p>
</blockquote>
<p>We can start by checking the strings present in the binary by opening it in Ghidra. The listed strings might be overwhelming at first, but with some experience in reversing Objective-C code, you'll learn how to <em>filter</em> and discard the strings that are not really helpful or relevant. For instance, the ones shown in screenshot below, which are generated for the Objective-C runtime. Other strings might be helpful in some cases, such as those containing symbols (function names, class names, etc.) and we'll be using them when performing static analysis to check if some specific function is being used.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_objc_runtime_strings.png" width="100%" /></p>
<p>If we continue our careful analysis, we can spot the string, "Verification Failed", which is used for the pop-up when a wrong input is given. If you follow the cross-references (Xrefs) of this string, you will reach <code>buttonClick</code> function of the <code>ViewController</code> class. We will look into the <code>buttonClick</code> function later in this section. When further checking the other strings in the application, only a few of them look a likely candidate for a <em>hidden flag</em>. You can try them and verify as well.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_strings.png" width="100%" /></p>
<p>Moving forward, we have two paths to take. Either we can start analyzing the <code>buttonClick</code> function identified in the above step, or start analyzing the application from the various entry points. In real world situation, most times you will be taking the first path, but from a learning perspective, in this section we will take the latter path.</p>
<p>An iOS application calls different predefined functions provided by the iOS runtime depending on its the state within the <a href="https://developer.apple.com/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle" title="Managing Your App\'s Life Cycle">application life cycle</a>. These functions are known as the entry points of the app. For example:</p>
<ul>
<li><code>[AppDelegate application:didFinishLaunchingWithOptions:]</code> is called when the application is started for the first time.</li>
<li><code>[AppDelegate applicationDidBecomeActive:]</code> is called when the application is moving from inactive to active state.</li>
</ul>
<p>Many applications execute critical code in these sections and therefore they're normally a good starting point in order to follow the code systematically.</p>
<p>Once we're done with the analysis of all the functions in the <code>AppDelegate</code> class, we can conclude that there is no relevant code present. The lack of any code in the above functions raises the question - from where is the application's initialization code being called?</p>
<p>Luckily the current application has a small code base, and we can find another <code>ViewController</code> class in the <strong>Symbol Tree</strong> view. In this class, function <code>viewDidLoad</code> function looks interesting. If you check the documentation of <a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621495-viewdidload" title="viewDidLoad()"><code>viewDidLoad</code></a>, you can see that it can also be used to perform additional initialization on views.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_viewdidload_decompile.png" width="600px" /></p>
<p>If we check the decompilation of this function, there are a few interesting things going on. For instance, there is a call to a native function at line 31 and a label is initialized with a <code>setHidden</code> flag set to 1 in lines 27-29. You can keep a note of these observations and continue exploring the other functions in this class. For brevity, exploring the other parts of the function is left as an exercise for the readers.</p>
<p>In our first step, we observed that the application verifies the input string only when the UI button is pressed. Thus, analyzing the <code>buttonClick</code> function is an obvious target. As earlier mentioned, this function also contains the string we see in the pop-ups. At line 29 a decision is being made, which is based on the result of <code>isEqualString</code> (output saved in <code>uVar1</code> at line 23). The input for the comparison is coming from the text input field (from the user) and the value of the <code>label</code>. Therefore, we can assume that the hidden flag is stored in that label.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_buttonclick_decompiled.png" width="600px" /></p>
<p>Now we have followed the complete flow and have all the information about the application flow. We also concluded that the hidden flag is present in a text label and in order to determine the value of the label, we need to revisit <code>viewDidLoad</code> function, and understand what is happening in the native function identified. Analysis of the native function is discussed in "<a href="#reviewing-disassembled-native-code" title="Reviewing Disassembled Native Code">Reviewing Disassembled Native Code</a>".</p>
<h4 id="reviewing-disassembled-native-code">Reviewing Disassembled Native Code<a class="headerlink" href="#reviewing-disassembled-native-code" title="Permanent link">&para;</a></h4>
<p>Analyzing disassembled native code requires a good understanding of the calling conventions and instructions used by the underlying platform. In this section we are looking in ARM64 disassembly of the native code. A good starting point to learn about ARM architecture is available at <a href="https://azeria-labs.com/writing-arm-assembly-part-1/" title="Introduction to ARM Assembly Basics">Introduction to ARM Assembly Basics</a> by Azeria Labs Tutorials. This is a quick summary of the things that we will be using in this section:</p>
<ul>
<li>In ARM64, a register is of 64 bit in size and referred to as Xn, where n is a number from 0 to 31. If the lower (LSB) 32 bits of the register are used then it's referred to as Wn.</li>
<li>The input parameters to a function are passed in the X0-X7 registers.</li>
<li>The return value of the function is passed via the X0 register.</li>
<li>Load (LDR) and store (STR) instructions are used to read or write to memory from/to a register.</li>
<li>B, BL, BLX are branch instructions used for calling a function.</li>
</ul>
<p>As mentioned above as well, Objective-C code is also compiled to native binary code, but analyzing C/C++ native can be more challenging. In case of Objective-C there are various symbols (especially function names) present, which eases the understanding of the code. In the above section we've learned that the presence of function names like <code>setText</code>, <code>isEqualStrings</code> can help us in quickly understanding the semantics of the code. In case of C/C++ native code, if all the binaries are stripped, there can be very few or no symbols present to assist us into analyzing it.</p>
<p>Decompilers can help us in analyzing native code, but they should be used with caution. Modern decompilers are very sophisticated and among many techniques used by them to decompile code, a few of them are heuristics based. Heuristics based techniques might not always give correct results, one such case being, determining the number of input parameters for a given native function. Having knowledge of analyzing disassembled code, assisted with decompilers can make analyzing native code less error prone.</p>
<p>We will be analyzing the native function identified in <code>viewDidLoad</code> function in the previous section. The function is located at offset 0x1000080d4. The return value of this function used in the <code>setText</code> function call for the label. This text is used to compare against the user input. Thus, we can be sure that this function will be returning a string or equivalent.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_native_disassembly.png" width="100%" /></p>
<p>The first thing we can see in the disassembly of the function is that there is no input to the function. The registers X0-X7 are not read throughout the function. Also, there are multiple calls to other functions like the ones at 0x100008158, 0x10000dbf0 etc.</p>
<p>The instructions corresponding to one such function calls can be seen below. The branch instruction <code>bl</code> is used to call the function at 0x100008158.</p>
<div class="highlight"><pre><span></span><code>1000080f0 1a 00 00 94     bl         FUN_100008158
1000080f4 60 02 00 39     strb       w0,[x19]=&gt;DAT_10000dbf0
</code></pre></div>
<p>The return value from the function (found in W0), is stored to the address in register X19 (<code>strb</code> stores a byte to the address in register). We can see the same pattern for other function calls, the returned value is stored in X19 register and each time the offset is one more than the previous function call. This behavior can be associated with populating each index of a string array at a time. Each return value is been written to an index of this string array. There are 11 such calls, and from the current evidence we can make an intelligent guess that length of the hidden flag is 11. Towards the end of the disassembly, the function returns with the address to this string array.</p>
<div class="highlight"><pre><span></span><code>100008148 e0 03 13 aa     mov        x0=&gt;DAT_10000dbf0,x19
</code></pre></div>
<p>To determine the value of the hidden flag we need to know the return value of each of the subsequent function calls identified above. When analyzing the function 0x100006fb4, we can observe that this function is much bigger and more complex than the previous one we analyzed. Function graphs can be very helpful when analyzing complex functions, as it helps into better understanding the control flow of the function. Function graphs can be obtained in Ghidra by clicking the <strong>Display function graph</strong> icon in the sub-menu.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_function_graph.png" width="100%" /></p>
<p>Manually analyzing all the native functions completely will be time consuming and might not be the wisest approach. In such a scenario using a dynamic analysis approach is highly recommended. For instance, by using the techniques like hooking or simply debugging the application, we can easily determine the returned values. Normally it's a good idea to use a dynamic analysis approach and then fallback to manually analyzing the functions in a feedback loop. This way you can benefit from both approaches at the same time while saving time and reducing effort. Dynamic analysis techniques are discussed in "<a href="#dynamic-analysis" title="Dynamic Analysis">Dynamic Analysis</a>" section.</p>
<h3 id="automated-static-analysis">Automated Static Analysis<a class="headerlink" href="#automated-static-analysis" title="Permanent link">&para;</a></h3>
<p>Several automated tools for analyzing iOS apps are available; most of them are commercial tools. The free and open source tools <a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF" title="Mobile Security Framework (MobSF)">MobSF</a> and <a href="https://github.com/sensepost/objection" title="objection">objection</a> have some static and dynamic analysis functionality. Additional tools are listed in the "Static Source Code Analysis" section of the "Testing Tools" appendix.</p>
<p>Don't shy away from using automated scanners for your analysis - they help you pick low-hanging fruit and allow you to focus on the more interesting aspects of analysis, such as the business logic. Keep in mind that static analyzers may produce false positives and false negatives; always review the findings carefully.</p>
<h2 id="dynamic-analysis">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis" title="Permanent link">&para;</a></h2>
<p>Life is easy with a jailbroken device: not only do you gain easy privileged access to the device, the lack of code signing allows you to use more powerful dynamic analysis techniques. On iOS, most dynamic analysis tools are based on Cydia Substrate, a framework for developing runtime patches, or Frida, a dynamic introspection tool. For basic API monitoring, you can get away with not knowing all the details of how Substrate or Frida work - you can simply use existing API monitoring tools.</p>
<h3 id="dynamic-analysis-on-non-jailbroken-devices">Dynamic Analysis on Non-Jailbroken Devices<a class="headerlink" href="#dynamic-analysis-on-non-jailbroken-devices" title="Permanent link">&para;</a></h3>
<h4 id="automated-repackaging-with-objection">Automated Repackaging with Objection<a class="headerlink" href="#automated-repackaging-with-objection" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/sensepost/objection" title="Objection">Objection</a> is a mobile runtime exploration toolkit based on Frida. One of the biggest advantages about Objection is that it enables testing with non-jailbroken devices. It does this by automating the process of app repackaging with the <code>FridaGadget.dylib</code> library. A detailed explanation of the repackaging and resigning process can be found in the next chapter "Manual Repackaging".
We won't cover Objection in detail in this guide, as you can find exhaustive documentation on the official <a href="https://github.com/sensepost/objection/wiki" title="Objection - Documentation">wiki pages</a>.</p>
<h4 id="manual-repackaging">Manual Repackaging<a class="headerlink" href="#manual-repackaging" title="Permanent link">&para;</a></h4>
<p>If you don't have access to a jailbroken device, you can patch and repackage the target app to load a dynamic library at startup. This way, you can instrument the app and do pretty much everything you need to do for a dynamic analysis (of course, you can't break out of the sandbox this way, but you won't often need to). However, this technique works only if the app binary isn't FairPlay-encrypted (i.e., obtained from the App Store).</p>
<p>Thanks to Apple's confusing provisioning and code-signing system, re-signing an app is more challenging than you would expect. iOS won't run an app unless you get the provisioning profile and code signature header exactly right. This requires learning many concepts-certificate types, Bundle IDs, application IDs, team identifiers, and how Apple's build tools connect them. Getting the OS to run a binary that hasn't been built via the default method (Xcode) can be a daunting process.</p>
<p>We'll use <a href="../0x08-Testing-Tools/#optool">optool</a>, Apple's build tools, and some shell commands. Our method is inspired by <a href="https://github.com/vtky/Swizzler2/" title="Swizzler">Vincent Tan's Swizzler project</a>. <a href="https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/" title="NCC blog - iOS instrumentation without jailbreak">The NCC group</a> has described an alternative repackaging method.</p>
<p>To reproduce the steps listed below, download <a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes/iOS/Level_01" title="Crackmes - iOS Level 1">UnCrackable iOS App Level 1</a> from the OWASP Mobile Testing Guide repository. Our goal is to make the UnCrackable app load <code>FridaGadget.dylib</code> during startup so we can instrument the app with Frida.</p>
<blockquote>
<p>Please note that the following steps apply to macOS only, as Xcode is only available for macOS.</p>
</blockquote>
<h4 id="getting-a-developer-provisioning-profile-and-certificate">Getting a Developer Provisioning Profile and Certificate<a class="headerlink" href="#getting-a-developer-provisioning-profile-and-certificate" title="Permanent link">&para;</a></h4>
<p>The <em>provisioning profile</em> is a plist file signed by Apple, which adds your code-signing certificate to its list of accepted certificates on one or more devices. In other words, this represents Apple explicitly allowing your app to run for certain reasons, such as debugging on selected devices (development profile). The provisioning profile also includes the <em>entitlements</em> granted to your app. The <em>certificate</em> contains the private key you'll use to sign.</p>
<p>Depending on whether you're registered as an iOS developer, you can obtain a certificate and provisioning profile in one of the following ways:</p>
<p><strong>With an iOS developer account:</strong></p>
<p>If you've developed and deployed iOS apps with Xcode before, you already have your own code-signing certificate installed. Use the <em>security</em> tool to list your signing identities:</p>
<div class="highlight"><pre><span></span><code>$ security find-identity -v
 <span class="m">1</span><span class="o">)</span> 61FA3547E0AF42A11E233F6A2B255E6B6AF262CE <span class="s2">&quot;iPhone Distribution: Company Name Ltd.&quot;</span>
 <span class="m">2</span><span class="o">)</span> 8004380F331DCA22CC1B47FB1A805890AE41C938 <span class="s2">&quot;iPhone Developer: Bernhard Müller (RV852WND79)&quot;</span>
</code></pre></div>
<p>Log into the Apple Developer portal to issue a new App ID, then issue and download the profile. An App ID is a two-part string: a Team ID supplied by Apple and a bundle ID search string that you can set to an arbitrary value, such as <code>com.example.myapp</code>. Note that you can use a single App ID to re-sign multiple apps. Make sure you create a <em>development</em> profile and not a <em>distribution</em> profile so that you can debug the app.</p>
<p>In the examples below, I use my signing identity, which is associated with my company's development team. I created the App ID "sg.vp.repackaged" and the provisioning profile "AwesomeRepackaging" for these examples. I ended up with the file <code>AwesomeRepackaging.mobileprovision</code>-replace this with your own filename in the shell commands below.</p>
<p><strong>With a Regular Apple ID:</strong></p>
<p>Apple will issue a free development provisioning profile even if you're not a paying developer. You can obtain the profile via Xcode and your regular Apple account: simply create an empty iOS project and extract <code>embedded.mobileprovision</code> from the app container, which is in the Xcode subdirectory of your home directory: <code>~/Library/Developer/Xcode/DerivedData/&lt;ProjectName&gt;/Build/Products/Debug-iphoneos/&lt;ProjectName&gt;.app/</code>. The <a href="https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/" title="iOS instrumentation without jailbreak">NCC blog post "iOS instrumentation without jailbreak"</a> explains this process in great detail.</p>
<p>Once you've obtained the provisioning profile, you can check its contents with the <em>security</em> tool. You'll find the entitlements granted to the app in the profile, along with the allowed certificates and devices. You'll need these for code-signing, so extract them to a separate plist file as shown below. Have a look at the file contents to make sure everything is as expected.</p>
<div class="highlight"><pre><span></span><code>$ security cms -D -i AwesomeRepackaging.mobileprovision &gt; profile.plist
$ /usr/libexec/PlistBuddy -x -c <span class="s1">&#39;Print :Entitlements&#39;</span> profile.plist &gt; entitlements.plist
$ cat entitlements.plist
&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span>?&gt;
&lt;!DOCTYPE plist PUBLIC <span class="s2">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="s2">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;
&lt;plist <span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span>&gt;
&lt;dict&gt;
 &lt;key&gt;application-identifier&lt;/key&gt;
 &lt;string&gt;LRUD9L355Y.sg.vantagepoint.repackage&lt;/string&gt;
 &lt;key&gt;com.apple.developer.team-identifier&lt;/key&gt;
 &lt;string&gt;LRUD9L355Y&lt;/string&gt;
 &lt;key&gt;get-task-allow&lt;/key&gt;
 &lt;true/&gt;
 &lt;key&gt;keychain-access-groups&lt;/key&gt;
 &lt;array&gt;
   &lt;string&gt;LRUD9L355Y.*&lt;/string&gt;
 &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre></div>
<p>Note the application identifier, which is a combination of the Team ID (LRUD9L355Y) and Bundle ID (sg.vantagepoint.repackage). This provisioning profile is only valid for the app that has this App ID. The <code>get-task-allow</code> key is also important: when set to <code>true</code>, other processes, such as the debugging server, are allowed to attach to the app (consequently, this would be set to <code>false</code> in a distribution profile).</p>
<h3 id="basic-information-gathering_1">Basic Information Gathering<a class="headerlink" href="#basic-information-gathering_1" title="Permanent link">&para;</a></h3>
<p>On iOS, collecting basic information about a running process or an application can be slightly more challenging than compared to Android. On Android (or any Linux-based OS), process information is exposed as readable text files via <em>procfs</em>. Thus, any information about a target process can be obtained on a rooted device by parsing these text files. In contrast, on iOS there is no procfs equivalent present. Also, on iOS many standard UNIX command line tools for exploring process information, for instance lsof and vmmap, are removed to reduce the firmware size.</p>
<p>In this section, we will learn how to collect process information on iOS using command line tools like lsof. Since many of these tools are not present on iOS by default, we need to install them via alternative methods. For instance, lsof can be installed using <a href="../0x08-Testing-Tools/#cydia">Cydia</a> (the executable is not the latest version available, but nevertheless addresses our purpose).</p>
<h4 id="open-files">Open Files<a class="headerlink" href="#open-files" title="Permanent link">&para;</a></h4>
<p><code>lsof</code> is a powerful command, and provides a plethora of information about a running process. It can provide a list of all open files, including a stream, a network file or a regular file. When invoking the <code>lsof</code> command without any option it will list all open files belonging to all active processes on the system, while when invoking with the flags <code>-c &lt;process name&gt;</code> or <code>-p &lt;pid&gt;</code>, it returns the list of open files for the specified process. The <a href="http://man7.org/linux/man-pages/man8/lsof.8.html" title="Man Page of lsof">man page</a> shows various other options in detail.</p>
<p>Using <code>lsof</code> for an iOS application running with PID 2828, list various open files as shown below.</p>
<div class="highlight"><pre><span></span><code>iPhone:~ root# lsof -p <span class="m">2828</span>
COMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME
iOweApp <span class="m">2828</span> mobile  cwd    DIR    <span class="m">1</span>,2      <span class="m">864</span>      <span class="m">2</span> /
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,3   <span class="m">206144</span> <span class="m">189774</span> /private/var/containers/Bundle/Application/F390A491-3524-40EA-B3F8-6C1FA105A23A/iOweApp.app/iOweApp
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,3     <span class="m">5492</span> <span class="m">213230</span> /private/var/mobile/Containers/Data/Application/5AB3E437-9E2D-4F04-BD2B-972F6055699E/tmp/com.apple.dyld/iOweApp-6346DC276FE6865055F1194368EC73CC72E4C5224537F7F23DF19314CF6FD8AA.closure
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,3    <span class="m">30628</span> <span class="m">212198</span> /private/var/preferences/Logging/.plist-cache.vqXhr1EE
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,2    <span class="m">50080</span> <span class="m">234433</span> /usr/lib/libobjc-trampolines.dylib
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,2   <span class="m">344204</span>  <span class="m">74185</span> /System/Library/Fonts/AppFonts/ChalkboardSE.ttc
iOweApp <span class="m">2828</span> mobile  txt    REG    <span class="m">1</span>,2   <span class="m">664848</span> <span class="m">234595</span> /usr/lib/dyld
...
</code></pre></div>
<h4 id="loaded-native-libraries">Loaded Native Libraries<a class="headerlink" href="#loaded-native-libraries" title="Permanent link">&para;</a></h4>
<p>You can use the <code>list_frameworks</code> command in <a href="../0x08-Testing-Tools/#objection">objection</a> to list all the application's bundles that represent Frameworks.</p>
<div class="highlight"><pre><span></span><code>...itudehacks.DVIAswiftv2.develop on <span class="o">(</span>iPhone: <span class="m">13</span>.2.3<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ios bundles list_frameworks</span>
Executable      Bundle                                     Version    Path
--------------  -----------------------------------------  ---------  -------------------------------------------
Bolts           org.cocoapods.Bolts                        <span class="m">1</span>.9.0      ...8/DVIA-v2.app/Frameworks/Bolts.framework
RealmSwift      org.cocoapods.RealmSwift                   <span class="m">4</span>.1.1      ...A-v2.app/Frameworks/RealmSwift.framework
                                                                      ...ystem/Library/Frameworks/IOKit.framework
...

<span class="c1">#### Open Connections</span>

<span class="sb">`</span>lsof<span class="sb">`</span> <span class="nb">command</span> when invoked with option <span class="sb">`</span>-i<span class="sb">`</span>, it gives the list of open network ports <span class="k">for</span> all active processes on the device. To get a list of open network ports <span class="k">for</span> a specific process, the <span class="sb">`</span>lsof -i -a -p &lt;pid&gt;<span class="sb">`</span> <span class="nb">command</span> can be used, where <span class="sb">`</span>-a<span class="sb">`</span> <span class="o">(</span>AND<span class="o">)</span> option is used <span class="k">for</span> filtering. Below a filtered output <span class="k">for</span> PID <span class="m">1</span> is shown.

<span class="sb">```</span>bash
iPhone:~ root# lsof -i -a -p <span class="m">1</span>
COMMAND PID USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
launchd   <span class="m">1</span> root   27u  IPv6 0x69c2ce210efdc023      0t0  TCP *:ssh <span class="o">(</span>LISTEN<span class="o">)</span>
launchd   <span class="m">1</span> root   28u  IPv6 0x69c2ce210efdc023      0t0  TCP *:ssh <span class="o">(</span>LISTEN<span class="o">)</span>
launchd   <span class="m">1</span> root   29u  IPv4 0x69c2ce210eeaef53      0t0  TCP *:ssh <span class="o">(</span>LISTEN<span class="o">)</span>
launchd   <span class="m">1</span> root   30u  IPv4 0x69c2ce210eeaef53      0t0  TCP *:ssh <span class="o">(</span>LISTEN<span class="o">)</span>
launchd   <span class="m">1</span> root   31u  IPv4 0x69c2ce211253b90b      0t0  TCP <span class="m">192</span>.168.1.12:ssh-&gt;192.168.1.8:62684 <span class="o">(</span>ESTABLISHED<span class="o">)</span>
launchd   <span class="m">1</span> root   42u  IPv4 0x69c2ce211253b90b      0t0  TCP <span class="m">192</span>.168.1.12:ssh-&gt;192.168.1.8:62684 <span class="o">(</span>ESTABLISHED<span class="o">)</span>
</code></pre></div>
<h4 id="sandbox-inspection">Sandbox Inspection<a class="headerlink" href="#sandbox-inspection" title="Permanent link">&para;</a></h4>
<p>On iOS, each application gets a sandboxed folder to store its data. As per the iOS security model, an application's sandboxed folder cannot be accessed by another application. Additionally, the users do not have direct access to the iOS filesystem, thus preventing browsing or extraction of data from the filesystem. In iOS &lt; 8.3 there were applications available which can be used to browse the device's filesystem, such as iExplorer and iFunBox, but in the recent version of iOS (&gt;8.3) the sandboxing rules are more stringent and these applications do not work anymore. As a result, if you need to access the filesystem it can only be accessed on a jailbroken device. As part of the jailbreaking process, the application sandbox protection is disabled and thus enabling an easy access to sandboxed folders.</p>
<p>The contents of an application's sandboxed folder has already been discussed in "<a href="../0x06b-Basic-Security-Testing/#accessing-app-data-directories">Accessing App Data Directories</a>" in the chapter iOS Basic Security Testing. This chapter gives an overview of the folder structure and which directories you should analyze.</p>
<h3 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h3>
<p>Coming from a Linux background you'd expect the <code>ptrace</code> system call to be as powerful as you're used to but, for some reason, Apple decided to leave it incomplete. iOS debuggers such as LLDB use it for attaching, stepping or continuing the process but they cannot use it to read or write memory (all <code>PT_READ_*</code> and <code>PT_WRITE*</code> requests are missing). Instead, they have to obtain a so-called Mach task port (by calling <code>task_for_pid</code> with the target process ID) and then use the Mach IPC interface API functions to perform actions such as suspending the target process and reading/writing register states (<code>thread_get_state</code>/<code>thread_set_state</code>) and virtual memory (<code>mach_vm_read</code>/<code>mach_vm_write</code>).</p>
<blockquote>
<p>For more information you can refer to the LLVM project in GitHub which contains the <a href="https://github.com/llvm/llvm-project/tree/main/lldb" title="LLDB">source code for LLDB</a> as well as Chapter 5 and 13 from "Mac OS X and iOS Internals: To the Apple's Core" [#levin] and Chapter 4 "Tracing and Debugging" from "The Mac Hacker's Handbook" [#miller].</p>
</blockquote>
<h4 id="debugging-with-lldb">Debugging with LLDB<a class="headerlink" href="#debugging-with-lldb" title="Permanent link">&para;</a></h4>
<p>The default debugserver executable that Xcode installs can't be used to attach to arbitrary processes (it is usually used only for debugging self-developed apps deployed with Xcode). To enable debugging of third-party apps, the <code>task_for_pid-allow</code> entitlement must be added to the debugserver executable so that the debugger process can call <code>task_for_pid</code> to obtain the target Mach task port as seen before. An easy way to do this is to add the entitlement to the <a href="http://iphonedevwiki.net/index.php/Debugserver" title="Debug Server on the iPhone Dev Wiki">debugserver binary shipped with Xcode</a>.</p>
<p>To obtain the executable, mount the following DMG image:</p>
<div class="highlight"><pre><span></span><code>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/&lt;target-iOS-version&gt;/DeveloperDiskImage.dmg
</code></pre></div>
<p>You'll find the debugserver executable in the <code>/usr/bin/</code> directory on the mounted volume. Copy it to a temporary directory, then create a file called <code>entitlements.plist</code> with the following content:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/ PropertyList-1.0.dtd&quot;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>com.apple.springboard.debugapplications<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;key&gt;</span>run-unsigned-code<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;key&gt;</span>get-task-allow<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;key&gt;</span>task_for_pid-allow<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;true/&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</code></pre></div>
<p>Apply the entitlement with codesign:</p>
<div class="highlight"><pre><span></span><code>$ codesign -s - --entitlements entitlements.plist -f debugserver
</code></pre></div>
<p>Copy the modified binary to any directory on the test device. The following examples use usbmuxd to forward a local port through USB.</p>
<div class="highlight"><pre><span></span><code>$ iproxy <span class="m">2222</span> <span class="m">22</span>
$ scp -P <span class="m">2222</span> debugserver root@localhost:/tmp/
</code></pre></div>
<p>Note: On iOS 12 and higher, use the following procedure to sign the debugserver binary obtained from the XCode image.</p>
<p>1) Copy the debugserver binary to the device via scp, for example, in the /tmp folder.</p>
<p>2) Connect to the device via SSH and create the file, named entitlements.xml, with the following content:</p>
<pre><code>```xml
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;platform-application&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.private.security.no-container&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.private.skip-library-validation&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.backboardd.debugapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.backboardd.launchapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.diagnosticd.diagnostic&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.frontboard.debugapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.frontboard.launchapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.security.network.client&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.security.network.server&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;com.apple.system-task-ports&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;get-task-allow&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;run-unsigned-code&lt;/key&gt;
    &lt;true/&gt;
    &lt;key&gt;task_for_pid-allow&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
```
</code></pre>
<p>3) Type the following command to sign the debugserver binary:</p>
<pre><code>```bash
$ ldid -Sentitlements.xml debugserver
```
</code></pre>
<p>4) Verify that the debugserver binary can be executed via the following command:</p>
<pre><code>```bash
$ ./debugserver
```
</code></pre>
<p>You can now attach debugserver to any process running on the device.</p>
<div class="highlight"><pre><span></span><code>VP-iPhone-18:/tmp root# ./debugserver *:1234 -a <span class="m">2670</span>
debugserver-@<span class="o">(</span><span class="c1">#)PROGRAM:debugserver  PROJECT:debugserver-320.2.89</span>
<span class="k">for</span> armv7.
Attaching to process <span class="m">2670</span>...
</code></pre></div>
<p>With the following command you can launch an application via debugserver running on the target device:</p>
<div class="highlight"><pre><span></span><code>debugserver -x backboard *:1234 /Applications/MobileSMS.app/MobileSMS
</code></pre></div>
<p>Attach to an already running application:</p>
<div class="highlight"><pre><span></span><code>debugserver *:1234 -a <span class="s2">&quot;MobileSMS&quot;</span>
</code></pre></div>
<p>You may connect now to the iOS device from your host computer:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>lldb<span class="o">)</span> process connect connect://&lt;ip-of-ios-device&gt;:1234
</code></pre></div>
<p>Typing <code>image list</code> gives a list of main executable and all dependent libraries.</p>
<h4 id="debugging-release-apps">Debugging Release Apps<a class="headerlink" href="#debugging-release-apps" title="Permanent link">&para;</a></h4>
<p>In the previous section we learned about how to setup a debugging environment on an iOS device using LLDB. In this section we will use this information and learn how to debug a 3rd party release application. We will continue using the <a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/iOS/Level_01/UnCrackable_Level1.ipa" title="UnCrackable Level 1 iOS App">UnCrackable Level 1 crackme app</a> and solve it using a debugger.</p>
<p>In contrast to a debug build, the code compiled for a release build is optimized to achieve maximum performance and minimum binary build size. As a general best practice, most of the debug symbols are stripped for a release build, adding a layer of complexity when reverse engineering and debugging the binaries.</p>
<p>Due to the absence of the debug symbols, symbol names are missing from the backtrace outputs and setting breakpoints by simply using function names is not possible. Fortunately, debuggers also support setting breakpoints directly on memory addresses. Further in this section we will learn how to do so and eventually solve the crackme challenge.</p>
<p>Some groundwork is needed before setting a breakpoint using memory addresses. It requires determining two offsets:</p>
<ol>
<li>Breakpoint offset: The <em>address offset</em> of the code where we want to set a breakpoint. This address is obtained by performing static analysis of the code in a disassembler like Ghidra.</li>
<li>ASLR shift offset: The <em>ASLR shift offset</em> for the current process. Since ASLR offset is randomly generated on every new instance of an application, this has to be obtained for every debugging session individually. This is determined using the debugger itself.</li>
</ol>
<blockquote>
<p>iOS is a modern operating system with multiple techniques implemented to mitigate code execution attacks, one such technique being Address Space Randomization Layout (ASLR). On every new execution of an application, a random ASLR shift offset is generated, and various process' data structures are shifted by this offset.</p>
</blockquote>
<p>The final breakpoint address to be used in the debugger is the sum of the above two addresses (Breakpoint offset + ASLR shift offset). This approach assumes that the image base address (discussed shortly) used by the disassembler and iOS is the same, which is true most of the time.</p>
<p>When a binary is opened in a disassembler like Ghidra, it loads a binary by emulating the respective operating system's loader. The address at which the binary is loaded is called <em>image base address</em>. All the code and symbols inside this binary can be addressed using a constant address offset from this image base address. In Ghidra, the image base address can be obtained by determining the address of the start of a Mach-O file. In this case, it is 0x100000000.</p>
<p><img src="../../assets/Images/Chapters/0x06c/debugging_ghidra_image_base_address.png" width="100%" /></p>
<p>From our previous analysis of the UnCrackable Level 1 application in "<a href="#manual-reversed-code-review">Manual (Reversed) Code Review</a>" section, the value of the hidden string is stored in a label with the <code>hidden</code> flag set. In the disassembly, the text value of this label is stored in register <code>X21</code>, stored via <code>mov</code> from <code>X0</code>, at offset 0x100004520. This is our <em>breakpoint offset</em>.</p>
<p><img src="../../assets/Images/Chapters/0x06c/debugging_ghidra_breakpoint.png" width="100%" /></p>
<p>For the second address, we need to determine the <em>ASLR shift offset</em> for a given process. The ASLR offset can be determined by using the LLDB command <code>image list -o -f</code>. The output is shown in the screenshot below.</p>
<p><img src="../../assets/Images/Chapters/0x06c/debugging_lldb_image_list.png" width="100%" /></p>
<p>In the output, the first column contains the sequence number of the image ([X]), the second column contains the randomly generated ASLR offset, while 3rd column contains the full path of the image and towards the end, content in the bracket shows the image base address after adding ASLR offset to the original image base address (0x100000000 + 0x70000 = 0x100070000). You will notice the image base address of 0x100000000 is same as in Ghidra. Now, to obtain the effective memory address for a code location we only need to add ASLR offset to the address identified in Ghidra. The effective address to set the breakpoint will be 0x100004520 + 0x70000 = 0x100074520. The breakpoint can be set using command <code>b 0x100074520</code>.</p>
<blockquote>
<p>In the above output, you may also notice that many of the paths listed as images do not point to the file system on the iOS device. Instead, they point to a certain location on the host computer on which LLDB is running. These images are system libraries for which debug symbols are available on the host computer to aid in application development and debugging (as part of the Xcode iOS SDK). Therefore, you may set breakpoints to these libraries directly by using function names.</p>
</blockquote>
<p>After putting the breakpoint and running the app, the execution will be halted once the breakpoint is hit. Now you can access and explore the current state of the process. In this case, you know from the previous static analysis that the register <code>X0</code> contains the hidden string, thus let's explore it. In LLDB you can print Objective-C objects using the <code>po</code> (<em>print object</em>) command.</p>
<p><img src="../../assets/Images/Chapters/0x06c/debugging_lldb_breakpoint_solution.png" width="100%" /></p>
<p>Voila, the crackme can be easily solved aided by static analysis and a debugger. There are plethora of features implemented in LLDB, including changing the value of the registers, changing values in the process memory and even <a href="https://lldb.llvm.org/use/python.html" title="LLDB - Python Scripting">automating tasks using Python scripts</a>.</p>
<p>Officially Apple recommends use of LLDB for debugging purposes, but GDB can be also used on iOS. The techniques discussed above are applicable while debugging using GDB as well, provided the LLDB specific commands are <a href="https://lldb.llvm.org/use/map.html" title="GDB to LLDB command map">changed to GDB commands</a>.</p>
<h3 id="tracing">Tracing<a class="headerlink" href="#tracing" title="Permanent link">&para;</a></h3>
<p>Tracing involves recording the information about a program's execution. In contrast to Android, there are limited options available for tracing various aspects of an iOS app. In this section we will be heavily relying on tools such as Frida for performing tracing.</p>
<h4 id="method-tracing">Method Tracing<a class="headerlink" href="#method-tracing" title="Permanent link">&para;</a></h4>
<p>Intercepting Objective-C methods is a useful iOS security testing technique. For example, you may be interested in data storage operations or network requests. In the following example, we'll write a simple tracer for logging HTTP(S) requests made via iOS standard HTTP APIs. We'll also show you how to inject the tracer into the Safari web browser.</p>
<p>In the following examples, we'll assume that you are working on a jailbroken device. If that's not the case, you first need to follow the steps outlined in section <a href="#repackaging-and-re-signing" title="Repackaging and Re-Signing">Repackaging and Re-Signing</a> to repackage the Safari app.</p>
<p>Frida comes with <code>frida-trace</code>, a function tracing tool. <code>frida-trace</code> accepts Objective-C methods via the <code>-m</code> flag. You can pass it wildcards as well-given <code>-[NSURL *]</code>, for example, <code>frida-trace</code> will automatically install hooks on all <code>NSURL</code> class selectors. We'll use this to get a rough idea about which library functions Safari calls when the user opens a URL.</p>
<p>Run Safari on the device and make sure the device is connected via USB. Then start <code>frida-trace</code> as follows:</p>
<div class="highlight"><pre><span></span><code>$ frida-trace -U -m <span class="s2">&quot;-[NSURL *]&quot;</span> Safari
Instrumenting functions...
-<span class="o">[</span>NSURL isMusicStoreURL<span class="o">]</span>: Loaded handler at <span class="s2">&quot;/Users/berndt/Desktop/__handlers__/__NSURL_isMusicStoreURL_.js&quot;</span>
-<span class="o">[</span>NSURL isAppStoreURL<span class="o">]</span>: Loaded handler at <span class="s2">&quot;/Users/berndt/Desktop/__handlers__/__NSURL_isAppStoreURL_.js&quot;</span>
<span class="o">(</span>...<span class="o">)</span>
Started tracing <span class="m">248</span> functions. Press Ctrl+C to stop.
</code></pre></div>
<p>Next, navigate to a new website in Safari. You should see traced function calls on the <code>frida-trace</code> console. Note that the <code>initWithURL:</code> method is called to initialize a new URL request object.</p>
<div class="highlight"><pre><span></span><code>           /* TID 0xc07 */
  <span class="m">20313</span> ms  -<span class="o">[</span>NSURLRequest _initWithCFURLRequest:0x1043bca30 <span class="o">]</span>
 <span class="m">20313</span> ms  -<span class="o">[</span>NSURLRequest URL<span class="o">]</span>
<span class="o">(</span>...<span class="o">)</span>
 <span class="m">21324</span> ms  -<span class="o">[</span>NSURLRequest initWithURL:0x106388b00 <span class="o">]</span>
 <span class="m">21324</span> ms     <span class="p">|</span> -<span class="o">[</span>NSURLRequest initWithURL:0x106388b00 cachePolicy:0x0 timeoutInterval:0x106388b80
</code></pre></div>
<h4 id="native-libraries-tracing">Native Libraries Tracing<a class="headerlink" href="#native-libraries-tracing" title="Permanent link">&para;</a></h4>
<p>As discussed earlier in this chapter, iOS applications can also contain native code (C/C++ code) and it can be traced using the <code>frida-trace</code> CLI as well. For example, you can trace calls to the <code>open</code> function by running the following command:</p>
<div class="highlight"><pre><span></span><code>$ frida-trace -U -i <span class="s2">&quot;open&quot;</span> sg.vp.UnCrackable1
</code></pre></div>
<p>The overall approach and further improvisation for tracing native code using Frida is similar to the one discussed in the Android "<a href="../0x05c-Reverse-Engineering-and-Tampering/#tracing" title="Tracing">Tracing</a>" section.</p>
<p>Unfortunately, there are no tools such as <code>strace</code> or <code>ftrace</code> available to trace syscalls or function calls of an iOS app. Only <code>DTrace</code> exists, which is a very powerful and versatile tracing tool, but it's only available for MacOS and not for iOS.</p>
<h3 id="emulation-based-analysis">Emulation-based Analysis<a class="headerlink" href="#emulation-based-analysis" title="Permanent link">&para;</a></h3>
<h4 id="ios-simulator">iOS Simulator<a class="headerlink" href="#ios-simulator" title="Permanent link">&para;</a></h4>
<p>Apple provides a simulator app within Xcode which provides a <em>real iOS device looking</em> user interface for iPhone, iPad or Apple Watch. It allows you to rapidly prototype and test debug builds of your applications during the development process, but actually <strong>it is not an emulator</strong>. Difference between a simulator and an emulator is previously discussed in "<a href="../0x04c-Tampering-and-Reverse-Engineering/#emulation-based-dynamic-analysis" title="Emulation-based Dynamic Analysis">Emulation-based Dynamic Analysis</a>" section.</p>
<p>While developing and debugging an application, the Xcode toolchain generates x86 code, which can be executed in the iOS simulator. However, for a release build, only ARM code is generated (incompatible with the iOS simulator). That's why applications downloaded from the Apple App Store cannot be used for any kind of application analysis on the iOS simulator.</p>
<h4 id="corellium">Corellium<a class="headerlink" href="#corellium" title="Permanent link">&para;</a></h4>
<p>Corellium is a commercial tool which offers virtual iOS devices running actual iOS firmware, being the only publicly available iOS emulator ever. Since it is a proprietary product, not much information is available about the implementation. Corellium has no community licenses available, therefore we won't go into much detail regarding its use.</p>
<p>Corellium allows you to launch multiple instances of a device (jailbroken or not) which are accessible as local devices (with a simple VPN configuration). It has the ability to take and restore snapshots of the device state, and also offers a convenient web-based shell to the device. Finally and most importantly, due to its "emulator" nature, you can execute applications downloaded from the Apple App Store, enabling any kind of application analysis as you know it from real iOS (jailbroken) devices.</p>
<p>Note that in order to install an IPA on Corellium devices it has to be unencrypted and signed with a valid Apple developer certificate. See more information <a href="https://support.corellium.com/en/articles/6181345-testing-third-party-ios-apps">here</a>.</p>
<h2 id="binary-analysis">Binary Analysis<a class="headerlink" href="#binary-analysis" title="Permanent link">&para;</a></h2>
<p>An introduction to binary analysis using binary analysis frameworks has already been discussed in the "<a href="../0x05c-Reverse-Engineering-and-Tampering/#dynamic-analysis" title="Dynamic analysis">Dynamic Analysis</a>" section for Android. We recommend you to revisit this section and refresh the concepts on this subject.</p>
<p>For Android, we used Angr's symbolic execution engine to solve a challenge. In this section, we will firstly use Unicorn to solve <a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/iOS/Level_01/UnCrackable_Level1.ipa" title="UnCrackable Level 1 iOS App">UnCrackable Level 1 crackme app</a> challenge and then we will revisit the Angr binary analysis framework to analyze the challenge but instead of symbolic execution we will use its concrete execution (or dynamic execution) features.</p>
<h3 id="unicorn">Unicorn<a class="headerlink" href="#unicorn" title="Permanent link">&para;</a></h3>
<p><a href="http://www.unicorn-engine.org/" title="Unicorn">Unicorn</a> is a lightweight, multi-architecture CPU emulator framework based on <a href="https://www.qemu.org/" title="QEMU">QEMU</a> and <a href="https://www.unicorn-engine.org/docs/beyond_qemu.html" title="Beyond QEMU">goes beyond it</a> by adding useful features especially made for CPU emulation. Unicorn provides the basic infrastructure needed to execute processor instructions. In this section we will use <a href="https://github.com/unicorn-engine/unicorn/tree/master/bindings/python" title="Unicorn Python bindings">Unicorn's Python bindings</a> to solve the <a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes/iOS/Level_01" title="UnCrackable App for iOS Level 1">UnCrackable App for iOS Level 1</a>.</p>
<p>To use Unicorn's <em>full power</em>, we would need to implement all the necessary infrastructure which generally is readily available from the operating system, e.g. binary loader, linker and other dependencies or use another higher level frameworks such as <a href="https://qiling.io" title="Qiling">Qiling</a> which leverages Unicorn to emulate CPU instructions, but understands the OS context. However, this is superfluous for this very localized challenge where only executing a small part of the binary will suffice.</p>
<p>While performing manual analysis in "<a href="#reviewing-disassembled-native-code" title="Reviewing Disassembled Native Code">Reviewing Disassembled Native Code</a>" section, we determined that the function at address 0x1000080d4 is responsible for dynamically generating the secret string. As we're about to see, all the necessary code is pretty much self-contained in the binary, making this a perfect scenario to use a CPU emulator like Unicorn.</p>
<p><img src="../../assets/Images/Chapters/0x06c/manual_reversing_ghidra_native_disassembly.png" width="100%" /></p>
<p>If we analyze that function and the subsequent function calls, we will observe that there is no hard dependency on any external library and neither it's performing any system calls. The only access external to the functions occurs for instance at address 0x1000080f4, where a value is being stored to address 0x10000dbf0, which maps to the <code>__data</code> section.</p>
<p>Therefore, in order to correctly emulate this section of the code, apart from the <code>__text</code> section (which contains the instructions) we also need to load the <code>__data</code> section.</p>
<p>To solve the challenge using Unicorn we will perform the following steps:</p>
<ul>
<li>Get the ARM64 version of the binary by running <code>lipo -thin arm64 &lt;app_binary&gt; -output uncrackable.arm64</code> (ARMv7 can be used as well).</li>
<li>Extract the <code>__text</code> and <code>__data</code> section from the binary.</li>
<li>Create and map the memory to be used as stack memory.</li>
<li>Create memory and load the <code>__text</code> and <code>__data</code> section.</li>
<li>Execute the binary by providing the start and end address.</li>
<li>Finally, dump the return value from the function, which in this case is our secret string.</li>
</ul>
<p>To extract the content of <code>__text</code> and <code>__data</code> section from the Mach-O binary we will use <a href="https://lief.quarkslab.com/" title="Lief">LIEF</a>, which provides a convenient abstraction to manipulate multiple executable file formats. Before loading these sections to memory, we need to determine their base addresses, e.g. by using Ghidra, Radare2 or IDA Pro.</p>
<p><img src="../../assets/Images/Chapters/0x06c/uncrackable_sections.png" width="500px"/></p>
<p>From the above table, we will use the base address 0x10000432c for <code>__text</code> and 0x10000d3e8 for <code>__data</code> section to load them at in the memory.</p>
<blockquote>
<p>While allocating memory for Unicorn, the memory addresses should be 4k page aligned and also the allocated size should be a multiple of 1024.</p>
</blockquote>
<p>The following script emulates the function at 0x1000080d4 and dumps the secret string:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">lief</span>
<span class="kn">from</span> <span class="nn">unicorn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">unicorn.arm64_const</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># --- Extract __text and __data section content from the binary ---</span>
<span class="n">binary</span> <span class="o">=</span> <span class="n">lief</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;uncrackable.arm64&quot;</span><span class="p">)</span>
<span class="n">text_section</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s2">&quot;__text&quot;</span><span class="p">)</span>
<span class="n">text_content</span> <span class="o">=</span> <span class="n">text_section</span><span class="o">.</span><span class="n">content</span>

<span class="n">data_section</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="s2">&quot;__data&quot;</span><span class="p">)</span>
<span class="n">data_content</span> <span class="o">=</span> <span class="n">data_section</span><span class="o">.</span><span class="n">content</span>

<span class="c1"># --- Setup Unicorn for ARM64 execution ---</span>
<span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;arm64le&quot;</span>
<span class="n">emu</span> <span class="o">=</span> <span class="n">Uc</span><span class="p">(</span><span class="n">UC_ARCH_ARM64</span><span class="p">,</span> <span class="n">UC_MODE_ARM</span><span class="p">)</span>

<span class="c1"># --- Create Stack memory ---</span>
<span class="n">addr</span> <span class="o">=</span> <span class="mh">0x40000000</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_map</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="n">emu</span><span class="o">.</span><span class="n">reg_write</span><span class="p">(</span><span class="n">UC_ARM64_REG_SP</span><span class="p">,</span> <span class="n">addr</span> <span class="o">+</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># --- Load text section --</span>
<span class="n">base_addr</span> <span class="o">=</span> <span class="mh">0x100000000</span>
<span class="n">tmp_len</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span>
<span class="n">text_section_load_addr</span> <span class="o">=</span> <span class="mh">0x10000432c</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_map</span><span class="p">(</span><span class="n">base_addr</span><span class="p">,</span> <span class="n">tmp_len</span><span class="p">)</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_write</span><span class="p">(</span><span class="n">text_section_load_addr</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">text_content</span><span class="p">))</span>

<span class="c1"># --- Load data section ---</span>
<span class="n">data_section_load_addr</span> <span class="o">=</span> <span class="mh">0x10000d3e8</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_write</span><span class="p">(</span><span class="n">data_section_load_addr</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data_content</span><span class="p">))</span>

<span class="c1"># --- Hack for stack_chk_guard ---</span>
<span class="c1"># without this will throw invalid memory read at 0x0</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_map</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="n">emu</span><span class="o">.</span><span class="n">mem_write</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;00&quot;</span><span class="p">)</span>


<span class="c1"># --- Execute from 0x1000080d4 to 0x100008154 ---</span>
<span class="n">emu</span><span class="o">.</span><span class="n">emu_start</span><span class="p">(</span><span class="mh">0x1000080d4</span><span class="p">,</span> <span class="mh">0x100008154</span><span class="p">)</span>
<span class="n">ret_value</span> <span class="o">=</span> <span class="n">emu</span><span class="o">.</span><span class="n">reg_read</span><span class="p">(</span><span class="n">UC_ARM64_REG_X0</span><span class="p">)</span>

<span class="c1"># --- Dump return value ---</span>
<span class="nb">print</span><span class="p">(</span><span class="n">emu</span><span class="o">.</span><span class="n">mem_read</span><span class="p">(</span><span class="n">ret_value</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>You may notice that there is an additional memory allocation at address 0x0, this is a simple hack around <code>stack_chk_guard</code> check. Without this, there will be a invalid memory read error and binary cannot be executed. With this hack, the program will access the value at 0x0 and use it for the <code>stack_chk_guard</code> check.</p>
</blockquote>
<p>To summarize, using Unicorn do require some additional setup before executing the binary, but once done, this tool can help to provide deep insights into the binary. It provides the flexibility to execute the full binary or a limited part of it. Unicorn also exposes APIs to attach hooks to the execution. Using these hooks you can observe the state of the program at any point during the execution or even manipulate the register or variable values and forcefully explore other execution branches in a program. Another advantage when running a binary in Unicorn is that you don't need to worry about various checks like root/jailbreak detection or debugger detection etc.</p>
<h3 id="angr">Angr<a class="headerlink" href="#angr" title="Permanent link">&para;</a></h3>
<p><a href="../0x08-Testing-Tools/#angr">Angr</a> is a very versatile tool, providing multiple techniques to facilitate binary analysis, while supporting various file formats and hardware instructions sets.</p>
<blockquote>
<p>The Mach-O backend in Angr is not well-supported, but it works perfectly fine for our case.</p>
</blockquote>
<p>While manually analyzing the code in the <a href="#reviewing-disassembled-native-code" title="Reviewing Disassembled Native Code">Reviewing Disassembled Native Code</a>" section, we reached a point where performing further manual analysis was cumbersome. The function at offset <code>0x1000080d4</code> was identified as the final target which contains the secret string.</p>
<p>If we revisit that function, we can see that it involves multiple sub-function calls and interestingly none of these functions have any dependencies on other library calls or system calls. This is a perfect case to use Angr's concrete execution engine. Follow the steps below to solve this challenge:</p>
<ul>
<li>Get the ARM64 version of the binary by running <code>lipo -thin arm64 &lt;app_binary&gt; -output uncrackable.arm64</code> (ARMv7 can be used as well).</li>
<li>Create an Angr <code>Project</code> by loading the above binary.</li>
<li>Get a <code>callable</code> object by passing the address of the function to be executed. From the Angr documentation: "A Callable is a representation of a function in the binary that can be interacted with like a native python function.".</li>
<li>Pass the above <code>callable</code> object to the concrete execution engine, which in this case is <code>claripy.backends.concrete</code>.</li>
<li>Access the memory and extract the string from the pointer returned by the above function.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">angr</span>
<span class="kn">import</span> <span class="nn">claripy</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">():</span>

    <span class="c1"># Load the binary by creating angr project.</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="s1">&#39;uncrackable.arm64&#39;</span><span class="p">)</span>

    <span class="c1"># Pass the address of the function to the callable</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">callable</span><span class="p">(</span><span class="mh">0x1000080d4</span><span class="p">)</span>

    <span class="c1"># Get the return value of the function</span>
    <span class="n">ptr_secret_string</span> <span class="o">=</span> <span class="n">claripy</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">concrete</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">func</span><span class="p">())</span><span class="o">.</span><span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Address of the pointer to the secret string: &quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">ptr_secret_string</span><span class="p">))</span>

    <span class="c1"># Extract the value from the pointer to the secret string</span>
    <span class="n">secret_string</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">result_state</span><span class="o">.</span><span class="n">mem</span><span class="p">[</span><span class="n">ptr_secret_string</span><span class="p">]</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">concrete</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Secret String: </span><span class="si">{</span><span class="n">secret_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">solve</span><span class="p">()</span>
</code></pre></div>
<p>Above, Angr executed an ARM64 code in an execution environment provided by one of its concrete execution engines. The result is accessed from the memory as if the program is executed on a real device. This case is a good example where binary analysis frameworks enable us to perform a comprehensive analysis of a binary, even in the absence of specialized devices needed to run it.</p>
<h2 id="tampering-and-runtime-instrumentation">Tampering and Runtime Instrumentation<a class="headerlink" href="#tampering-and-runtime-instrumentation" title="Permanent link">&para;</a></h2>
<h3 id="patching-repackaging-and-re-signing">Patching, Repackaging, and Re-Signing<a class="headerlink" href="#patching-repackaging-and-re-signing" title="Permanent link">&para;</a></h3>
<p>Time to get serious! As you already know, IPA files are actually ZIP archives, so you can use any ZIP tool to unpack the archive.</p>
<div class="highlight"><pre><span></span><code>$ unzip UnCrackable_Level1.ipa
</code></pre></div>
<h4 id="patching-example-installing-frida-gadget">Patching Example: Installing Frida Gadget<a class="headerlink" href="#patching-example-installing-frida-gadget" title="Permanent link">&para;</a></h4>
<p>IF you want to use Frida on non-jailbroken devices you'll need to include <code>FridaGadget.dylib</code>. Download it first:</p>
<div class="highlight"><pre><span></span><code>$ curl -O https://build.frida.re/frida/ios/lib/FridaGadget.dylib
</code></pre></div>
<p>Copy <code>FridaGadget.dylib</code> into the app directory and use <a href="../0x08-Testing-Tools/#optool">optool</a> to add a load command to the "UnCrackable Level 1" binary.</p>
<div class="highlight"><pre><span></span><code>$ unzip UnCrackable_Level1.ipa
$ cp FridaGadget.dylib Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/
$ optool install -c load -p <span class="s2">&quot;@executable_path/FridaGadget.dylib&quot;</span>  -t Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>
Found FAT Header
Found thin header...
Found thin header...
Inserting a LC_LOAD_DYLIB <span class="nb">command</span> <span class="k">for</span> architecture: arm
Successfully inserted a LC_LOAD_DYLIB <span class="nb">command</span> <span class="k">for</span> arm
Inserting a LC_LOAD_DYLIB <span class="nb">command</span> <span class="k">for</span> architecture: arm64
Successfully inserted a LC_LOAD_DYLIB <span class="nb">command</span> <span class="k">for</span> arm64
Writing executable to Payload/UnCrackable Level <span class="m">1</span>.app/UnCrackable Level <span class="m">1</span>...
</code></pre></div>
<h4 id="patching-example-making-an-app-debuggable">Patching Example: Making an App Debuggable<a class="headerlink" href="#patching-example-making-an-app-debuggable" title="Permanent link">&para;</a></h4>
<p>By default, an app available on the Apple App Store is not debuggable. In order to debug an iOS application, it must have the <code>get-task-allow</code> entitlement enabled. This entitlement allows other processes (like a debugger) to attach to the app. Xcode is not adding the <code>get-task-allow</code> entitlement in a distribution provisioning profile; it is only whitelisted and added in a development provisioning profile.</p>
<p>Thus, to debug an iOS application obtained from the App Store, it needs to be re-signed with a development provisioning profile with the <code>get-task-allow</code> entitlement. How to re-sign an application is discussed in the next section.</p>
<h4 id="repackaging-and-re-signing">Repackaging and Re-Signing<a class="headerlink" href="#repackaging-and-re-signing" title="Permanent link">&para;</a></h4>
<p>Of course, tampering an app invalidates the main executable's code signature, so this won't run on a non-jailbroken device. You'll need to replace the provisioning profile and sign both the main executable and the files you've made include (e.g. <code>FridaGadget.dylib</code>) with the certificate listed in the profile.</p>
<p>First, let's add our own provisioning profile to the package:</p>
<div class="highlight"><pre><span></span><code>$ cp AwesomeRepackaging.mobileprovision Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/embedded.mobileprovision
</code></pre></div>
<p>Next, we need to make sure that the Bundle ID in <code>Info.plist</code> matches the one specified in the profile because the codesign tool will read the Bundle ID from <code>Info.plist</code> during signing; the wrong value will lead to an invalid signature.</p>
<div class="highlight"><pre><span></span><code>$ /usr/libexec/PlistBuddy -c <span class="s2">&quot;Set :CFBundleIdentifier sg.vantagepoint.repackage&quot;</span> Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/Info.plist
</code></pre></div>
<p>Finally, we use the codesign tool to re-sign both binaries. You need to use <em>your</em> signing identity (in this example 8004380F331DCA22CC1B47FB1A805890AE41C938), which you can output by executing the command <code>security find-identity -v</code>.</p>
<div class="highlight"><pre><span></span><code>$ rm -rf Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/_CodeSignature
$ /usr/bin/codesign --force --sign 8004380F331DCA22CC1B47FB1A805890AE41C938  Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/FridaGadget.dylib
Payload/UnCrackable Level <span class="m">1</span>.app/FridaGadget.dylib: replacing existing signature
</code></pre></div>
<p><code>entitlements.plist</code> is the file you created for your empty iOS project.</p>
<div class="highlight"><pre><span></span><code>$ /usr/bin/codesign --force --sign 8004380F331DCA22CC1B47FB1A805890AE41C938 --entitlements entitlements.plist Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>
Payload/UnCrackable Level <span class="m">1</span>.app/UnCrackable Level <span class="m">1</span>: replacing existing signature
</code></pre></div>
<p>Now you should be ready to run the modified app. Deploy and run the app on the device using <a href="../0x08-Testing-Tools/#ios-deploy">ios-deploy</a>:</p>
<div class="highlight"><pre><span></span><code>$ ios-deploy --debug --bundle Payload/UnCrackable<span class="se">\ </span>Level<span class="se">\ </span><span class="m">1</span>.app/
</code></pre></div>
<p>If everything went well, the app should start in debugging mode with LLDB attached. Frida should then be able to attach to the app as well. You can verify this via the frida-ps command:</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -U
PID  Name
---  ------
<span class="m">499</span>  Gadget
</code></pre></div>
<p><img src="../../assets/Images/Chapters/0x06b/fridaStockiOS.png" width="100%" /></p>
<p>When something goes wrong (and it usually does), mismatches between the provisioning profile and code-signing header are the most likely causes. Reading the <a href="https://developer.apple.com/support/code-signing/" title="Code Signing">official documentation</a> helps you understand the code-signing process. Apple's <a href="https://developer.apple.com/library/content/technotes/tn2415/_index.html" title="Entitlements Troubleshooting">entitlement troubleshooting page</a> is also a useful resource.</p>
<h4 id="patching-react-native-applications">Patching React Native applications<a class="headerlink" href="#patching-react-native-applications" title="Permanent link">&para;</a></h4>
<p>If the <a href="https://facebook.github.io/react-native" title="React Native">React Native</a> framework has been used for development, the main application code is in the file <code>Payload/[APP].app/main.jsbundle</code>. This file contains the JavaScript code. Most of the time, the JavaScript code in this file is minified. With the tool <a href="https://mindedsecurity.github.io/jstillery" title="JStillery">JStillery</a>, a human-readable version of the file can be retried, which will allow code analysis. The <a href="https://github.com/mindedsecurity/jstillery/" title="CLI version of JStillery">CLI version of JStillery</a> and the local server are preferable to the online version because the latter discloses the source code to a third party.</p>
<p>At installation time, the application archive is unpacked into the folder <code>/private/var/containers/Bundle/Application/[GUID]/[APP].app</code> from iOS 10 onward, so the main JavaScript application file can be modified at this location.</p>
<p>To identify the exact location of the application folder, you can use the tool <a href="https://cydia.saurik.com/package/com.slugrail.ipainstaller/" title="ipainstaller">ipainstaller</a>:</p>
<ol>
<li>Use the command <code>ipainstaller -l</code> to list the applications installed on the device. Get the name of the target application from the output list.</li>
<li>Use the command <code>ipainstaller -i [APP_NAME]</code> to display information about the target application, including the installation and data folder locations.</li>
<li>Take the path referenced at the line that starts with <code>Application:</code>.</li>
</ol>
<p>Use the following approach to patch the JavaScript file:</p>
<ol>
<li>Navigate to the application folder.</li>
<li>Copy the contents of the file <code>Payload/[APP].app/main.jsbundle</code> to a temporary file.</li>
<li>Use <code>JStillery</code> to beautify and de-obfuscate the contents of the temporary file.</li>
<li>Identify the code in the temporary file that should be patched and patch it.</li>
<li>Put the <em>patched code</em> on a single line and copy it into the original <code>Payload/[APP].app/main.jsbundle</code> file.</li>
<li>Close and restart the application.</li>
</ol>
<h3 id="dynamic-instrumentation">Dynamic Instrumentation<a class="headerlink" href="#dynamic-instrumentation" title="Permanent link">&para;</a></h3>
<h4 id="information-gathering">Information Gathering<a class="headerlink" href="#information-gathering" title="Permanent link">&para;</a></h4>
<p>In this section we will learn how to use Frida to obtain information about a running application.</p>
<h4 id="getting-loaded-classes-and-their-methods">Getting Loaded Classes and their Methods<a class="headerlink" href="#getting-loaded-classes-and-their-methods" title="Permanent link">&para;</a></h4>
<p>In the Frida REPL Objective-C runtime the <code>ObjC</code> command can be used to access information within the running app. Within the <code>ObjC</code> command the function <code>enumerateLoadedClasses</code> lists the loaded classes for a given application.</p>
<div class="highlight"><pre><span></span><code>$ frida -U -f com.iOweApp

<span class="o">[</span>iPhone::com.iOweApp<span class="o">]</span>-&gt; ObjC.enumerateLoadedClasses<span class="o">()</span>
<span class="o">{</span>
    <span class="s2">&quot;/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation&quot;</span>: <span class="o">[</span>
        <span class="s2">&quot;__NSBlockVariable__&quot;</span>,
        <span class="s2">&quot;__NSGlobalBlock__&quot;</span>,
        <span class="s2">&quot;__NSFinalizingBlock__&quot;</span>,
        <span class="s2">&quot;__NSAutoBlock__&quot;</span>,
        <span class="s2">&quot;__NSMallocBlock__&quot;</span>,
        <span class="s2">&quot;__NSStackBlock__&quot;</span>
    <span class="o">]</span>,
    <span class="s2">&quot;/private/var/containers/Bundle/Application/F390A491-3524-40EA-B3F8-6C1FA105A23A/iOweApp.app/iOweApp&quot;</span>: <span class="o">[</span>
        <span class="s2">&quot;JailbreakDetection&quot;</span>,
        <span class="s2">&quot;CriticalLogic&quot;</span>,
        <span class="s2">&quot;ViewController&quot;</span>,
        <span class="s2">&quot;AppDelegate&quot;</span>
    <span class="o">]</span>
<span class="o">}</span>
</code></pre></div>
<p>Using <code>ObjC.classes.&lt;classname&gt;.$ownMethods</code> the methods declared in each class can be listed.</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>iPhone::com.iOweApp<span class="o">]</span>-&gt; ObjC.classes.JailbreakDetection.<span class="nv">$ownMethods</span>
<span class="o">[</span>
    <span class="s2">&quot;+ isJailbroken&quot;</span>
<span class="o">]</span>

<span class="o">[</span>iPhone::com.iOweApp<span class="o">]</span>-&gt; ObjC.classes.CriticalLogic.<span class="nv">$ownMethods</span>
<span class="o">[</span>
    <span class="s2">&quot;+ doSha256:&quot;</span>,
    <span class="s2">&quot;- a:&quot;</span>,
    <span class="s2">&quot;- AES128Operation:data:key:iv:&quot;</span>,
    <span class="s2">&quot;- coreLogic&quot;</span>,
    <span class="s2">&quot;- bat&quot;</span>,
    <span class="s2">&quot;- b:&quot;</span>,
    <span class="s2">&quot;- hexString:&quot;</span>
<span class="o">]</span>
</code></pre></div>
<h4 id="getting-loaded-libraries">Getting Loaded Libraries<a class="headerlink" href="#getting-loaded-libraries" title="Permanent link">&para;</a></h4>
<p>In Frida REPL process related information can be obtained using the <code>Process</code> command. Within the <code>Process</code> command the function <code>enumerateModules</code> lists the libraries loaded into the process memory.</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>iPhone::com.iOweApp<span class="o">]</span>-&gt; Process.enumerateModules<span class="o">()</span>
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&quot;base&quot;</span>: <span class="s2">&quot;0x10008c000&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;iOweApp&quot;</span>,
        <span class="s2">&quot;path&quot;</span>: <span class="s2">&quot;/private/var/containers/Bundle/Application/F390A491-3524-40EA-B3F8-6C1FA105A23A/iOweApp.app/iOweApp&quot;</span>,
        <span class="s2">&quot;size&quot;</span>: <span class="m">49152</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;base&quot;</span>: <span class="s2">&quot;0x1a1c82000&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;Foundation&quot;</span>,
        <span class="s2">&quot;path&quot;</span>: <span class="s2">&quot;/System/Library/Frameworks/Foundation.framework/Foundation&quot;</span>,
        <span class="s2">&quot;size&quot;</span>: <span class="m">2859008</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;base&quot;</span>: <span class="s2">&quot;0x1a16f4000&quot;</span>,
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;libobjc.A.dylib&quot;</span>,
        <span class="s2">&quot;path&quot;</span>: <span class="s2">&quot;/usr/lib/libobjc.A.dylib&quot;</span>,
        <span class="s2">&quot;size&quot;</span>: <span class="m">200704</span>
    <span class="o">}</span>,

    ...
</code></pre></div>
<p>Similarly, information related to various threads can be obtained.</p>
<div class="highlight"><pre><span></span><code>Process.enumerateThreads<span class="o">()</span>
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&quot;context&quot;</span>: <span class="o">{</span>
            ...
       <span class="o">}</span>,
        <span class="s2">&quot;id&quot;</span>: <span class="m">1287</span>,
        <span class="s2">&quot;state&quot;</span>: <span class="s2">&quot;waiting&quot;</span>
    <span class="o">}</span>,

    ...
</code></pre></div>
<p>The <code>Process</code> command exposes multiple functions which can be explored as per needs. Some useful functions are <code>findModuleByAddress</code>, <code>findModuleByName</code> and <code>enumerateRanges</code> besides others.</p>
<h4 id="method-hooking">Method Hooking<a class="headerlink" href="#method-hooking" title="Permanent link">&para;</a></h4>
<h5 id="frida">Frida<a class="headerlink" href="#frida" title="Permanent link">&para;</a></h5>
<p>In section <a href="#execution-tracing" title="Execution Tracing">"Execution Tracing"</a> we've used frida-trace when navigating to a website in Safari and found that the <code>initWithURL:</code> method is called to initialize a new URL request object. We can look up the declaration of this method on the <a href="https://developer.apple.com/documentation/foundation/nsbundle/1409352-initwithurl?language=objc" title="Apple Developer Website - initWithURL Instance Method">Apple Developer Website</a>:</p>
<div class="highlight"><pre><span></span><code><span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">initWithURL:</span><span class="p">(</span><span class="bp">NSURL</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">url</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Using this information we can write a Frida script that intercepts the <code>initWithURL:</code> method and prints the URL passed to the method. The full script is below. Make sure you read the code and inline comments to understand what's going on.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">frida</span>


<span class="c1"># JavaScript to be injected</span>
<span class="n">frida_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    // Obtain a reference to the initWithURL: method of the NSURLRequest class</span>
<span class="s2">    var URL = ObjC.classes.NSURLRequest[&quot;- initWithURL:&quot;];</span>

<span class="s2">    // Intercept the method</span>
<span class="s2">    Interceptor.attach(URL.implementation, {</span>
<span class="s2">        onEnter: function(args) {</span>
<span class="s2">            // Get a handle on NSString</span>
<span class="s2">            var NSString = ObjC.classes.NSString;</span>

<span class="s2">            // Obtain a reference to the NSLog function, and use it to print the URL value</span>
<span class="s2">            // args[2] refers to the first method argument (NSURL *url)</span>
<span class="s2">            var NSLog = new NativeFunction(Module.findExportByName(&#39;Foundation&#39;, &#39;NSLog&#39;), &#39;void&#39;, [&#39;pointer&#39;, &#39;...&#39;]);</span>

<span class="s2">            // We should always initialize an autorelease pool before interacting with Objective-C APIs</span>
<span class="s2">            var pool = ObjC.classes.NSAutoreleasePool.alloc().init();</span>

<span class="s2">            try {</span>
<span class="s2">                // Creates a JS binding given a NativePointer.</span>
<span class="s2">                var myNSURL = new ObjC.Object(args[2]);</span>

<span class="s2">                // Create an immutable ObjC string object from a JS string object.</span>
<span class="s2">                var str_url = NSString.stringWithString_(myNSURL.toString());</span>

<span class="s2">                // Call the iOS NSLog function to print the URL to the iOS device logs</span>
<span class="s2">                NSLog(str_url);</span>

<span class="s2">                // Use Frida&#39;s console.log to print the URL to your terminal</span>
<span class="s2">                console.log(str_url);</span>

<span class="s2">            } finally {</span>
<span class="s2">                pool.release();</span>
<span class="s2">            }</span>
<span class="s2">        }</span>
<span class="s2">    });</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">process</span> <span class="o">=</span> <span class="n">frida</span><span class="o">.</span><span class="n">get_usb_device</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s2">&quot;Safari&quot;</span><span class="p">)</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">create_script</span><span class="p">(</span><span class="n">frida_code</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div>
<p>Start Safari on the iOS device. Run the above Python script on your connected host and open the device log (as explained in the section "Monitoring System Logs" from the chapter "iOS Basic Security Testing"). Try opening a new URL in Safari, e.g. <a href="https://github.com/OWASP/owasp-mstg">https://github.com/OWASP/owasp-mstg</a>; you should see Frida's output in the logs as well as in your terminal.</p>
<p><img src="../../assets/Images/Chapters/0x06c/frida-xcode-log.png" width="100%" /></p>
<p>Of course, this example illustrates only one of the things you can do with Frida. To unlock the tool's full potential, you should learn to use its <a href="https://www.frida.re/docs/javascript-api/" title="Frida JavaScript API reference">JavaScript API</a>. The documentation section of the Frida website has a <a href="https://www.frida.re/docs/ios/" title="Frida Tutorial">tutorial</a> and <a href="https://www.frida.re/docs/examples/ios/" title="Frida examples">examples</a> for using Frida on iOS.</p>
<h4 id="process-exploration">Process Exploration<a class="headerlink" href="#process-exploration" title="Permanent link">&para;</a></h4>
<p>When testing an app, process exploration can provide the tester with deep insights into the app process memory. It can be achieved via runtime instrumentation and allows to perform tasks such as:</p>
<ul>
<li>Retrieving the memory map and loaded libraries.</li>
<li>Searching for occurrences of certain data.</li>
<li>After doing a search, obtaining the location of a certain offset in the memory map.</li>
<li>Performing a memory dump and inspect or reverse engineer the binary data <em>offline</em>.</li>
<li>Reverse engineering a binary or Framework while it's running.</li>
</ul>
<p>As you can see, these tasks are rather supportive and/or passive, they'll help us collect data and information that will support other techniques. Therefore, they're normally used in combination with other techniques such as method hooking.</p>
<p>In the following sections you will be using <a href="../0x08-Testing-Tools/#r2frida">r2frida</a> to retrieve information straight from the app runtime. First start by opening an r2frida session to the target app (e.g. iGoat-Swift) that should be running on your iPhone (connected per USB). Use the following command:</p>
<div class="highlight"><pre><span></span><code>$ r2 frida://usb//iGoat-Swift
</code></pre></div>
<h5 id="memory-maps-and-inspection">Memory Maps and Inspection<a class="headerlink" href="#memory-maps-and-inspection" title="Permanent link">&para;</a></h5>
<p>You can retrieve the app's memory maps by running <code>\dm</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\d</span>m
0x0000000100b7c000 - 0x0000000100de0000 r-x /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app/iGoat-Swift
0x0000000100de0000 - 0x0000000100e68000 rw- /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app/iGoat-Swift
0x0000000100e68000 - 0x0000000100e97000 r-- /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app/iGoat-Swift
...
0x0000000100ea8000 - 0x0000000100eb0000 rw-
0x0000000100eb0000 - 0x0000000100eb4000 r--
0x0000000100eb4000 - 0x0000000100eb8000 r-x /usr/lib/TweakInject.dylib
0x0000000100eb8000 - 0x0000000100ebc000 rw- /usr/lib/TweakInject.dylib
0x0000000100ebc000 - 0x0000000100ec0000 r-- /usr/lib/TweakInject.dylib
0x0000000100f60000 - 0x00000001012dc000 r-x /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app/Frameworks/Realm.framework/Realm
</code></pre></div>
<p>While you're searching or exploring the app memory, you can always verify where your current offset is located in the memory map. Instead of noting and searching for the memory address in this list you can simply run <code>\dm.</code>. You'll find an example in the following section "In-Memory Search".</p>
<p>If you're only interested into the modules (binaries and libraries) that the app has loaded, you can use the command <code>\il</code> to list them all:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>l
0x0000000100b7c000 iGoat-Swift
0x0000000100eb4000 TweakInject.dylib
0x00000001862c0000 SystemConfiguration
0x00000001847c0000 libc++.1.dylib
0x0000000185ed9000 Foundation
0x000000018483c000 libobjc.A.dylib
0x00000001847be000 libSystem.B.dylib
0x0000000185b77000 CFNetwork
0x0000000187d64000 CoreData
0x00000001854b4000 CoreFoundation
0x00000001861d3000 Security
0x000000018ea1d000 UIKit
0x0000000100f60000 Realm
</code></pre></div>
<p>As you might expect you can correlate the addresses of the libraries with the memory maps: e.g. the main app binary iGoat-Swift is located at <code>0x0000000100b7c000</code> and the Realm Framework at <code>0x0000000100f60000</code>.</p>
<p>You can also use objection to display the same information.</p>
<div class="highlight"><pre><span></span><code>$ objection --gadget OWASP.iGoat-Swift explore

OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">11</span>.1.2<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># memory list modules</span>
Save the output by adding <span class="sb">`</span>--json modules.json<span class="sb">`</span> to this <span class="nb">command</span>

Name                              Base         Size                  Path
--------------------------------  -----------  --------------------  ------------------------------------------------------------------------------
iGoat-Swift                       0x100b7c000  <span class="m">2506752</span> <span class="o">(</span><span class="m">2</span>.4 MiB<span class="o">)</span>     /var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGo...
TweakInject.dylib                 0x100eb4000  <span class="m">16384</span> <span class="o">(</span><span class="m">16</span>.0 KiB<span class="o">)</span>      /usr/lib/TweakInject.dylib
SystemConfiguration               0x1862c0000  <span class="m">446464</span> <span class="o">(</span><span class="m">436</span>.0 KiB<span class="o">)</span>    /System/Library/Frameworks/SystemConfiguration.framework/SystemConfiguratio...
libc++.1.dylib                    0x1847c0000  <span class="m">368640</span> <span class="o">(</span><span class="m">360</span>.0 KiB<span class="o">)</span>    /usr/lib/libc++.1.dylib
</code></pre></div>
<h5 id="in-memory-search">In-Memory Search<a class="headerlink" href="#in-memory-search" title="Permanent link">&para;</a></h5>
<p>In-memory search is a very useful technique to test for sensitive data that might be present in the app memory.</p>
<p>See r2frida's help on the search command (<code>\/?</code>) to learn about the search command and get a list of options. The following shows only a subset of them:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\/</span>?
 /      search
 /j     search json
 /w     search wide
 /wj    search wide json
 /x     search hex
 /xj    search hex json
...
</code></pre></div>
<p>You can adjust your search by using the search settings <code>\e~search</code>. For example, <code>\e search.quiet=true;</code> will print only the results and hide search progress:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\e</span>~search
e search.in<span class="o">=</span>perm:r--
e search.quiet<span class="o">=</span><span class="nb">false</span>
</code></pre></div>
<p>For now, we'll continue with the defaults and concentrate on string search. In this first example, you can start by searching for something that you know should be located in the main binary of the app:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\/</span> iGoat
Searching <span class="m">5</span> bytes: <span class="m">69</span> <span class="m">47</span> 6f <span class="m">61</span> <span class="m">74</span>
Searching <span class="m">5</span> bytes <span class="k">in</span> <span class="o">[</span>0x0000000100b7c000-0x0000000100de0000<span class="o">]</span>
...
hits: <span class="m">509</span>
0x100d7d332 hit2_0 iGoat_Swift24StringAnalysisExerciseVCC
0x100d7d3b2 hit2_1 iGoat_Swift28BrokenCryptographyExerciseVCC
0x100d7d442 hit2_2 iGoat_Swift23BackgroundingExerciseVCC
0x100d7d4b2 hit2_3 iGoat_Swift9AboutCellC
0x100d7d522 hit2_4 iGoat_Swift12FadeAnimatorV
</code></pre></div>
<p>Now take the first hit, seek to it and check your current location in the memory map:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; s 0x100d7d332
<span class="o">[</span>0x100d7d332<span class="o">]</span>&gt; <span class="se">\d</span>m.
0x0000000100b7c000 - 0x0000000100de0000 r-x /private/var/containers/Bundle/Application/3ADAF47D-A734-49FA-B274-FBCA66589E67/iGoat-Swift.app/iGoat-Swift
</code></pre></div>
<p>As expected, you are located in the region of the main iGoat-Swift binary (r-x, read and execute). In the previous section, you saw that the main binary is located between <code>0x0000000100b7c000</code> and <code>0x0000000100e97000</code>.</p>
<p>Now, for this second example, you can search for something that's not in the app binary nor in any loaded library, typically user input. Open the iGoat-Swift app and navigate in the menu to <strong>Authentication</strong> -&gt; <strong>Remote Authentication</strong> -&gt; <strong>Start</strong>. There you'll find a password field that you can overwrite. Write the string "owasp-mstg" but do not click on <strong>Login</strong> just yet. Perform the following two steps.</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\/</span> owasp-mstg
hits: <span class="m">1</span>
0x1c06619c0 hit3_0 owasp-mstg
</code></pre></div>
<p>In fact, the string could be found at address <code>0x1c06619c0</code>. Seek <code>s</code> to there and retrieve the current memory region with <code>\dm.</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x100d7d332<span class="o">]</span>&gt; s 0x1c06619c0
<span class="o">[</span>0x1c06619c0<span class="o">]</span>&gt; <span class="se">\d</span>m.
0x00000001c0000000 - 0x00000001c8000000 rw-
</code></pre></div>
<p>Now you know that the string is located in a rw- (read and write) region of the memory map.</p>
<p>Additionally, you can search for occurrences of the <a href="https://en.wikipedia.org/wiki/Wide_character" title="Wide character">wide version of the string</a> (<code>/w</code>) and, again, check their memory regions:</p>
<blockquote>
<p>This time we run the <code>\dm.</code> command for all <code>@@</code> hits matching the glob <code>hit5_*</code>.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; /w owasp-mstg
Searching <span class="m">20</span> bytes: 6f <span class="m">00</span> <span class="m">77</span> <span class="m">00</span> <span class="m">61</span> <span class="m">00</span> <span class="m">73</span> <span class="m">00</span> <span class="m">70</span> <span class="m">00</span> 2d <span class="m">00</span> 6d <span class="m">00</span> <span class="m">73</span> <span class="m">00</span> <span class="m">74</span> <span class="m">00</span> <span class="m">67</span> <span class="m">00</span>
Searching <span class="m">20</span> bytes <span class="k">in</span> <span class="o">[</span>0x0000000100708000-0x000000010096c000<span class="o">]</span>
...
hits: <span class="m">2</span>
0x1020d1280 hit5_0 6f0077006100730070002d006d00730074006700
0x1030c9c85 hit5_1 6f0077006100730070002d006d00730074006700

<span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\d</span>m.@@ hit5_*
0x0000000102000000 - 0x0000000102100000 rw-
0x0000000103084000 - 0x00000001030cc000 rw-
</code></pre></div>
<p>They are in a different rw- region. Note that searching for the wide versions of strings is sometimes the only way to find them as you'll see in the following section.</p>
<p>In-memory search can be very useful to quickly know if certain data is located in the main app binary, inside a shared library or in another region. You may also use it to test the behavior of the app regarding how the data is kept in memory. For instance, you could continue the previous example, this time clicking on Login and searching again for occurrences of the data. Also, you may check if you still can find those strings in memory after the login is completed to verify if this <em>sensitive data</em> is wiped from memory after its use.</p>
<h5 id="memory-dump">Memory Dump<a class="headerlink" href="#memory-dump" title="Permanent link">&para;</a></h5>
<p>You can dump the app's process memory with <a href="../0x08-Testing-Tools/#objection">objection</a> and <a href="https://github.com/Nightbringer21/fridump" title="Fridump">Fridump</a>. To take advantage of these tools on a non-jailbroken device, the Android app must be repackaged with <code>frida-gadget.so</code> and re-signed. A detailed explanation of this process is in the section "<a href="#dynamic-analysis-on-non-jailbroken-devices" title="Dynamic Analysis on Non-Jailbroken Devices">Dynamic Analysis on Non-Jailbroken Devices</a>. To use these tools on a jailbroken phone, simply have frida-server installed and running.</p>
<p>With objection it is possible to dump all memory of the running process on the device by using the command <code>memory dump all</code>.</p>
<div class="highlight"><pre><span></span><code>$ objection explore

iPhone on <span class="o">(</span>iPhone: <span class="m">10</span>.3.1<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># memory dump all /Users/foo/memory_iOS/memory</span>
Dumping <span class="m">768</span>.0 KiB from base: 0x1ad200000  <span class="o">[</span><span class="c1">####################################]  100%</span>
Memory dumped to file: /Users/foo/memory_iOS/memory
</code></pre></div>
<p>Alternatively you can use Fridump. First, you need the name of the app you want to dump, which you can get with <code>frida-ps</code>.</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -U
 PID  Name
----  ------
<span class="m">1026</span>  Gadget
</code></pre></div>
<p>Afterwards, specify the app name in Fridump.</p>
<div class="highlight"><pre><span></span><code>$ python3 fridump.py -u Gadget -s

Current Directory: /Users/foo/PentestTools/iOS/fridump
Output directory is <span class="nb">set</span> to: /Users/foo/PentestTools/iOS/fridump/dump
Creating directory...
Starting Memory dump...
Progress: <span class="o">[</span><span class="c1">##################################################] 100.0% Complete</span>

Running strings on all files:
Progress: <span class="o">[</span><span class="c1">##################################################] 100.0% Complete</span>

Finished! Press Ctrl+C
</code></pre></div>
<p>When you add the <code>-s</code> flag, all strings are extracted from the dumped raw memory files and added to the file <code>strings.txt</code>, which is stored in Fridump's dump directory.</p>
<p>In both cases, if you open the file in radare2 you can use its search command (<code>/</code>). Note that first we do a standard string search which doesn't succeed and next we search for a <a href="https://en.wikipedia.org/wiki/Wide_character" title="Wide character">wide string</a>, which successfully finds our string "owasp-mstg".</p>
<div class="highlight"><pre><span></span><code>$ r2 memory_ios
<span class="o">[</span>0x00000000<span class="o">]</span>&gt; / owasp-mstg
Searching <span class="m">10</span> bytes <span class="k">in</span> <span class="o">[</span>0x0-0x628c000<span class="o">]</span>
hits: <span class="m">0</span>
<span class="o">[</span>0x00000000<span class="o">]</span>&gt; /w owasp-mstg
Searching <span class="m">20</span> bytes <span class="k">in</span> <span class="o">[</span>0x0-0x628c000<span class="o">]</span>
hits: <span class="m">1</span>
0x0036f800 hit4_0 6f0077006100730070002d006d00730074006700
</code></pre></div>
<p>Next, we can seek to its address using <code>s 0x0036f800</code>  or <code>s hit4_0</code> and print it using <code>psw</code> (which stands for <em>print string wide</em>) or use <code>px</code> to print its raw hexadecimal values:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x0036f800<span class="o">]</span>&gt; psw
owasp-mstg

<span class="o">[</span>0x0036f800<span class="o">]</span>&gt; px <span class="m">48</span>
- offset -   <span class="m">0</span> <span class="m">1</span>  <span class="m">2</span> <span class="m">3</span>  <span class="m">4</span> <span class="m">5</span>  <span class="m">6</span> <span class="m">7</span>  <span class="m">8</span> <span class="m">9</span>  A B  C D  E F  0123456789ABCDEF
0x0036f800  6f00 <span class="m">7700</span> <span class="m">6100</span> <span class="m">7300</span> <span class="m">7000</span> 2d00 6d00 <span class="m">7300</span>  o.w.a.s.p.-.m.s.
0x0036f810  <span class="m">7400</span> <span class="m">6700</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  t.g.............
0x0036f820  <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span> <span class="m">0000</span>  ................
</code></pre></div>
<p>Note that in order to find this string using the <code>strings</code> command you'll have to specify an encoding using the <code>-e</code> flag and in this case <code>l</code> for 16-bit little-endian character.</p>
<div class="highlight"><pre><span></span><code>$ strings -e l memory_ios <span class="p">|</span> grep owasp-mstg
owasp-mstg
</code></pre></div>
<h5 id="runtime-reverse-engineering">Runtime Reverse Engineering<a class="headerlink" href="#runtime-reverse-engineering" title="Permanent link">&para;</a></h5>
<p>Runtime reverse engineering can be seen as the on-the-fly version of reverse engineering where you don't have the binary data to your host computer. Instead, you'll analyze it straight from the memory of the app.</p>
<p>We'll keep using the iGoat-Swift app, open a session with r2frida <code>r2 frida://usb//iGoat-Swift</code> and you can start by displaying the target binary information by using the <code>\i</code> command:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>
arch                arm
bits                <span class="m">64</span>
os                  darwin
pid                 <span class="m">2166</span>
uid                 <span class="m">501</span>
objc                <span class="nb">true</span>
runtime             V8
java                <span class="nb">false</span>
cylang              <span class="nb">true</span>
pageSize            <span class="m">16384</span>
pointerSize         <span class="m">8</span>
codeSigningPolicy   optional
isDebuggerAttached  <span class="nb">false</span>
cwd                 /
</code></pre></div>
<p>Search all symbols of a certain module with <code>\is &lt;lib&gt;</code>, e.g. <code>\is libboringssl.dylib</code>.</p>
<p>The following does a case-insensitive search (grep) for symbols including "aes" (<code>~+aes</code>).</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>s libboringssl.dylib~+aes
0x1863d6ed8 s EVP_aes_128_cbc
0x1863d6ee4 s EVP_aes_192_cbc
0x1863d6ef0 s EVP_aes_256_cbc
0x1863d6f14 s EVP_has_aes_hardware
0x1863d6f1c s aes_init_key
0x1863d728c s aes_cipher
0x0 u ccaes_cbc_decrypt_mode
0x0 u ccaes_cbc_encrypt_mode
...
</code></pre></div>
<p>Or you might prefer to look into the imports/exports. For example:</p>
<ul>
<li>List all imports of the main binary: <code>\ii iGoat-Swift</code>.</li>
<li>List exports of the libc++.1.dylib library: <code>\iE /usr/lib/libc++.1.dylib</code>.</li>
</ul>
<blockquote>
<p>For big binaries it's recommended to pipe the output to the internal less program by appending <code>~..</code>, i.e. <code>\ii iGoat-Swift~..</code> (if not, for this binary, you'd get almost 5000 lines printed to your terminal).</p>
</blockquote>
<p>The next thing you might want to look at are the classes:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>c~+passcode
PSPasscodeField
_UITextFieldPasscodeCutoutBackground
UIPasscodeField
PasscodeFieldCell
...
</code></pre></div>
<p>List class fields:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x19687256c<span class="o">]</span>&gt; <span class="se">\i</span>c UIPasscodeField
0x000000018eec6680 - becomeFirstResponder
0x000000018eec5d78 - appendString:
0x000000018eec6650 - canBecomeFirstResponder
0x000000018eec6700 - isFirstResponder
0x000000018eec6a60 - hitTest:forEvent:
0x000000018eec5384 - setKeyboardType:
0x000000018eec5c8c - setStringValue:
0x000000018eec5c64 - stringValue
...
</code></pre></div>
<p>Imagine that you are interested into <code>0x000000018eec5c8c - setStringValue:</code>. You can seek to that address with <code>s 0x000000018eec5c8c</code>, analyze that function <code>af</code> and print 10 lines of its disassembly <code>pd 10</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x18eec5c8c<span class="o">]</span>&gt; pd <span class="m">10</span>
╭ <span class="o">(</span>fcn<span class="o">)</span> fcn.18eec5c8c <span class="m">35</span>
│   fcn.18eec5c8c <span class="o">(</span>int32_t arg1, int32_t arg3<span class="o">)</span><span class="p">;</span>
│ bp: <span class="m">0</span> <span class="o">(</span>vars <span class="m">0</span>, args <span class="m">0</span><span class="o">)</span>
│ sp: <span class="m">0</span> <span class="o">(</span>vars <span class="m">0</span>, args <span class="m">0</span><span class="o">)</span>
│ rg: <span class="m">2</span> <span class="o">(</span>vars <span class="m">0</span>, args <span class="m">2</span><span class="o">)</span>
│           0x18eec5c8c      f657bd         not byte <span class="o">[</span>rdi - 0x43<span class="o">]</span>      <span class="p">;</span> arg1
│           0x18eec5c8f      a9f44f01a9     <span class="nb">test</span> eax, 0xa9014ff4
│           0x18eec5c94      fd             std
│       ╭─&lt; 0x18eec5c95      7b02           jnp 0x18eec5c99
│       │   0x18eec5c97      a9fd830091     <span class="nb">test</span> eax, 0x910083fd
│           0x18eec5c9c      f30300         add eax, dword <span class="o">[</span>rax<span class="o">]</span>
│           0x18eec5c9f      aa             stosb byte <span class="o">[</span>rdi<span class="o">]</span>, al
│       ╭─&lt; 0x18eec5ca0      e003           loopne 0x18eec5ca5
│       │   0x18eec5ca2      02aa9b494197   add ch, byte <span class="o">[</span>rdx - 0x68beb665<span class="o">]</span> <span class="p">;</span> arg3
╰           0x18eec5ca8      f4             hlt
</code></pre></div>
<p>Finally, instead of doing a full memory search for strings, you may want to retrieve the strings from a certain binary and filter them, as you'd do <em>offline</em> with radare2. For this you have to find the binary, seek to it and then run the <code>\iz</code> command.</p>
<blockquote>
<p>It's recommended to apply a filter with a keyword <code>~&lt;keyword&gt;</code>/<code>~+&lt;keyword&gt;</code> to minimize the terminal output. If just want to explore all results you can also pipe them to the internal less <code>\iz~..</code>.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>l~iGoa
0x00000001006b8000 iGoat-Swift
<span class="o">[</span>0x00000000<span class="o">]</span>&gt; s 0x00000001006b8000
<span class="o">[</span>0x1006b8000<span class="o">]</span>&gt; <span class="se">\i</span>z
Reading <span class="m">2</span>.390625MB ...
Do you want to print <span class="m">8568</span> lines? <span class="o">(</span>y/N<span class="o">)</span> N
<span class="o">[</span>0x1006b8000<span class="o">]</span>&gt; <span class="se">\i</span>z~+hill
Reading <span class="m">2</span>.390625MB ...
<span class="o">[</span>0x1006b8000<span class="o">]</span>&gt; <span class="se">\i</span>z~+pass
Reading <span class="m">2</span>.390625MB ...
0x00000001006b93ed  <span class="s2">&quot;passwordTextField&quot;</span>
0x00000001006bb11a  <span class="s2">&quot;11iGoat_Swift20KeychainPasswordItemV0C5ErrorO&quot;</span>
0x00000001006bb164  <span class="s2">&quot;unexpectedPasswordData&quot;</span>
0x00000001006d3f62  <span class="s2">&quot;Error reading password from keychain - &quot;</span>
0x00000001006d40f2  <span class="s2">&quot;Incorrect Password&quot;</span>
0x00000001006d4112  <span class="s2">&quot;Enter the correct password&quot;</span>
0x00000001006d4632  <span class="s2">&quot;T@&quot;</span>UITextField<span class="s2">&quot;,N,W,VpasswordField&quot;</span>
0x00000001006d46f2  <span class="s2">&quot;CREATE TABLE IF NOT EXISTS creds (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, password TEXT);&quot;</span>
0x00000001006d4792  <span class="s2">&quot;INSERT INTO creds(username, password) VALUES(?, ?)&quot;</span>
</code></pre></div>
<p>To learn more, please refer to the <a href="https://github.com/enovella/r2frida-wiki/blob/master/README.md" title="r2frida Wiki">r2frida wiki</a>.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Apple's Entitlements Troubleshooting - <a href="https://developer.apple.com/library/content/technotes/tn2415/_index.html">https://developer.apple.com/library/content/technotes/tn2415/_index.html</a></li>
<li>Apple's Code Signing - <a href="https://developer.apple.com/support/code-signing/">https://developer.apple.com/support/code-signing/</a></li>
<li>Cycript Manual - <a href="http://www.cycript.org/manual/">http://www.cycript.org/manual/</a></li>
<li>iOS Instrumentation without Jailbreak - <a href="https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/">https://www.nccgroup.trust/au/about-us/newsroom-and-events/blogs/2016/october/ios-instrumentation-without-jailbreak/</a></li>
<li>Frida iOS Tutorial - <a href="https://www.frida.re/docs/ios/">https://www.frida.re/docs/ios/</a></li>
<li>Frida iOS Examples - <a href="https://www.frida.re/docs/examples/ios/">https://www.frida.re/docs/examples/ios/</a></li>
<li>r2frida Wiki - <a href="https://github.com/enovella/r2frida-wiki/blob/master/README.md">https://github.com/enovella/r2frida-wiki/blob/master/README.md</a></li>
<li>[#miller] - Charlie Miller, Dino Dai Zovi. The iOS Hacker's Handbook. Wiley, 2012 - <a href="https://www.wiley.com/en-us/iOS+Hacker%27s+Handbook-p-9781118204122">https://www.wiley.com/en-us/iOS+Hacker%27s+Handbook-p-9781118204122</a></li>
<li>[#levin] Jonathan Levin. Mac OS X and iOS Internals: To the Apple's Core. Wiley, 2013 - <a href="http://newosxbook.com/MOXiI.pdf">http://newosxbook.com/MOXiI.pdf</a></li>
</ul>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0x06b-Basic-Security-Testing/" class="md-footer__link md-footer__link--prev" aria-label="Previous: iOS Basic Security Testing" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              iOS Basic Security Testing
            </div>
          </div>
        </a>
      
      
        
        <a href="../0x06d-Testing-Data-Storage/" class="md-footer__link md-footer__link--next" aria-label="Next: iOS Data Storage" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              iOS Data Storage
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="float: left; padding-right: 1em;">
  <a href="https://www.owasp.org"><img src="https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/OWASP_logo_white.png?raw=true" width="100px" /></a>
</div>
<span>
  &#169; OWASP Foundation 2022. This work is licensed under 
  <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>. For any reuse or distribution, you must make clear to others the license terms of this work.
</span>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://owasp.slack.com/messages/project-mobile_omtg/details/" target="_blank" rel="noopener" title="owasp.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/OWASP_MSTG" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/OWASP/owasp-mstg/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>