
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo_circle.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Android Cryptographic APIs - OWASP Mobile Security Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#android-cryptographic-apis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OWASP Mobile Security Project" class="md-header__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Mobile Security Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Android Cryptographic APIs
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../donate/" class="md-tabs__link">
      ♡ Donations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../news/" class="md-tabs__link">
      News
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0x01-Foreword/" class="md-tabs__link md-tabs__link--active">
        MSTG
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Mobile Security Project" class="md-nav__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    OWASP Mobile Security Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../donate/" class="md-nav__link">
        ♡ Donations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        News
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          MSTG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSTG" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          MSTG
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x01-Foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02a-Frontispiece/" class="md-nav__link">
        Frontispiece
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02b-MASVS-MSTG-Adoption/" class="md-nav__link">
        OWASP MASVS and MSTG Adoption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02c-Acknowledgements/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x03-Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04a-Mobile-App-Taxonomy/" class="md-nav__link">
        Mobile App Taxonomy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04b-Mobile-App-Security-Testing/" class="md-nav__link">
        Mobile App Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04c-Tampering-and-Reverse-Engineering/" class="md-nav__link">
        Mobile App Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04e-Testing-Authentication-and-Session-Management/" class="md-nav__link">
        Mobile App Authentication Architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04f-Testing-Network-Communication/" class="md-nav__link">
        Mobile App Network Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04g-Testing-Cryptography/" class="md-nav__link">
        Mobile App Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04h-Testing-Code-Quality/" class="md-nav__link">
        Mobile App Code Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04i-Testing-User-Privacy-Protection/" class="md-nav__link">
        Mobile App User Privacy Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05a-Platform-Overview/" class="md-nav__link">
        Android Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05b-Basic-Security_Testing/" class="md-nav__link">
        Android Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        Android Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05d-Testing-Data-Storage/" class="md-nav__link">
        Android Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Android Cryptographic APIs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Android Cryptographic APIs
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    Recommendations
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-provider" class="md-nav__link">
    Security provider
  </a>
  
    <nav class="md-nav" aria-label="Security provider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-security-provider" class="md-nav__link">
    Updating security provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#older-android-versions" class="md-nav__link">
    Older Android versions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-generation" class="md-nav__link">
    Key Generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-number-generation" class="md-nav__link">
    Random number generation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-symmetric-cryptography-mstg-crypto-1" class="md-nav__link">
    Testing Symmetric Cryptography (MSTG-CRYPTO-1)
  </a>
  
    <nav class="md-nav" aria-label="Testing Symmetric Cryptography (MSTG-CRYPTO-1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-configuration-of-cryptographic-standard-algorithms-mstg-crypto-2-mstg-crypto-3-and-mstg-crypto-4" class="md-nav__link">
    Testing the Configuration of Cryptographic Standard Algorithms (MSTG-CRYPTO-2, MSTG-CRYPTO-3 and MSTG-CRYPTO-4)
  </a>
  
    <nav class="md-nav" aria-label="Testing the Configuration of Cryptographic Standard Algorithms (MSTG-CRYPTO-2, MSTG-CRYPTO-3 and MSTG-CRYPTO-4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_1" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_1" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-purposes-of-keys-mstg-crypto-5" class="md-nav__link">
    Testing the Purposes of Keys (MSTG-CRYPTO-5)
  </a>
  
    <nav class="md-nav" aria-label="Testing the Purposes of Keys (MSTG-CRYPTO-5)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_2" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_2" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_2" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-random-number-generation-mstg-crypto-6" class="md-nav__link">
    Testing Random Number Generation (MSTG-CRYPTO-6)
  </a>
  
    <nav class="md-nav" aria-label="Testing Random Number Generation (MSTG-CRYPTO-6)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_3" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis_3" class="md-nav__link">
    Static Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis_3" class="md-nav__link">
    Dynamic Analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cryptography-references" class="md-nav__link">
    Cryptography references
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securerandom-references" class="md-nav__link">
    SecureRandom references
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-key-management-references" class="md-nav__link">
    Testing Key Management references
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-attestation-references" class="md-nav__link">
    Key Attestation References
  </a>
  
    <nav class="md-nav" aria-label="Key Attestation References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#owasp-masvs" class="md-nav__link">
    OWASP MASVS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05f-Testing-Local-Authentication/" class="md-nav__link">
        Android Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05g-Testing-Network-Communication/" class="md-nav__link">
        Android Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05h-Testing-Platform-Interaction/" class="md-nav__link">
        Android Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        Android Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        Android Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06a-Platform-Overview/" class="md-nav__link">
        iOS Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06b-Basic-Security-Testing/" class="md-nav__link">
        iOS Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        iOS Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06d-Testing-Data-Storage/" class="md-nav__link">
        iOS Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06e-Testing-Cryptography/" class="md-nav__link">
        iOS Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06f-Testing-Local-Authentication/" class="md-nav__link">
        iOS Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06g-Testing-Network-Communication/" class="md-nav__link">
        iOS Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06h-Testing-Platform-Interaction/" class="md-nav__link">
        iOS Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        iOS Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        iOS Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x07-Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x08-Testing-Tools/" class="md-nav__link">
        Testing Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x09-Suggested-Reading/" class="md-nav__link">
        Suggested Reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-nav__link">
        How Can You Contribute?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/2_Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/3_PRs_and_Reviews/" class="md-nav__link">
        Pull Requests & Reviews
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/4_Add_new_Language/" class="md-nav__link">
        Add a New Language
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/5_Style_Guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/OWASP/owasp-mstg/edit/master/docs/MSTG/0x05e-Testing-Cryptography.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="android-cryptographic-apis">Android Cryptographic APIs<a class="headerlink" href="#android-cryptographic-apis" title="Permanent link">&para;</a></h1>
<p>In the chapter <a href="../0x04g-Testing-Cryptography/">"Mobile App Cryptography"</a>, we introduced general cryptography best practices and described typical issues that can occur when cryptography is used incorrectly. In this chapter, we'll go into more detail on Android's cryptography APIs. We'll show how to identify usage of those APIs in the source code and how to interpret cryptographic configurations. When reviewing code, make sure to compare the cryptographic parameters used with the current best practices linked from this guide.</p>
<p>We can identify key components of cryptography system in Android:</p>
<ul>
<li><a href="./#security-provider">Security Provider</a></li>
<li>KeyStore - see the section <a href="../0x05d-Testing-Data-Storage/#keystore">KeyStore</a> in the chapter "Testing Data Storage"</li>
<li>KeyChain - see the section <a href="../0x05d-Testing-Data-Storage/#keychain">KeyChain</a> in the chapter "Testing Data Storage"</li>
</ul>
<p>Android cryptography APIs are based on the Java Cryptography Architecture (JCA). JCA separates the interfaces and implementation, making it possible to include several <a href="https://developer.android.com/reference/java/security/Provider.html" title="Android Security Providers">security providers</a> that can implement sets of cryptographic algorithms. Most of the JCA interfaces and classes are defined in the <code>java.security.*</code> and <code>javax.crypto.*</code> packages. In addition, there are Android specific packages <code>android.security.*</code> and <code>android.security.keystore.*</code>.</p>
<p>KeyStore and KeyChain provide APIs for storing and using keys (behind the scene, KeyChain API uses KeyStore system). These systems allow to administer the full lifecycle of the cryptographic keys. Requirements and guidance for implementation of cryptographic key management can be found in <a href="https://cheatsheetseries.owasp.org/cheatsheets/Key_Management_Cheat_Sheet.html" title="Key Management Cheat Sheet">Key Management Cheat Sheet</a>. We can identify following phases:</p>
<ul>
<li>generating a key</li>
<li>using a key</li>
<li>storing a key</li>
<li>archiving a key</li>
<li>deleting a key</li>
</ul>
<blockquote>
<p>Please note that storing of a key is analyzed in the chapter "<a href="../0x05d-Testing-Data-Storage/">Testing Data Storage</a>".</p>
</blockquote>
<p>These phases are managed by the Keystore/KeyChain system. However how the system works depends on how the application developer implemented it. For the analysis process you should focus on functions which are used by the application developer. You should identify and verify the following functions:</p>
<ul>
<li><a href="./#key-generation">Key generation</a></li>
<li><a href="./#random-number-generation">Random number generation</a></li>
<li>Key rotation</li>
</ul>
<p>Apps that target modern API levels, went through the following changes:</p>
<ul>
<li>For Android 7.0 (API level 24) and above <a href="https://android-developers.googleblog.com/2016/06/security-crypto-provider-deprecated-in.html" title="Security provider Crypto deprecated in Andorid N">the Android Developer blog shows that</a>:</li>
<li>It is recommended to stop specifying a security provider. Instead, always use a <a href="./#updating-provider">patched security provider</a>.</li>
<li>The support for the <code>Crypto</code> provider has dropped and the provider is deprecated. The same applies to its <code>SHA1PRNG</code> for secure random.</li>
<li>For Android 8.1 (API level 27) and above the <a href="https://developer.android.com/about/versions/oreo/android-8.1" title="Cryptography updates">Developer Documentation</a> shows that:</li>
<li>Conscrypt, known as <code>AndroidOpenSSL</code>, is preferred above using Bouncy Castle and it has new implementations: <code>AlgorithmParameters:GCM</code> , <code>KeyGenerator:AES</code>, <code>KeyGenerator:DESEDE</code>, <code>KeyGenerator:HMACMD5</code>, <code>KeyGenerator:HMACSHA1</code>, <code>KeyGenerator:HMACSHA224</code>, <code>KeyGenerator:HMACSHA256</code>, <code>KeyGenerator:HMACSHA384</code>, <code>KeyGenerator:HMACSHA512</code>, <code>SecretKeyFactory:DESEDE</code>, and <code>Signature:NONEWITHECDSA</code>.</li>
<li>You should not use the <code>IvParameterSpec.class</code> anymore for GCM, but use the <code>GCMParameterSpec.class</code> instead.</li>
<li>Sockets have changed from <code>OpenSSLSocketImpl</code> to <code>ConscryptFileDescriptorSocket</code>, and <code>ConscryptEngineSocket</code>.</li>
<li><code>SSLSession</code> with null parameters give a <code>NullPointerException</code>.</li>
<li>You need to have large enough arrays as input bytes for generating a key otherwise, an <code>InvalidKeySpecException</code> is thrown.</li>
<li>If a Socket read is interrupted, you get a <code>SocketException</code>.</li>
<li>For Android 9 (API level 28) and above the <a href="https://android-developers.googleblog.com/2018/03/cryptography-changes-in-android-p.html" title="Cryptography Changes in Android P">Android Developer Blog</a> shows even more changes:</li>
<li>You get a warning if you still specify a security provider using the <code>getInstance</code> method and you target any API below 28. If you target Android 9 (API level 28) or above, you get an error.</li>
<li>The <code>Crypto</code> security provider is now removed. Calling it will result in a <code>NoSuchProviderException</code>.</li>
<li>For Android 10 (API level 29) the <a href="https://developer.android.com/about/versions/10/behavior-changes-all#security" title="Security Changes in Android 10">Developer Documentation</a> lists all network security changes.</li>
</ul>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h2>
<p>The following list of recommendations should be considered during app examination:</p>
<ul>
<li>You should ensure that the best practices outlined in the "<a href="../0x04g-Testing-Cryptography/">Cryptography for Mobile Apps</a>" chapter are followed.</li>
<li>You should ensure that security provider has the latest updates - <a href="https://developer.android.com/training/articles/security-gms-provider" title="Updating security provider">Updating security provider</a>.</li>
<li>You should stop specifying a security provider and use the default implementation (AndroidOpenSSL, Conscrypt).</li>
<li>You should stop using Crypto security provider and its <code>SHA1PRNG</code> as they are deprecated.</li>
<li>You should specify a security provider only for the Android Keystore system.</li>
<li>You should stop using Password-based encryption ciphers without IV.</li>
<li>You should use KeyGenParameterSpec instead of KeyPairGeneratorSpec.</li>
</ul>
<h3 id="security-provider">Security provider<a class="headerlink" href="#security-provider" title="Permanent link">&para;</a></h3>
<p>Android relies on <code>provider</code> to implement Java Security services. That is crucial to ensure secure network communications and secure other functionalities which depend on cryptography.  </p>
<p>The list of security providers included in Android varies between versions of Android and the OEM-specific builds. Some security provider implementations in older versions are now known to be less secure or vulnerable. Thus, Android applications should not only choose the correct algorithms and provide good configuration, in some cases they should also pay attention to the strength of the implementations in the legacy security providers.</p>
<p>You can list the set of existing security providers using following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">StringBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Provider</span><span class="w"> </span><span class="n">provider</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Security</span><span class="p">.</span><span class="na">getProviders</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">builder</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;provider: &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">provider</span><span class="p">.</span><span class="na">getName</span><span class="p">())</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">provider</span><span class="p">.</span><span class="na">getVersion</span><span class="p">())</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">provider</span><span class="p">.</span><span class="na">getInfo</span><span class="p">())</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;)\n&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">String</span><span class="w"> </span><span class="n">providers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span><span class="w"></span>
<span class="c1">//now display the string on the screen or in the logs for debugging.</span><span class="w"></span>
</code></pre></div>
<p>Below you can find the output of a running Android 4.4 (API level 19) in an emulator with Google Play APIs, after the security provider has been patched:</p>
<div class="highlight"><pre><span></span><code>provider: GmsCore_OpenSSL1.0 (Android&#39;s OpenSSL-backed security provider)
provider: AndroidOpenSSL1.0 (Android&#39;s OpenSSL-backed security provider)
provider: DRLCertFactory1.0 (ASN.1, DER, PkiPath, PKCS7)
provider: BC1.49 (BouncyCastle Security Provider v1.49)
provider: Crypto1.0 (HARMONY (SHA1 digest; SecureRandom; SHA1withDSA signature))
provider: HarmonyJSSE1.0 (Harmony JSSE Provider)
provider: AndroidKeyStore1.0 (Android AndroidKeyStore security provider)
</code></pre></div>
<p>Below you can find the output of a running Android 9 (API level 28) in an emulator with Google Play APIs:</p>
<div class="highlight"><pre><span></span><code>provider: AndroidNSSP 1.0(Android Network Security Policy Provider)
provider: AndroidOpenSSL 1.0(Android&#39;s OpenSSL-backed security provider)
provider: CertPathProvider 1.0(Provider of CertPathBuilder and CertPathVerifier)
provider: AndroidKeyStoreBCWorkaround 1.0(Android KeyStore security provider to work around Bouncy Castle)
provider: BC 1.57(BouncyCastle Security Provider v1.57)
provider: HarmonyJSSE 1.0(Harmony JSSE Provider)
provider: AndroidKeyStore 1.0(Android KeyStore security provider)
</code></pre></div>
<h4 id="updating-security-provider">Updating security provider<a class="headerlink" href="#updating-security-provider" title="Permanent link">&para;</a></h4>
<p>Keeping up-to-date and patched component is one of security principles. The same applies to <code>provider</code>. Application should check if used security provider is up-to-date and if not, <a href="https://developer.android.com/training/articles/security-gms-provider" title="Updating security provider">update it</a>. It is related to <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/#checking-for-weaknesses-in-third-party-libraries">Checking for Weaknesses in Third Party Libraries (MSTG-CODE-5)</a>.</p>
<h4 id="older-android-versions">Older Android versions<a class="headerlink" href="#older-android-versions" title="Permanent link">&para;</a></h4>
<p>For some applications that support older versions of Android (e.g.: only used versions lower than Android 7.0 (API level 24)), bundling an up-to-date library may be the only option. Spongy Castle (a repackaged version of Bouncy Castle) is a common choice in these situations. Repackaging is necessary because Bouncy Castle is included in the Android SDK. The latest version of <a href="https://rtyley.github.io/spongycastle/" title="Spongy Castle">Spongy Castle</a> likely fixes issues encountered in the earlier versions of <a href="https://www.cvedetails.com/vulnerability-list/vendor_id-7637/Bouncycastle.html" title="CVE Details Bouncy Castle">Bouncy Castle</a> that were included in Android. Note that the Bouncy Castle libraries packed with Android are often not as complete as their counterparts from the <a href="https://www.bouncycastle.org/java.html" title="Bouncy Castle in Java">legion of the Bouncy Castle</a>. Lastly: bear in mind that packing large libraries such as Spongy Castle will often lead to a multidexed Android application.</p>
<h3 id="key-generation">Key Generation<a class="headerlink" href="#key-generation" title="Permanent link">&para;</a></h3>
<p>Android SDK provides mechanisms for specifying secure key generation and use. Android 6.0 (API level 23) introduced the <code>KeyGenParameterSpec</code> class that can be used to ensure the correct key usage in the application.</p>
<p>Here's an example of using AES/CBC/PKCS7Padding on API 23+:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">keyAlias</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MySecretKey&quot;</span><span class="p">;</span><span class="w"></span>

<span class="n">KeyGenParameterSpec</span><span class="w"> </span><span class="n">keyGenParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">KeyGenParameterSpec</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="n">keyAlias</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">PURPOSE_ENCRYPT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">PURPOSE_DECRYPT</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setBlockModes</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">BLOCK_MODE_CBC</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setEncryptionPaddings</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">ENCRYPTION_PADDING_PKCS7</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setRandomizedEncryptionRequired</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w"></span>

<span class="n">KeyGenerator</span><span class="w"> </span><span class="n">keyGenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyGenerator</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">KEY_ALGORITHM_AES</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;AndroidKeyStore&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">keyGenerator</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">keyGenParameterSpec</span><span class="p">);</span><span class="w"></span>

<span class="n">SecretKey</span><span class="w"> </span><span class="n">secretKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyGenerator</span><span class="p">.</span><span class="na">generateKey</span><span class="p">();</span><span class="w"></span>
</code></pre></div>
<p>The <code>KeyGenParameterSpec</code> indicates that the key can be used for encryption and decryption, but not for other purposes, such as signing or verifying. It further specifies the block mode (CBC), padding (PKCS #7), and explicitly specifies that randomized encryption is required (this is the default). <code>"AndroidKeyStore"</code> is the name of security provider used in this example. This will automatically ensure that the keys are stored in the <code>AndroidKeyStore</code> which is beneficiary for the protection of the key.</p>
<p>GCM is another AES block mode that provides additional security benefits over other, older modes. In addition to being cryptographically more secure, it also provides authentication. When using CBC (and other modes), authentication would need to be performed separately, using HMACs (see the "<a href="../0x05c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on Android</a>" chapter). Note that GCM is the only mode of AES that <a href="https://developer.android.com/training/articles/keystore.html#SupportedCiphers" title="Supported Ciphers in AndroidKeyStore">does not support paddings</a>.</p>
<p>Attempting to use the generated key in violation of the above spec would result in a security exception.</p>
<p>Here's an example of using that key to encrypt:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="n">AES_MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">KEY_ALGORITHM_AES</span><span class="w"></span>
<span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">BLOCK_MODE_CBC</span><span class="w"></span>
<span class="w">        </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">KeyProperties</span><span class="p">.</span><span class="na">ENCRYPTION_PADDING_PKCS7</span><span class="p">;</span><span class="w"></span>
<span class="n">KeyStore</span><span class="w"> </span><span class="n">AndroidKeyStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AndroidKeyStore</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;AndroidKeyStore&quot;</span><span class="p">);</span><span class="w"></span>

<span class="c1">// byte[] input</span><span class="w"></span>
<span class="n">Key</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AndroidKeyStore</span><span class="p">.</span><span class="na">getKey</span><span class="p">(</span><span class="n">keyAlias</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w"></span>

<span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">AES_MODE</span><span class="p">);</span><span class="w"></span>
<span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">ENCRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w"></span>

<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">encryptedBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">iv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">getIV</span><span class="p">();</span><span class="w"></span>
<span class="c1">// save both the IV and the encryptedBytes</span><span class="w"></span>
</code></pre></div>
<p>Both the IV (initialization vector) and the encrypted bytes need to be stored; otherwise decryption is not possible.</p>
<p>Here's how that cipher text would be decrypted. The <code>input</code> is the encrypted byte array and <code>iv</code> is the initialization vector from the encryption step:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// byte[] input</span><span class="w"></span>
<span class="c1">// byte[] iv</span><span class="w"></span>
<span class="n">Key</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AndroidKeyStore</span><span class="p">.</span><span class="na">getKey</span><span class="p">(</span><span class="n">AES_KEY_ALIAS</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span><span class="w"></span>

<span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">AES_MODE</span><span class="p">);</span><span class="w"></span>
<span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">iv</span><span class="p">);</span><span class="w"></span>
<span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">Cipher</span><span class="p">.</span><span class="na">DECRYPT_MODE</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">);</span><span class="w"></span>

<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>Since the IV is randomly generated each time, it should be saved along with the cipher text (<code>encryptedBytes</code>) in order to decrypt it later.</p>
<p>Prior to Android 6.0 (API level 23), AES key generation was not supported. As a result, many implementations chose to use RSA and generated a public-private key pair for asymmetric encryption using <code>KeyPairGeneratorSpec</code> or used <code>SecureRandom</code> to generate AES keys.</p>
<p>Here's an example of <code>KeyPairGenerator</code> and <code>KeyPairGeneratorSpec</code> used to create the RSA key pair:</p>
<div class="highlight"><pre><span></span><code><span class="n">Date</span><span class="w"> </span><span class="n">startDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calendar</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">getTime</span><span class="p">();</span><span class="w"></span>
<span class="n">Calendar</span><span class="w"> </span><span class="n">endCalendar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calendar</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span><span class="w"></span>
<span class="n">endCalendar</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">YEAR</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="n">Date</span><span class="w"> </span><span class="n">endDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">endCalendar</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span><span class="w"></span>
<span class="n">KeyPairGeneratorSpec</span><span class="w"> </span><span class="n">keyPairGeneratorSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">KeyPairGeneratorSpec</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setAlias</span><span class="p">(</span><span class="n">RSA_KEY_ALIAS</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setKeySize</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setSubject</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">X500Principal</span><span class="p">(</span><span class="s">&quot;CN=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">RSA_KEY_ALIAS</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setSerialNumber</span><span class="p">(</span><span class="n">BigInteger</span><span class="p">.</span><span class="na">ONE</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setStartDate</span><span class="p">(</span><span class="n">startDate</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">setEndDate</span><span class="p">(</span><span class="n">endDate</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w"></span>

<span class="n">KeyPairGenerator</span><span class="w"> </span><span class="n">keyPairGenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyPairGenerator</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;RSA&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;AndroidKeyStore&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">keyPairGenerator</span><span class="p">.</span><span class="na">initialize</span><span class="p">(</span><span class="n">keyPairGeneratorSpec</span><span class="p">);</span><span class="w"></span>

<span class="n">KeyPair</span><span class="w"> </span><span class="n">keyPair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyPairGenerator</span><span class="p">.</span><span class="na">generateKeyPair</span><span class="p">();</span><span class="w"></span>
</code></pre></div>
<p>This sample creates the RSA key pair with a key size of 4096-bit (i.e. modulus size). Elliptic Curve (EC) keys can also be generated in a similar way. However as of Android 11, <a href="https://developer.android.com/guide/topics/security/cryptography#SupportedCipher">AndroidKeyStore does not support encryption or decryption with EC keys</a>. They can only be used for signatures.</p>
<p>A symmetric encryption key can be generated from the passphrase by using the Password Based Key Derivation Function version 2 (PBKDF2). This cryptographic protocol is designed to generate cryptographic keys, which can be used for cryptography purpose. Input parameters for the algorithm are adjusted according to <a href="../0x04g-Testing-Cryptography/#weak-key-generation-functions">weak key generation function</a> section. The code listing below illustrates how to generate a strong encryption key based on a password.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">SecretKey</span><span class="w"> </span><span class="nf">generateStrongAESKey</span><span class="p">(</span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">keyLength</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//Initialize objects and variables for later use</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">iterationCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">saltLength</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">keyLength</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SecureRandom</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="c1">//Generate the salt</span><span class="w"></span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">salt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">saltLength</span><span class="o">]</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">random</span><span class="p">.</span><span class="na">nextBytes</span><span class="p">(</span><span class="n">salt</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">KeySpec</span><span class="w"> </span><span class="n">keySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PBEKeySpec</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="na">toCharArray</span><span class="p">(),</span><span class="w"> </span><span class="n">salt</span><span class="p">,</span><span class="w"> </span><span class="n">iterationCount</span><span class="p">,</span><span class="w"> </span><span class="n">keyLength</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">SecretKeyFactory</span><span class="w"> </span><span class="n">keyFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecretKeyFactory</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;PBKDF2WithHmacSHA1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">keyBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyFactory</span><span class="p">.</span><span class="na">generateSecret</span><span class="p">(</span><span class="n">keySpec</span><span class="p">).</span><span class="na">getEncoded</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">keyBytes</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AES&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The above method requires a character array containing the password and the needed key length in bits, for instance a 128 or 256-bit AES key. We define an iteration count of 10,000 rounds which will be used by the PBKDF2 algorithm. Increasing number of iteration significantly increases the workload for a brute-force attack on password, however it can affect performance as more computational power is required for key derivation. We define the salt size equal to the key length, we divide by 8 to take care of the bit to byte conversion. We use the <code>SecureRandom</code> class to randomly generate a salt. Obviously, the salt is something you want to keep constant to ensure the same encryption key is generated time after time for the same supplied password. Note that you can store the salt privately in <code>SharedPreferences</code>. It is recommended to exclude the salt from the Android backup mechanism to prevent synchronization in case of higher risk data.</p>
<blockquote>
<p>Note that if you take a rooted device or a patched (e.g. repackaged) application into account as a threat to the data, it might be better to encrypt the salt with a key that is placed in the <code>AndroidKeystore</code>. The Password-Based Encryption (PBE) key is generated using the recommended <code>PBKDF2WithHmacSHA1</code> algorithm, till Android 8.0 (API level 26). For higher API levels, it is best to use <code>PBKDF2withHmacSHA256</code>, which will end up with a longer hash value.</p>
</blockquote>
<p>Note: there is a widespread false believe that the NDK should be used to hide cryptographic operations and hardcoded keys. However, using this mechanism is not effective. Attackers can still use tools to find the mechanism used and make dumps of the key in memory. Next, the control flow can be analyzed with e.g. radare2 and the keys extracted with the help of Frida or the combination of both: <a href="../0x08-Testing-Tools/#r2frida">r2frida</a> (see sections "<a href="../0x05c-Reverse-Engineering-and-Tampering/#disassembling-native-code" title="Disassembling Native Code">Disassembling Native Code</a>", "<a href="../0x05c-Reverse-Engineering-and-Tampering/#memory-dump" title="Memory Dump">Memory Dump</a>" and "<a href="../0x05c-Reverse-Engineering-and-Tampering/#in-memory-search" title="In-Memory Search">In-Memory Search</a>" in the chapter "Tampering and Reverse Engineering on Android" for more details). From Android 7.0 (API level 24) onward, it is not allowed to use private APIs, instead: public APIs need to be called, which further impacts the effectiveness of hiding it away as described in the <a href="https://android-developers.googleblog.com/2016/06/android-changes-for-ndk-developers.html" title="Android changes for NDK developers">Android Developers Blog</a></p>
<h3 id="random-number-generation">Random number generation<a class="headerlink" href="#random-number-generation" title="Permanent link">&para;</a></h3>
<p>Cryptography requires secure pseudo random number generation (PRNG). Standard Java classes as <code>java.util.Random</code> do not provide sufficient randomness and in fact may make it possible for an attacker to guess the next value that will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>In general, <code>SecureRandom</code> should be used. However, if the Android versions below Android 4.4 (API level 19) are supported, additional care needs to be taken in order to work around the bug in Android 4.1-4.3 (API level 16-18) versions that <a href="https://android-developers.googleblog.com/2013/08/some-securerandom-thoughts.html" title="Some SecureRandom Thoughts">failed to properly initialize the PRNG</a>.</p>
<p>Most developers should instantiate <code>SecureRandom</code> via the default constructor without any arguments. Other constructors are for more advanced uses and, if used incorrectly, can lead to decreased randomness and security. The PRNG provider backing <code>SecureRandom</code> uses the <code>SHA1PRNG</code> from <code>AndroidOpenSSL</code> (Conscrypt) provider.</p>
<h2 id="testing-symmetric-cryptography-mstg-crypto-1">Testing Symmetric Cryptography (MSTG-CRYPTO-1)<a class="headerlink" href="#testing-symmetric-cryptography-mstg-crypto-1" title="Permanent link">&para;</a></h2>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h3>
<p>This test case focuses on hardcoded symmetric cryptography as the only method of encryption. The following checks should be performed:</p>
<ul>
<li>identify all instances of symmetric cryptography</li>
<li>for each identified instance verify if there are any hardcoded symmetric keys</li>
<li>verify if hardcoded symmetric cryptography is not used as the only method of encryption</li>
</ul>
<h3 id="static-analysis">Static Analysis<a class="headerlink" href="#static-analysis" title="Permanent link">&para;</a></h3>
<p>Identify all the instances of symmetric key encryption in code and look for any mechanism which loads or provides a symmetric key. You can look for:</p>
<ul>
<li>symmetric algorithms (such as <code>DES</code>, <code>AES</code>, etc.)</li>
<li>specifications for a key generator (such as <code>KeyGenParameterSpec</code>, <code>KeyPairGeneratorSpec</code>, <code>KeyPairGenerator</code>, <code>KeyGenerator</code>, <code>KeyProperties</code>, etc.)</li>
<li>classes importing <code>java.security.*</code>, <code>javax.crypto.*</code>, <code>android.security.*</code>, <code>android.security.keystore.*</code></li>
</ul>
<p>For each identified instance verify if the used symmetric keys:</p>
<ul>
<li>are not part of the application resources</li>
<li>cannot be derived from known values</li>
<li>are not hardcoded in code</li>
</ul>
<p>For each hardcoded symmetric key, verify that is not used in security-sensitive contexts as the only method of encryption.</p>
<p>As an example we illustrate how to locate the use of a hardcoded encryption key. First <a href="../0x05c-Reverse-Engineering-and-Tampering/#disassembling-and-decompiling">disassemble and decompile</a> the app to obtain Java code, e.g. by using <a href="../0x08-Testing-Tools/#jadx">jadx</a>.</p>
<p>Now search the files for the usage of the <code>SecretKeySpec</code> class, e.g. by simply recursively grepping on them or using jadx search function:</p>
<div class="highlight"><pre><span></span><code>$ grep -r <span class="s2">&quot;SecretKeySpec&quot;</span>
</code></pre></div>
<p>This will return all classes using the <code>SecretKeySpec</code> class. Now examine those files and trace which variables are used to pass the key material. The figure below shows the result of performing this assessment on a production ready application. We can clearly locate the use of a static encryption key that is hardcoded and initialized in the static byte array <code>Encrypt.keyBytes</code>.</p>
<p><img src="../../assets/Images/Chapters/0x5e/static_encryption_key.png" width="600px"/></p>
<h3 id="dynamic-analysis">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis" title="Permanent link">&para;</a></h3>
<p>You can use <a href="../0x05c-Reverse-Engineering-and-Tampering/#method-tracing">method tracing</a> on cryptographic methods to determine input / output values such as the keys that are being used. Monitor file system access while cryptographic operations are being performed to assess where key material is written to or read from. For example, monitor the file system by using the <a href="https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security#8-api-monitor---android-only">API monitor</a> of <a href="../0x08-Testing-Tools/#RMS-Runtime-Mobile-Security">RMS - Runtime Mobile Security</a>.</p>
<h2 id="testing-the-configuration-of-cryptographic-standard-algorithms-mstg-crypto-2-mstg-crypto-3-and-mstg-crypto-4">Testing the Configuration of Cryptographic Standard Algorithms (MSTG-CRYPTO-2, MSTG-CRYPTO-3 and MSTG-CRYPTO-4)<a class="headerlink" href="#testing-the-configuration-of-cryptographic-standard-algorithms-mstg-crypto-2-mstg-crypto-3-and-mstg-crypto-4" title="Permanent link">&para;</a></h2>
<h3 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h3>
<p>These test cases focus on implementation and use of cryptographic primitives. Following checks should be performed:</p>
<ul>
<li>identify all instance of cryptography primitives and their implementation (library or custom implementation)</li>
<li>verify how cryptography primitives are used and how they are configured</li>
<li>verify if cryptographic protocols and algorithms used are not deprecated for security purposes.</li>
</ul>
<h3 id="static-analysis_1">Static Analysis<a class="headerlink" href="#static-analysis_1" title="Permanent link">&para;</a></h3>
<p>Identify all the instances of the cryptographic primitives in code. Identify all custom cryptography implementations. You can look for:</p>
<ul>
<li>classes <code>Cipher</code>, <code>Mac</code>, <code>MessageDigest</code>, <code>Signature</code></li>
<li>interfaces <code>Key</code>, <code>PrivateKey</code>, <code>PublicKey</code>, <code>SecretKey</code></li>
<li>functions <code>getInstance</code>, <code>generateKey</code></li>
<li>exceptions <code>KeyStoreException</code>, <code>CertificateException</code>, <code>NoSuchAlgorithmException</code></li>
<li>classes which uses <code>java.security.*</code>, <code>javax.crypto.*</code>, <code>android.security.*</code> and <code>android.security.keystore.*</code> packages.</li>
</ul>
<p>Identify that all calls to getInstance use default <code>provider</code> of security services by not specifying it (it means AndroidOpenSSL aka Conscrypt). <code>Provider</code> can only be specified in <code>KeyStore</code> related code (in that situation <code>KeyStore</code> should be provided as <code>provider</code>). If other <code>provider</code> is specified it should be verified according to situation and business case (i.e. Android API version), and <code>provider</code> should be examined against potential vulnerabilities.  </p>
<p>Ensure that the best practices outlined in the "<a href="../0x04g-Testing-Cryptography/">Cryptography for Mobile Apps</a>" chapter are followed. Look at <a href="../0x04g-Testing-Cryptography/#identifying-insecure-and/or-deprecated-cryptographic-algorithms">insecure and deprecated algorithms</a> and <a href="../0x04g-Testing-Cryptography/#common-configuration-issues">common configuration issues</a>.</p>
<h3 id="dynamic-analysis_1">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_1" title="Permanent link">&para;</a></h3>
<p>You can use <a href="../0x05c-Reverse-Engineering-and-Tampering/#method-tracing">method tracing</a> on cryptographic methods to determine input / output values such as the keys that are being used. Monitor file system access while cryptographic operations are being performed to assess where key material is written to or read from. For example, monitor the file system by using the <a href="https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security#8-api-monitor---android-only">API monitor</a> of <a href="../0x08-Testing-Tools/#RMS-Runtime-Mobile-Security">RMS - Runtime Mobile Security</a>.</p>
<h2 id="testing-the-purposes-of-keys-mstg-crypto-5">Testing the Purposes of Keys (MSTG-CRYPTO-5)<a class="headerlink" href="#testing-the-purposes-of-keys-mstg-crypto-5" title="Permanent link">&para;</a></h2>
<h3 id="overview_2">Overview<a class="headerlink" href="#overview_2" title="Permanent link">&para;</a></h3>
<p>This test case focuses on verification of purpose and reusage of the same cryptographic keys. The following checks should be performed:</p>
<ul>
<li>identify all instances where cryptography is used</li>
<li>identify the purpose of the cryptographic material (to protect data in use, in transit or at rest)</li>
<li>identify type of cryptography</li>
<li>verify if cryptography is used according to its purpose</li>
</ul>
<h3 id="static-analysis_2">Static Analysis<a class="headerlink" href="#static-analysis_2" title="Permanent link">&para;</a></h3>
<p>Identify all instances where cryptography is used. You can look for:</p>
<ul>
<li>classes <code>Cipher</code>, <code>Mac</code>, <code>MessageDigest</code>, <code>Signature</code></li>
<li>interfaces <code>Key</code>, <code>PrivateKey</code>, <code>PublicKey</code>, <code>SecretKey</code></li>
<li>functions <code>getInstance</code>, <code>generateKey</code></li>
<li>exceptions <code>KeyStoreException</code>, <code>CertificateException</code>, <code>NoSuchAlgorithmException</code></li>
<li>classes importing <code>java.security.*</code>, <code>javax.crypto.*</code>, <code>android.security.*</code>, <code>android.security.keystore.*</code></li>
</ul>
<p>For each identified instance, identify its purpose and its type. It can be used:</p>
<ul>
<li>for encryption/decryption - to ensure data confidentiality</li>
<li>for signing/verifying - to ensure integrity of data (as well as accountability in some cases)</li>
<li>for maintenance - to protect keys during certain sensitive operations (such as being imported to the KeyStore)</li>
</ul>
<p>Additionally, you should identify the business logic which uses identified instances of cryptography.</p>
<p>During verification the following checks should be performed:</p>
<ul>
<li>are all keys used according to the purpose defined during its creation? (it is relevant to KeyStore keys, which can have KeyProperties defined)</li>
<li>for asymmetric keys, is the private key being exclusively used for signing and the public key encryption?</li>
<li>are symmetric keys used for multiple purposes? A new symmetric key should be generated if it's used in a different context.</li>
<li>is cryptography used according to its business purpose?</li>
</ul>
<h3 id="dynamic-analysis_2">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_2" title="Permanent link">&para;</a></h3>
<p>You can use <a href="../0x05c-Reverse-Engineering-and-Tampering/#method-tracing">method tracing</a> on cryptographic methods to determine input / output values such as the keys that are being used. Monitor file system access while cryptographic operations are being performed to assess where key material is written to or read from. For example, monitor the file system by using the <a href="https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security#8-api-monitor---android-only">API monitor</a> of <a href="../0x08-Testing-Tools/#RMS-Runtime-Mobile-Security">RMS - Runtime Mobile Security</a>.</p>
<h2 id="testing-random-number-generation-mstg-crypto-6">Testing Random Number Generation (MSTG-CRYPTO-6)<a class="headerlink" href="#testing-random-number-generation-mstg-crypto-6" title="Permanent link">&para;</a></h2>
<h3 id="overview_3">Overview<a class="headerlink" href="#overview_3" title="Permanent link">&para;</a></h3>
<p>This test case focuses on random values used by application. The following checks should be performed:</p>
<ul>
<li>identify all instances where random values are used</li>
<li>verify if random number generators are not considered as being cryptographically secure</li>
<li>verify how random number generators are used</li>
<li>verify randomness of the generated random values</li>
</ul>
<h3 id="static-analysis_3">Static Analysis<a class="headerlink" href="#static-analysis_3" title="Permanent link">&para;</a></h3>
<p>Identify all the instances of random number generators and look for either custom or well-known insecure classes. For instance, <code>java.util.Random</code> produces an identical sequence of numbers for each given seed value; consequently, the sequence of numbers is predictable. Instead a well-vetted algorithm should be chosen that is currently considered to be strong by experts in the field, and a well-tested implementations with adequate length seeds should be used.</p>
<p>Identify all instances of <code>SecureRandom</code> that are not created using the default constructor. Specifying the seed value may reduce randomness. Prefer the <a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers" title="Generation of Strong Random Numbers">no-argument constructor of <code>SecureRandom</code></a> that uses the system-specified seed value to generate a 128-byte-long random number.</p>
<p>In general, if a PRNG is not advertised as being cryptographically secure (e.g. <code>java.util.Random</code>), then it is probably a statistical PRNG and should not be used in security-sensitive contexts.
Pseudo-random number generators <a href="https://www.securecoding.cert.org/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded" title="Proper seeding of SecureRandom">can produce predictable numbers</a> if the generator is known and the seed can be guessed. A 128-bit seed is a good starting point for producing a "random enough" number.</p>
<p>Once an attacker knows what type of weak pseudo-random number generator (PRNG) is used, it can be trivial to write a proof-of-concept to generate the next random value based on previously observed ones, as it was <a href="https://franklinta.com/2014/08/31/predicting-the-next-math-random-in-java/" title="Predicting the next Math.random() in Java">done for Java Random</a>. In case of very weak custom random generators it may be possible to observe the pattern statistically. Although the recommended approach would anyway be to decompile the APK and inspect the algorithm (see Static Analysis).</p>
<p>If you want to test for randomness, you can try to capture a large set of numbers and check with the Burp's <a href="https://portswigger.net/burp/documentation/desktop/tools/sequencer" title="Burp\'s Sequencer">sequencer</a> to see how good the quality of the randomness is.</p>
<h3 id="dynamic-analysis_3">Dynamic Analysis<a class="headerlink" href="#dynamic-analysis_3" title="Permanent link">&para;</a></h3>
<p>You can use <a href="../0x05c-Reverse-Engineering-and-Tampering/#method-tracing">method tracing</a> on the mentioned classes and methods to determine input / output values being used.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>[#nelenkov] - N. Elenkov, Android Security Internals, No Starch Press, 2014, Chapter 5.</li>
</ul>
<h3 id="cryptography-references">Cryptography references<a class="headerlink" href="#cryptography-references" title="Permanent link">&para;</a></h3>
<ul>
<li>Android Developer blog: Changes for NDK Developers - <a href="https://android-developers.googleblog.com/2016/06/android-changes-for-ndk-developers.html">https://android-developers.googleblog.com/2016/06/android-changes-for-ndk-developers.html</a></li>
<li>Android Developer blog: Crypto Provider Deprecated - <a href="https://android-developers.googleblog.com/2016/06/security-crypto-provider-deprecated-in.html">https://android-developers.googleblog.com/2016/06/security-crypto-provider-deprecated-in.html</a></li>
<li>Android Developer blog: Cryptography Changes in Android P - <a href="https://android-developers.googleblog.com/2018/03/cryptography-changes-in-android-p.html">https://android-developers.googleblog.com/2018/03/cryptography-changes-in-android-p.html</a></li>
<li>Android Developer blog: Some SecureRandom Thoughts - <a href="https://android-developers.googleblog.com/2013/08/some-securerandom-thoughts.html">https://android-developers.googleblog.com/2013/08/some-securerandom-thoughts.html</a></li>
<li>Android Developer documentation - <a href="https://developer.android.com/guide">https://developer.android.com/guide</a></li>
<li>BSI Recommendations - <a href="https://www.keylength.com/en/8/">https://www.keylength.com/en/8/</a></li>
<li>Ida Pro - <a href="https://www.hex-rays.com/products/ida/">https://www.hex-rays.com/products/ida/</a></li>
<li>Legion of the Bouncy Castle - <a href="https://www.bouncycastle.org/java.html">https://www.bouncycastle.org/java.html</a></li>
<li>NIST Key Length Recommendations - <a href="https://www.keylength.com/en/4/">https://www.keylength.com/en/4/</a></li>
<li>Security Providers - <a href="https://developer.android.com/reference/java/security/Provider.html">https://developer.android.com/reference/java/security/Provider.html</a></li>
<li>Spongy Castle - <a href="https://rtyley.github.io/spongycastle/">https://rtyley.github.io/spongycastle/</a></li>
</ul>
<h3 id="securerandom-references">SecureRandom references<a class="headerlink" href="#securerandom-references" title="Permanent link">&para;</a></h3>
<ul>
<li>BurpProxy Sequencer - <a href="https://portswigger.net/burp/documentation/desktop/tools/sequencer">https://portswigger.net/burp/documentation/desktop/tools/sequencer</a></li>
<li>Proper Seeding of SecureRandom - <a href="https://www.securecoding.cert.org/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded">https://www.securecoding.cert.org/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded</a></li>
</ul>
<h3 id="testing-key-management-references">Testing Key Management references<a class="headerlink" href="#testing-key-management-references" title="Permanent link">&para;</a></h3>
<ul>
<li>Android Keychain API - <a href="https://developer.android.com/reference/android/security/KeyChain">https://developer.android.com/reference/android/security/KeyChain</a></li>
<li>Android KeyStore API - <a href="https://developer.android.com/reference/java/security/KeyStore.html">https://developer.android.com/reference/java/security/KeyStore.html</a></li>
<li>Android Keystore system - <a href="https://developer.android.com/training/articles/keystore#java">https://developer.android.com/training/articles/keystore#java</a></li>
<li>Android Pie features and APIs - <a href="https://developer.android.com/about/versions/pie/android-9.0#secure-key-import">https://developer.android.com/about/versions/pie/android-9.0#secure-key-import</a></li>
<li>KeyInfo Documentation - <a href="https://developer.android.com/reference/android/security/keystore/KeyInfo">https://developer.android.com/reference/android/security/keystore/KeyInfo</a></li>
<li>SharedPreferences - <a href="https://developer.android.com/reference/android/content/SharedPreferences.html">https://developer.android.com/reference/android/content/SharedPreferences.html</a></li>
</ul>
<h3 id="key-attestation-references">Key Attestation References<a class="headerlink" href="#key-attestation-references" title="Permanent link">&para;</a></h3>
<ul>
<li>Android Key Attestation - <a href="https://developer.android.com/training/articles/security-key-attestation">https://developer.android.com/training/articles/security-key-attestation</a></li>
<li>Attestation and Assertion - <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API/Attestation_and_Assertion">https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API/Attestation_and_Assertion</a></li>
<li>FIDO Alliance TechNotes - <a href="https://fidoalliance.org/fido-technotes-the-truth-about-attestation/">https://fidoalliance.org/fido-technotes-the-truth-about-attestation/</a></li>
<li>FIDO Alliance Whitepaper - <a href="https://fidoalliance.org/wp-content/uploads/Hardware-backed_Keystore_White_Paper_June2018.pdf">https://fidoalliance.org/wp-content/uploads/Hardware-backed_Keystore_White_Paper_June2018.pdf</a></li>
<li>Google Sample Codes - <a href="https://github.com/googlesamples/android-key-attestation/tree/master/server">https://github.com/googlesamples/android-key-attestation/tree/master/server</a></li>
<li>Verifying Android Key Attestation - <a href="https://medium.com/@herrjemand/webauthn-fido2-verifying-android-keystore-attestation-4a8835b33e9d">https://medium.com/@herrjemand/webauthn-fido2-verifying-android-keystore-attestation-4a8835b33e9d</a></li>
<li>W3C Android Key Attestation - <a href="https://www.w3.org/TR/webauthn/#android-key-attestation">https://www.w3.org/TR/webauthn/#android-key-attestation</a></li>
</ul>
<h4 id="owasp-masvs">OWASP MASVS<a class="headerlink" href="#owasp-masvs" title="Permanent link">&para;</a></h4>
<ul>
<li>MSTG-STORAGE-1: "System credential storage facilities need to be used to store sensitive data, such as PII, user credentials or cryptographic keys."</li>
<li>MSTG-CRYPTO-1: "The app does not rely on symmetric cryptography with hardcoded keys as a sole method of encryption."</li>
<li>MSTG-CRYPTO-2: "The app uses proven implementations of cryptographic primitives."</li>
<li>MSTG-CRYPTO-3: "The app uses cryptographic primitives that are appropriate for the particular use-case, configured with parameters that adhere to industry best practices."</li>
<li>MSTG-CRYPTO-4: "The app does not use cryptographic protocols or algorithms that are widely considered deprecated for security purposes."</li>
<li>MSTG-CRYPTO-5: "The app doesn't re-use the same cryptographic key for multiple purposes."</li>
<li>MSTG-CRYPTO-6: "All random values are generated using a sufficiently secure random number generator."</li>
</ul>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0x05d-Testing-Data-Storage/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Android Data Storage" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Android Data Storage
            </div>
          </div>
        </a>
      
      
        
        <a href="../0x05f-Testing-Local-Authentication/" class="md-footer__link md-footer__link--next" aria-label="Next: Android Local Authentication" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Android Local Authentication
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="float: left; padding-right: 1em;">
  <a href="https://www.owasp.org"><img src="https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/OWASP_logo_white.png?raw=true" width="100px" /></a>
</div>
<span>
  &#169; OWASP Foundation 2022. This work is licensed under 
  <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>. For any reuse or distribution, you must make clear to others the license terms of this work.
</span>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://owasp.slack.com/messages/project-mobile_omtg/details/" target="_blank" rel="noopener" title="owasp.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/OWASP_MSTG" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/OWASP/owasp-mstg/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>