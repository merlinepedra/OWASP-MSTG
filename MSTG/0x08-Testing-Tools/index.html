
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/logo_circle.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>Testing Tools - OWASP Mobile Security Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testing-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OWASP Mobile Security Project" class="md-header__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Mobile Security Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testing Tools
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../donate/" class="md-tabs__link">
      ♡ Donations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../news/" class="md-tabs__link">
      News
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0x01-Foreword/" class="md-tabs__link md-tabs__link--active">
        MSTG
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OWASP Mobile Security Project" class="md-nav__button md-logo" aria-label="OWASP Mobile Security Project" data-md-component="logo">
      
  <img src="../../assets/logo_circle.png" alt="logo">

    </a>
    OWASP Mobile Security Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/owasp-mstg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/owasp-mstg
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../donate/" class="md-nav__link">
        ♡ Donations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        News
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          MSTG
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MSTG" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          MSTG
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x01-Foreword/" class="md-nav__link">
        Foreword
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02a-Frontispiece/" class="md-nav__link">
        Frontispiece
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02b-MASVS-MSTG-Adoption/" class="md-nav__link">
        OWASP MASVS and MSTG Adoption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x02c-Acknowledgements/" class="md-nav__link">
        Acknowledgments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x03-Overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04a-Mobile-App-Taxonomy/" class="md-nav__link">
        Mobile App Taxonomy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04b-Mobile-App-Security-Testing/" class="md-nav__link">
        Mobile App Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04c-Tampering-and-Reverse-Engineering/" class="md-nav__link">
        Mobile App Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04e-Testing-Authentication-and-Session-Management/" class="md-nav__link">
        Mobile App Authentication Architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04f-Testing-Network-Communication/" class="md-nav__link">
        Mobile App Network Communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04g-Testing-Cryptography/" class="md-nav__link">
        Mobile App Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04h-Testing-Code-Quality/" class="md-nav__link">
        Mobile App Code Quality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x04i-Testing-User-Privacy-Protection/" class="md-nav__link">
        Mobile App User Privacy Protection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05a-Platform-Overview/" class="md-nav__link">
        Android Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05b-Basic-Security_Testing/" class="md-nav__link">
        Android Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        Android Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05d-Testing-Data-Storage/" class="md-nav__link">
        Android Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05e-Testing-Cryptography/" class="md-nav__link">
        Android Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05f-Testing-Local-Authentication/" class="md-nav__link">
        Android Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05g-Testing-Network-Communication/" class="md-nav__link">
        Android Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05h-Testing-Platform-Interaction/" class="md-nav__link">
        Android Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        Android Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x05j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        Android Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06a-Platform-Overview/" class="md-nav__link">
        iOS Platform Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06b-Basic-Security-Testing/" class="md-nav__link">
        iOS Basic Security Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06c-Reverse-Engineering-and-Tampering/" class="md-nav__link">
        iOS Tampering and Reverse Engineering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06d-Testing-Data-Storage/" class="md-nav__link">
        iOS Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06e-Testing-Cryptography/" class="md-nav__link">
        iOS Cryptographic APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06f-Testing-Local-Authentication/" class="md-nav__link">
        iOS Local Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06g-Testing-Network-Communication/" class="md-nav__link">
        iOS Network APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06h-Testing-Platform-Interaction/" class="md-nav__link">
        iOS Platform APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06i-Testing-Code-Quality-and-Build-Settings/" class="md-nav__link">
        iOS Code Quality and Build Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x06j-Testing-Resiliency-Against-Reverse-Engineering/" class="md-nav__link">
        iOS Anti-Reversing Defenses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x07-Appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Testing Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Testing Tools
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tools-for-all-platforms" class="md-nav__link">
    Tools for all Platforms
  </a>
  
    <nav class="md-nav" aria-label="Tools for all Platforms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#angr" class="md-nav__link">
    Angr
  </a>
  
    <nav class="md-nav" aria-label="Angr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#angr-android" class="md-nav__link">
    Angr (Android)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida" class="md-nav__link">
    Frida
  </a>
  
    <nav class="md-nav" aria-label="Frida">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frida-for-android" class="md-nav__link">
    Frida for Android
  </a>
  
    <nav class="md-nav" aria-label="Frida for Android">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-frida-on-android" class="md-nav__link">
    Installing Frida on Android
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-frida-on-android" class="md-nav__link">
    Using Frida on Android
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracing-native-libraries-with-frida-trace" class="md-nav__link">
    Tracing Native Libraries with frida-trace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-cli-and-the-java-api" class="md-nav__link">
    Frida CLI and the Java API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-for-ios" class="md-nav__link">
    Frida for iOS
  </a>
  
    <nav class="md-nav" aria-label="Frida for iOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-frida-on-ios" class="md-nav__link">
    Installing Frida on iOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-frida-on-ios" class="md-nav__link">
    Using Frida on iOS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-bindings" class="md-nav__link">
    Frida Bindings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-codeshare" class="md-nav__link">
    Frida CodeShare
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ghidra" class="md-nav__link">
    Ghidra
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hopper-commercial-tool" class="md-nav__link">
    Hopper (Commercial Tool)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ida-pro-commercial-tool" class="md-nav__link">
    IDA Pro (Commercial Tool)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lief" class="md-nav__link">
    LIEF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mobsf" class="md-nav__link">
    MobSF
  </a>
  
    <nav class="md-nav" aria-label="MobSF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mobsf-for-android" class="md-nav__link">
    MobSF for Android
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mobsf-for-ios" class="md-nav__link">
    MobSF for iOS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nm" class="md-nav__link">
    nm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objection" class="md-nav__link">
    Objection
  </a>
  
    <nav class="md-nav" aria-label="Objection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objection-for-android" class="md-nav__link">
    Objection for Android
  </a>
  
    <nav class="md-nav" aria-label="Objection for Android">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-objection-on-android" class="md-nav__link">
    Using Objection on Android
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objection-for-ios" class="md-nav__link">
    Objection for iOS
  </a>
  
    <nav class="md-nav" aria-label="Objection for iOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-objection-on-ios" class="md-nav__link">
    Using Objection on iOS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#r2frida" class="md-nav__link">
    r2frida
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#radare2" class="md-nav__link">
    radare2
  </a>
  
    <nav class="md-nav" aria-label="radare2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#radare2-android" class="md-nav__link">
    radare2 (Android)
  </a>
  
    <nav class="md-nav" aria-label="radare2 (Android)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-radare2" class="md-nav__link">
    Installing radare2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-radare2" class="md-nav__link">
    Using radare2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#radare2-ios" class="md-nav__link">
    Radare2 (iOS)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rms-runtime-mobile-security" class="md-nav__link">
    RMS Runtime Mobile Security
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools-for-android" class="md-nav__link">
    Tools for Android
  </a>
  
    <nav class="md-nav" aria-label="Tools for Android">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adb" class="md-nav__link">
    Adb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-ndk" class="md-nav__link">
    Android NDK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-sdk" class="md-nav__link">
    Android SDK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-studio" class="md-nav__link">
    Android Studio
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#android-ssl-trustkiller" class="md-nav__link">
    Android-SSL-TrustKiller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apktool" class="md-nav__link">
    Apktool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apkx" class="md-nav__link">
    apkx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#busybox" class="md-nav__link">
    Busybox
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bytecode-viewer" class="md-nav__link">
    Bytecode Viewer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drozer" class="md-nav__link">
    Drozer
  </a>
  
    <nav class="md-nav" aria-label="Drozer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-drozer" class="md-nav__link">
    Installing Drozer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-drozer" class="md-nav__link">
    Using Drozer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-drozer-commands" class="md-nav__link">
    Other Drozer commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-drozer-resources" class="md-nav__link">
    Other Drozer resources
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gplaycli" class="md-nav__link">
    gplaycli
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#house" class="md-nav__link">
    House
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspeckage" class="md-nav__link">
    Inspeckage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jadx" class="md-nav__link">
    jadx
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdb" class="md-nav__link">
    jdb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#justtrustme" class="md-nav__link">
    JustTrustMe
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magisk" class="md-nav__link">
    Magisk
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proguard" class="md-nav__link">
    Proguard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rootcloak-plus" class="md-nav__link">
    RootCloak Plus
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scrcpy" class="md-nav__link">
    Scrcpy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sslunpinning" class="md-nav__link">
    SSLUnpinning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#termux" class="md-nav__link">
    Termux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xposed" class="md-nav__link">
    Xposed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools-for-ios" class="md-nav__link">
    Tools for iOS
  </a>
  
    <nav class="md-nav" aria-label="Tools for iOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bfinject" class="md-nav__link">
    bfinject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binarycookiereader" class="md-nav__link">
    BinaryCookieReader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#burp-suite-mobile-assistant" class="md-nav__link">
    Burp Suite Mobile Assistant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-dump" class="md-nav__link">
    class-dump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-dump-z" class="md-nav__link">
    class-dump-z
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-dump-dyld" class="md-nav__link">
    class-dump-dyld
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clutch" class="md-nav__link">
    Clutch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cyberduck" class="md-nav__link">
    Cyberduck
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cycript" class="md-nav__link">
    Cycript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cydia" class="md-nav__link">
    Cydia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dsdump" class="md-nav__link">
    dsdump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumpdecrypted" class="md-nav__link">
    Dumpdecrypted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filezilla" class="md-nav__link">
    FileZilla
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-cycript" class="md-nav__link">
    Frida-cycript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frida-ios-dump" class="md-nav__link">
    Frida-ios-dump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fridpa" class="md-nav__link">
    Fridpa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gdb" class="md-nav__link">
    gdb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ifunbox" class="md-nav__link">
    iFunBox
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introspy-ios" class="md-nav__link">
    Introspy-iOS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iosbackup" class="md-nav__link">
    iOSbackup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ios-deploy" class="md-nav__link">
    ios-deploy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iproxy" class="md-nav__link">
    iProxy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#itunnel" class="md-nav__link">
    itunnel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keychain-dumper" class="md-nav__link">
    Keychain-Dumper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lldb" class="md-nav__link">
    lldb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machooview" class="md-nav__link">
    MachoOView
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optool" class="md-nav__link">
    optool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#otool" class="md-nav__link">
    otool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passionfruit" class="md-nav__link">
    Passionfruit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plutil" class="md-nav__link">
    Plutil
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sileo" class="md-nav__link">
    Sileo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simctl" class="md-nav__link">
    simctl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-kill-switch-2" class="md-nav__link">
    SSL Kill Switch 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swift-demangle" class="md-nav__link">
    swift-demangle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tableplus" class="md-nav__link">
    TablePlus
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usbmuxd" class="md-nav__link">
    Usbmuxd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weak-classdump" class="md-nav__link">
    Weak Classdump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcode" class="md-nav__link">
    Xcode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcode-command-line-tools" class="md-nav__link">
    Xcode Command Line Tools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xcrun" class="md-nav__link">
    xcrun
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools-for-network-interception-and-monitoring" class="md-nav__link">
    Tools for Network Interception and Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Tools for Network Interception and Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android-tcpdump" class="md-nav__link">
    Android tcpdump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bettercap" class="md-nav__link">
    bettercap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#burp-suite" class="md-nav__link">
    Burp Suite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mitm-relay" class="md-nav__link">
    MITM Relay
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owasp-zap" class="md-nav__link">
    OWASP ZAP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcpdump" class="md-nav__link">
    tcpdump
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wireshark" class="md-nav__link">
    Wireshark
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerable-applications" class="md-nav__link">
    Vulnerable applications
  </a>
  
    <nav class="md-nav" aria-label="Vulnerable applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android" class="md-nav__link">
    Android
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ios" class="md-nav__link">
    iOS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0x09-Suggested-Reading/" class="md-nav__link">
        Suggested Reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/1_How_Can_You_Contribute/" class="md-nav__link">
        How Can You Contribute?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/2_Getting_Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/3_PRs_and_Reviews/" class="md-nav__link">
        Pull Requests & Reviews
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/4_Add_new_Language/" class="md-nav__link">
        Add a New Language
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/5_Style_Guide/" class="md-nav__link">
        Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/OWASP/owasp-mstg/edit/master/docs/MSTG/0x08-Testing-Tools.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="testing-tools">Testing Tools<a class="headerlink" href="#testing-tools" title="Permanent link">&para;</a></h1>
<p>To perform security testing different tools are available in order to be able to manipulate requests and responses, decompile apps, investigate the behavior of running apps and other test cases and automate them.</p>
<blockquote>
<p>The MSTG project has no preference in any of the tools below, or in promoting or selling any of the tools. All tools below have been verified if they are "alive", meaning that updates have been pushed recently. Nevertheless, not all tools have been used/tested by the authors, but they might still be useful when analyzing a mobile app. The listing is sorted in alphabetical order. The list is also pointing out commercial tools.</p>
<p>Disclaimer: At the time of writing, we ensure that the tools being used in the MSTG examples are properly working. However, the tools might be broken or not work properly depending on your OS version of both your host computer and your test device. The functioning of the tooling can be further impeded by whether you're using a rooted/jailbroken device, the specific version of the rooting/jailbreak method and/or the version of the tool. The MSTG does not take any responsibility over the working status of the tools. If you find a broken tool or example, please search or file an issue in the tool original page, e.g. in the GitHub issues page.</p>
</blockquote>
<h2 id="tools-for-all-platforms">Tools for all Platforms<a class="headerlink" href="#tools-for-all-platforms" title="Permanent link">&para;</a></h2>
<h3 id="angr">Angr<a class="headerlink" href="#angr" title="Permanent link">&para;</a></h3>
<h4 id="angr-android">Angr (Android)<a class="headerlink" href="#angr-android" title="Permanent link">&para;</a></h4>
<p>Angr is a Python framework for analyzing binaries. It is useful for both static and dynamic symbolic ("concolic") analysis. In other words: given a binary and a requested state, Angr will try to get to that state, using formal methods (a technique used for static code analysis) to find a path, as well as brute forcing. Using angr to get to the requested state is often much faster than taking manual steps for debugging and searching the path towards the required state. Angr operates on the VEX intermediate language and comes with a loader for ELF/ARM binaries, so it is perfect for dealing with native code, such as native Android binaries.</p>
<p>Angr allows for disassembly, program instrumentation, symbolic execution, control-flow analysis, data-dependency analysis, decompilation and more, given a large set of plugins.</p>
<p>Since version 8, Angr is based on Python 3, and can be installed with pip on *nix operating systems, macOS and Windows:</p>
<div class="highlight"><pre><span></span><code>$ pip install angr
</code></pre></div>
<blockquote>
<p>Some of angr's dependencies contain forked versions of the Python modules Z3 and PyVEX, which would overwrite the original versions. If you're using those modules for anything else, you should create a dedicated virtual environment with <a href="https://docs.python.org/3/tutorial/venv.html" title="Virtualenv documentation">Virtualenv</a>. Alternatively, you can always use the provided docker container. See the <a href="https://docs.angr.io/introductory-errata/install" title="angr Installation Guide">installation guide</a> for more details.</p>
</blockquote>
<p>Comprehensive documentation, including an installation guide, tutorials, and usage examples are available on <a href="https://docs.angr.io/" title="angr">Angr's Gitbooks page</a>. A complete <a href="https://angr.io/api-doc/" title="angr API">API reference</a> is also available.</p>
<p>You can use angr from a Python REPL - such as iPython - or script your approaches. Although angr has a bit of a steep learning curve, we do recommend using it when you want to brute force your way to a given state of an executable. Please see the "<a href="../0x05c-Reverse-Engineering-and-Tampering/#symbolic-execution" title="Symbolic Execution">Symbolic Execution</a>" section of the "Reverse Engineering and Tampering" chapter as a great example on how this can work.</p>
<h3 id="frida">Frida<a class="headerlink" href="#frida" title="Permanent link">&para;</a></h3>
<p><a href="https://www.frida.re" title="Frida">Frida</a> is a free and open source dynamic code instrumentation toolkit written by Ole André Vadla Ravnås that works by injecting the <a href="https://bellard.org/quickjs/">QuickJS</a> JavaScript engine (previously <a href="https://duktape.org/" title="Duktape JavaScript Engine">Duktape</a> and <a href="https://v8.dev/docs" title="V8 JavaScript Engine">V8</a>) into the instrumented process. Frida lets you execute snippets of JavaScript into native apps on Android and iOS (as well as on <a href="https://www.frida.re/docs/home/" title="So what is Frida, exactly?">other platforms</a>).</p>
<p>To install Frida locally, simply run:</p>
<div class="highlight"><pre><span></span><code>$ pip install frida-tools
</code></pre></div>
<p>Or refer to the <a href="https://www.frida.re/docs/installation/" title="Frida Installation">installation page</a> for more details.</p>
<p>Code can be injected in several ways. For example, Xposed permanently modifies the Android app loader, providing hooks for running your own code every time a new process is started.
In contrast, Frida implements code injection by writing code directly into the process memory. When attached to a running app:</p>
<ul>
<li>Frida uses ptrace to hijack a thread of a running process. This thread is used to allocate a chunk of memory and populate it with a mini-bootstrapper.</li>
<li>The bootstrapper starts a fresh thread, connects to the Frida debugging server that's running on the device, and loads a shared library that contains the Frida agent (<code>frida-agent.so</code>).</li>
<li>The agent establishes a bi-directional communication channel back to the tool (e.g. the Frida REPL or your custom Python script).</li>
<li>The hijacked thread resumes after being restored to its original state, and process execution continues as usual.</li>
</ul>
<p><img src="../../assets/Images/Chapters/0x04/frida.png" width="100%" /></p>
<ul>
<li><em>Frida Architecture, source: <a href="https://www.frida.re/docs/hacking" title="Frida - Hacking">https://www.frida.re/docs/hacking/</a></em></li>
</ul>
<p>Frida offers three modes of operation:</p>
<ol>
<li>Injected: this is the most common scenario when frida-server is running as a daemon in the iOS or Android device. frida-core is exposed over TCP, listening on localhost:27042 by default. Running in this mode is not possible on devices that are not rooted or jailbroken.</li>
<li>Embedded: this is the case when your device is not rooted nor jailbroken (you cannot use ptrace as an unprivileged user), you're responsible for the injection of the <a href="https://www.frida.re/docs/gadget/" title="Frida Gadget">frida-gadget</a> library by embedding it into your app, manually or via third-party tools such as <a href="#objection">Objection</a>.</li>
<li>Preloaded: similar to <code>LD_PRELOAD</code> or <code>DYLD_INSERT_LIBRARIES</code>. You can configure the frida-gadget to run autonomously and load a script from the filesystem (e.g. path relative to where the Gadget binary resides).</li>
</ol>
<p>Independently of the chosen mode, you can make use of the <a href="https://www.frida.re/docs/javascript-api/" title="Frida JavaScript APIs">Frida JavaScript APIs</a> to interact with the running process and its memory. Some of the fundamental APIs are:</p>
<ul>
<li><a href="https://www.frida.re/docs/javascript-api/#interceptor" title="Interceptor">Interceptor</a>: When using the Interceptor API, Frida injects a trampoline (aka in-line hooking) at the function prologue which provokes a redirection to our custom code, executes our code, and returns to the original function. Note that while very effective for our purpose, this introduces a considerable overhead (due to the trampoline related jumping and context switching) and cannot be considered transparent as it overwrites the original code and acts similar to a debugger (putting breakpoints) and therefore can be detected in a similar manner, e.g. by applications that periodically checksum their own code.</li>
<li><a href="https://www.frida.re/docs/javascript-api/#stalker" title="Stalker">Stalker</a>: If your tracing requirements include transparency, performance and high granularity, Stalker should be your API of choice. When tracing code with the Stalker API, Frida leverages just-in-time dynamic recompilation (by using <a href="http://www.capstone-engine.org/" title="Capstone">Capstone</a>): when a thread is about to execute its next instructions, Stalker allocates some memory, copies the original code over, and interlaces the copy with your custom code for instrumentation. Finally, it executes the copy (leaving the original code untouched, and therefore avoiding any anti-debugging checks). This approach increases instrumentation performance considerably and allows for very high granularity when tracing (e.g. by tracing exclusively CALL or RET instructions). You can learn more in-depth details in <a href="https://medium.com/@oleavr/anatomy-of-a-code-tracer-b081aadb0df8" title="Anatomy of a code tracer">the blog post "Anatomy of a code tracer" by Frida's creator Ole</a> [#vadla]. Some examples of use for Stalker are, for example <a href="https://codeshare.frida.re/@oleavr/who-does-it-call/" title="who-does-it-call">who-does-it-call</a> or <a href="https://github.com/frida/frida-presentations/blob/master/R2Con2017/01-basics/02-diff-calls.js" title="diff-calls">diff-calls</a>.</li>
<li><a href="https://www.frida.re/docs/javascript-api/#java" title="Java">Java</a>: When working on Android you can use this API to enumerate loaded classes, enumerate class loaders, create and use specific class instances, enumerate live instances of classes by scanning the heap, etc.</li>
<li><a href="https://www.frida.re/docs/javascript-api/#objc" title="ObjC">ObjC</a>: When working on iOS you can use this API to get a mapping of all registered classes, register or use specific class or protocol instances, enumerate live instances of classes by scanning the heap, etc.</li>
</ul>
<p>Frida also provides a couple of simple tools built on top of the Frida API and available right from your terminal after installing frida-tools via pip. For instance:</p>
<ul>
<li>You can use the <a href="https://www.frida.re/docs/frida-cli/" title="Frida CLI">Frida CLI</a> (<code>frida</code>) for quick script prototyping and try/error scenarios.</li>
<li><a href="https://www.frida.re/docs/frida-ps/" title="frida-ps"><code>frida-ps</code></a> to obtain a list of all apps (or processes) running on the device including their names, identifiers and PIDs.</li>
<li><a href="https://www.frida.re/docs/frida-ls-devices/" title="frida-ls-devices"><code>frida-ls-devices</code></a> to list your connected devices running Frida servers or agents.</li>
<li><a href="https://www.frida.re/docs/frida-trace/" title="frida-trace"><code>frida-trace</code></a> to quickly trace methods that are part of an iOS app or that are implemented inside an Android native library.</li>
</ul>
<p>In addition, you'll also find several open source Frida-based tools, such as:</p>
<ul>
<li><a href="https://github.com/chaitin/passionfruit" title="Passionfruit">Passionfruit</a>: an iOS app blackbox assessment tool.</li>
<li><a href="https://github.com/Nightbringer21/fridump" title="fridump">Fridump</a>: a memory dumping tool for both Android and iOS.</li>
<li><a href="https://github.com/sensepost/objection" title="objection">Objection</a>: a runtime mobile security assessment framework.</li>
<li><a href="https://github.com/nowsecure/r2frida" title="r2frida">r2frida</a>: a project merging the powerful reverse engineering capabilities of radare2 with the dynamic instrumentation toolkit of Frida.</li>
<li><a href="https://github.com/chame1eon/jnitrace" title="jnitrace">jnitrace</a>: a tool for tracing usage of the Android JNI runtime methods by a native library.</li>
</ul>
<p>We will be using all of these tools throughout the guide.</p>
<p>You can use these tools as-is, tweak them to your needs, or take as excellent examples on how to use the APIs. Having them as an example is very helpful when you write your own hooking scripts or when you build introspection tools to support your reverse engineering workflow.</p>
<h4 id="frida-for-android">Frida for Android<a class="headerlink" href="#frida-for-android" title="Permanent link">&para;</a></h4>
<p>Frida supports interaction with the Android Java runtime though the <a href="https://www.frida.re/docs/javascript-api/#java" title="Frida - Java API">Java API</a>. You'll be able to hook and call both Java and native functions inside the process and its native libraries. Your JavaScript snippets have full access to memory, e.g. to read and/or write any structured data.</p>
<p>Here are some tasks that Frida APIs offers and are relevant or exclusive on Android:</p>
<ul>
<li>Instantiate Java objects and call static and non-static class methods (<a href="https://www.frida.re/docs/javascript-api/#java" title="Frida - Java API">Java API</a>).</li>
<li>Replace Java method implementations (<a href="https://www.frida.re/docs/javascript-api/#java" title="Frida - Java API">Java API</a>).</li>
<li>Enumerate live instances of specific classes by scanning the Java heap (<a href="https://www.frida.re/docs/javascript-api/#java" title="Frida - Java API">Java API</a>).</li>
<li>Scan process memory for occurrences of a string (<a href="https://www.frida.re/docs/javascript-api/#memory" title="Frida - Memory API">Memory API</a>).</li>
<li>Intercept native function calls to run your own code at function entry and exit (<a href="https://www.frida.re/docs/javascript-api/#interceptor" title="Frida - Interceptor API">Interceptor API</a>).</li>
</ul>
<p>Remember that on Android, you can also benefit from the built-in tools provided when installing Frida, that includes the Frida CLI (<code>frida</code>), <code>frida-ps</code>, <code>frida-ls-devices</code> and <code>frida-trace</code>, to name some of them.</p>
<p>Frida is often compared to Xposed, however this comparison is far from fair as both frameworks were designed with different goals in mind. This is important to understand as an app security tester so that you can know which framework to use in which situation:</p>
<ul>
<li>Frida is standalone, all you need is to run the frida-server binary from a known location in your target Android device (see "Installing Frida" below). This means that, in contrast to Xposed, it is not <em>deep</em> installed in the target OS.</li>
<li>Reversing an app is an iterative process. As a consequence of the previous point, you obtain a shorter feedback loop when testing as you don't need to (soft) reboot to apply or simply update your hooks. So you might prefer to use Xposed when implementing more permanent hooks.</li>
<li>You may inject and update your Frida JavaScript code on the fly at any point during the runtime of your process (similarly to Cycript on iOS). This way you can perform the so-called <em>early instrumentation</em> by letting Frida spawn your app or you may prefer to attach to a running app that you might have brought to a certain state.</li>
<li>Frida is able to handle both Java as well as native code (JNI), allowing you to modify both of them. This is unfortunately a limitation of Xposed which lacks of native code support.</li>
</ul>
<blockquote>
<p>Note that Xposed, as of early 2019, does not work on Android 9 (API level 28) yet.</p>
</blockquote>
<h5 id="installing-frida-on-android">Installing Frida on Android<a class="headerlink" href="#installing-frida-on-android" title="Permanent link">&para;</a></h5>
<p>In order to set up Frida on your Android device:</p>
<ul>
<li>If your device is not rooted, you can also use Frida, please refer to section "<a href="../0x05c-Reverse-Engineering-and-Tampering/#dynamic-analysis-on-non-rooted-devices" title="Dynamic Analysis on Non-Rooted Devices">Dynamic Analysis on Non-Rooted Devices</a>" of the "Reverse Engineering and Tampering" chapter.</li>
<li>If you have a rooted device, simply follow the <a href="https://www.frida.re/docs/android/" title="Frida - Setting up your Android device">official instructions</a> or follow the hints below.</li>
</ul>
<p>We assume a rooted device here unless otherwise noted. Download the frida-server binary from the <a href="https://github.com/frida/frida/releases">Frida releases page</a>. Make sure that you download the right frida-server binary for the architecture of your Android device or emulator: x86, x86_64, arm or arm64. Make sure that the server version (at least the major version number) matches the version of your local Frida installation. PyPI usually installs the latest version of Frida. If you're unsure which version is installed, you can check with the Frida command line tool:</p>
<div class="highlight"><pre><span></span><code>$ frida --version
</code></pre></div>
<p>Or you can run the following command to automatically detect Frida version and download the right frida-server binary:</p>
<div class="highlight"><pre><span></span><code>$ wget https://github.com/frida/frida/releases/download/<span class="k">$(</span>frida --version<span class="k">)</span>/frida-server-<span class="k">$(</span>frida --version<span class="k">)</span>-android-arm.xz
</code></pre></div>
<p>Copy frida-server to the device and run it:</p>
<div class="highlight"><pre><span></span><code>$ adb push frida-server /data/local/tmp/
$ adb shell <span class="s2">&quot;chmod 755 /data/local/tmp/frida-server&quot;</span>
$ adb shell <span class="s2">&quot;su -c /data/local/tmp/frida-server &amp;&quot;</span>
</code></pre></div>
<h5 id="using-frida-on-android">Using Frida on Android<a class="headerlink" href="#using-frida-on-android" title="Permanent link">&para;</a></h5>
<p>With frida-server running, you should now be able to get a list of running processes with the following command (use the <code>-U</code> option to indicate Frida to use a connected USB devices or emulator):</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -U
  PID  Name
-----  --------------------------------------------------------------
  <span class="m">276</span>  adbd
  <span class="m">956</span>  android.process.media
  <span class="m">198</span>  bridgemgrd
<span class="m">30692</span>  com.android.chrome
<span class="m">30774</span>  com.android.chrome:privileged_process0
<span class="m">30747</span>  com.android.chrome:sandboxed
<span class="m">30834</span>  com.android.chrome:sandboxed
 <span class="m">3059</span>  com.android.nfc
 <span class="m">1526</span>  com.android.phone
<span class="m">17104</span>  com.android.settings
 <span class="m">1302</span>  com.android.systemui
<span class="o">(</span>...<span class="o">)</span>
</code></pre></div>
<p>Or restrict the list with the <code>-Uai</code> flag combination to get all apps (<code>-a</code>) currently installed (<code>-i</code>) on the connected USB device (<code>-U</code>):</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -Uai
  PID  Name                                      Identifier
-----  ----------------------------------------  ------------------------------
  <span class="m">766</span>  Android System                            android
<span class="m">30692</span>  Chrome                                    com.android.chrome
 <span class="m">3520</span>  Contacts Storage                          com.android.providers.contacts
    -  Uncrackable1                              sg.vantagepoint.uncrackable1
    -  drozer Agent                              com.mwr.dz
</code></pre></div>
<p>This will show the names and identifiers of all apps, if they are currently running it will also show their PIDs. Search for your app in the list and take a note of the PID or its name/identifier. From now on you'll refer to your app by using one of them. A recommendation is to use the identifiers, as the PIDs will change on each run of the app. For example let's take <code>com.android.chrome</code>. You can use this string now on all Frida tools, e.g. on the Frida CLI, on frida-trace or from a Python script.</p>
<h5 id="tracing-native-libraries-with-frida-trace">Tracing Native Libraries with frida-trace<a class="headerlink" href="#tracing-native-libraries-with-frida-trace" title="Permanent link">&para;</a></h5>
<p>To trace specific (low-level) library calls, you can use the <code>frida-trace</code> command line tool:</p>
<div class="highlight"><pre><span></span><code>$ frida-trace -U com.android.chrome -i <span class="s2">&quot;open&quot;</span>
</code></pre></div>
<p>This generates a little JavaScript in <code>__handlers__/libc.so/open.js</code>, which Frida injects into the process. The script traces all calls to the <code>open</code> function in <code>libc.so</code>. You can modify the generated script according to your needs with Frida <a href="https://www.frida.re/docs/javascript-api/">JavaScript API</a>.</p>
<p>Unfortunately tracing high-level methods of Java classes is not yet supported (but might be <a href="https://github.com/frida/frida-python/issues/70" title="Support for tracing high-level methods of Java Classes via patterns">in the future</a>).</p>
<h5 id="frida-cli-and-the-java-api">Frida CLI and the Java API<a class="headerlink" href="#frida-cli-and-the-java-api" title="Permanent link">&para;</a></h5>
<p>Use the Frida CLI tool (<code>frida</code>) to work with Frida interactively. It hooks into a process and gives you a command line interface to Frida's API.</p>
<div class="highlight"><pre><span></span><code>$ frida -U com.android.chrome
</code></pre></div>
<p>With the <code>-l</code> option, you can also use the Frida CLI to load scripts , e.g., to load <code>myscript.js</code>:</p>
<div class="highlight"><pre><span></span><code>$ frida -U -l myscript.js com.android.chrome
</code></pre></div>
<p>Frida also provides a <a href="https://www.frida.re/docs/javascript-api/#java" title="Frida - Java API">Java API</a>, which is especially helpful for dealing with Android apps. It lets you work with Java classes and objects directly. Here is a script to overwrite the <code>onResume</code> function of an Activity class:</p>
<div class="highlight"><pre><span></span><code><span class="n">Java</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">Activity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Java</span><span class="p">.</span><span class="na">use</span><span class="p">(</span><span class="s">&quot;android.app.Activity&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Activity</span><span class="p">.</span><span class="na">onResume</span><span class="p">.</span><span class="na">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;[*] onResume() got called!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">onResume</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>The above script calls <code>Java.perform</code> to make sure that your code gets executed in the context of the Java VM. It instantiates a wrapper for the <code>android.app.Activity</code> class via <code>Java.use</code> and overwrites the <code>onResume</code> function. The new <code>onResume</code> function implementation prints a notice to the console and calls the original <code>onResume</code> method by invoking <code>this.onResume</code> every time an activity is resumed in the app.</p>
<p>Frida also lets you search for and work with instantiated objects that are on the heap. The following script searches for instances of <code>android.view.View</code> objects and calls their <code>toString</code> method. The result is printed to the console:</p>
<div class="highlight"><pre><span></span><code><span class="n">setImmediate</span><span class="p">(</span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;[*] Starting script&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Java</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Java</span><span class="p">.</span><span class="na">choose</span><span class="p">(</span><span class="s">&quot;android.view.View&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;onMatch&quot;</span><span class="p">:</span><span class="n">function</span><span class="p">(</span><span class="n">instance</span><span class="p">){</span><span class="w"></span>
<span class="w">                  </span><span class="n">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;[*] Instance found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">instance</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
<span class="w">             </span><span class="p">},</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;onComplete&quot;</span><span class="p">:</span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                  </span><span class="n">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&quot;[*] Finished heap search&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">             </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>The output would look like this:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>*<span class="o">]</span> Starting script
<span class="o">[</span>*<span class="o">]</span> Instance found: android.view.View<span class="o">{</span>7ccea78 G.ED..... ......ID <span class="m">0</span>,0-0,0 <span class="c1">#7f0c01fc app:id/action_bar_black_background}</span>
<span class="o">[</span>*<span class="o">]</span> Instance found: android.view.View<span class="o">{</span><span class="m">2809551</span> V.ED..... ........ <span class="m">0</span>,1731-0,1731 <span class="c1">#7f0c01ff app:id/menu_anchor_stub}</span>
<span class="o">[</span>*<span class="o">]</span> Instance found: android.view.View<span class="o">{</span>be471b6 G.ED..... ......I. <span class="m">0</span>,0-0,0 <span class="c1">#7f0c01f5 app:id/location_bar_verbose_status_separator}</span>
<span class="o">[</span>*<span class="o">]</span> Instance found: android.view.View<span class="o">{</span>3ae0eb7 V.ED..... ........ <span class="m">0</span>,0-1080,63 <span class="c1">#102002f android:id/statusBarBackground}</span>
<span class="o">[</span>*<span class="o">]</span> Finished heap search
</code></pre></div>
<p>You can also use Java's reflection capabilities. To list the public methods of the <code>android.view.View</code> class, you could create a wrapper for this class in Frida and call <code>getMethods</code> from the wrapper's <code>class</code> property:</p>
<div class="highlight"><pre><span></span><code><span class="n">Java</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Java</span><span class="p">.</span><span class="na">use</span><span class="p">(</span><span class="s">&quot;android.view.View&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getMethods</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">methods</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="n">methods</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>This will print a very long list of methods to the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canResolveLayoutDirection</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canResolveTextAlignment</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canResolveTextDirection</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canScrollHorizontally</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canScrollVertically</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">cancelDragAndDrop</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">cancelLongPress</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">cancelPendingInputEvents</span><span class="p">()</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</code></pre></div>
<h4 id="frida-for-ios">Frida for iOS<a class="headerlink" href="#frida-for-ios" title="Permanent link">&para;</a></h4>
<p>Frida supports interaction with the Objective-C runtime through the <a href="https://www.frida.re/docs/javascript-api/#objc" title="Frida - ObjC API">ObjC API</a>. You'll be able to hook and call both Objective-C and native functions inside the process and its native libraries. Your JavaScript snippets have full access to memory, e.g. to read and/or write any structured data.</p>
<p>Here are some tasks that Frida APIs offers and are relevant or exclusive on iOS:</p>
<ul>
<li>Instantiate Objective-C objects and call static and non-static class methods (<a href="https://www.frida.re/docs/javascript-api/#objc" title="Frida - ObjC API">ObjC API</a>).</li>
<li>Trace Objective-C method calls and/or replace their implementations (<a href="https://www.frida.re/docs/javascript-api/#interceptor" title="Frida - Interceptor API">Interceptor API</a>).</li>
<li>Enumerate live instances of specific classes by scanning the heap (<a href="https://www.frida.re/docs/javascript-api/#objc" title="Frida - ObjC API">ObjC API</a>).</li>
<li>Scan process memory for occurrences of a string (<a href="https://www.frida.re/docs/javascript-api/#memory" title="Frida - Memory API">Memory API</a>).</li>
<li>Intercept native function calls to run your own code at function entry and exit (<a href="https://www.frida.re/docs/javascript-api/#interceptor" title="Frida - Interceptor API">Interceptor API</a>).</li>
</ul>
<p>Remember that on iOS, you can also benefit from the built-in tools provided when installing Frida, which include the Frida CLI (<code>frida</code>), <code>frida-ps</code>, <code>frida-ls-devices</code> and <code>frida-trace</code>, to name a few.</p>
<p>There's a <code>frida-trace</code> feature exclusive on iOS worth highlighting: tracing Objective-C APIs using the <code>-m</code> flag and wildcards. For example, tracing all methods including "HTTP" in their name and belonging to any class whose name starts with "NSURL" is as easy as running:</p>
<div class="highlight"><pre><span></span><code>$ frida-trace -U YourApp -m <span class="s2">&quot;*[NSURL* *HTTP*]&quot;</span>
</code></pre></div>
<p>For a quick start you can go through the <a href="https://www.frida.re/docs/examples/ios/" title="Frida iOS examples">iOS examples</a>.</p>
<h5 id="installing-frida-on-ios">Installing Frida on iOS<a class="headerlink" href="#installing-frida-on-ios" title="Permanent link">&para;</a></h5>
<p>To connect Frida to an iOS app, you need a way to inject the Frida runtime into that app. This is easy to do on a jailbroken device: just install <code>frida-server</code> through Cydia. Once it has been installed, the Frida server will automatically run with root privileges, allowing you to easily inject code into any process.</p>
<p>Start Cydia and add Frida's repository by navigating to <strong>Manage</strong> -&gt; <strong>Sources</strong> -&gt; <strong>Edit</strong> -&gt; <strong>Add</strong> and entering <a href="https://build.frida.re">https://build.frida.re</a>. You should then be able to find and install the Frida package.</p>
<h5 id="using-frida-on-ios">Using Frida on iOS<a class="headerlink" href="#using-frida-on-ios" title="Permanent link">&para;</a></h5>
<p>Connect your device via USB and make sure that Frida works by running the <code>frida-ps</code> command and the flag '-U'. This should return the list of processes running on the device:</p>
<div class="highlight"><pre><span></span><code>$ frida-ps -U
PID  Name
---  ----------------
<span class="m">963</span>  Mail
<span class="m">952</span>  Safari
<span class="m">416</span>  BTServer
<span class="m">422</span>  BlueTool
<span class="m">791</span>  CalendarWidget
<span class="m">451</span>  CloudKeychainPro
<span class="m">239</span>  CommCenter
<span class="m">764</span>  ContactsCoreSpot
<span class="o">(</span>...<span class="o">)</span>
</code></pre></div>
<h4 id="frida-bindings">Frida Bindings<a class="headerlink" href="#frida-bindings" title="Permanent link">&para;</a></h4>
<p>In order to extend the scripting experience, Frida offers bindings to programming languages such as Python, C, NodeJS, and Swift.</p>
<p>Taking Python as an example, the first thing to note is that no further installation steps are required. Start your Python script with <code>import frida</code> and you're ready to go. See the following script that simply runs the previous JavaScript snippet:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># frida_python.py</span>
<span class="kn">import</span> <span class="nn">frida</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">frida</span><span class="o">.</span><span class="n">get_usb_device</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s1">&#39;com.android.chrome&#39;</span><span class="p">)</span>

<span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Java.perform(function () {</span>
<span class="s2">    var view = Java.use(&quot;android.view.View&quot;);</span>
<span class="s2">    var methods = view.class.getMethods();</span>
<span class="s2">    for(var i = 0; i &lt; methods.length; i++) {</span>
<span class="s2">        console.log(methods[i].toString());</span>
<span class="s2">    }</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">script</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">create_script</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="n">script</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">session</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</code></pre></div>
<p>In this case, running the Python script (<code>python3 frida_python.py</code>) has the same result as the previous example: it will print all methods of the <code>android.view.View</code> class to the terminal. However, you might want to work with that data from Python. Using <code>send</code> instead of <code>console.log</code> will send data in JSON format from JavaScript to Python. Please read the comments in the example below:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># python3 frida_python_send.py</span>
<span class="kn">import</span> <span class="nn">frida</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">frida</span><span class="o">.</span><span class="n">get_usb_device</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s1">&#39;com.android.chrome&#39;</span><span class="p">)</span>

<span class="c1"># 1. we want to store method names inside a list</span>
<span class="n">android_view_methods</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Java.perform(function () {</span>
<span class="s2">    var view = Java.use(&quot;android.view.View&quot;);</span>
<span class="s2">    var methods = view.class.getMethods();</span>
<span class="s2">    for(var i = 0; i &lt; methods.length; i++) {</span>
<span class="s2">        send(methods[i].toString());</span>
<span class="s2">    }</span>
<span class="s2">});</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">script</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">create_script</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

<span class="c1"># 2. this is a callback function, only method names containing &quot;Text&quot; will be appended to the list</span>
<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;Text&quot;</span> <span class="ow">in</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">]:</span>
        <span class="n">android_view_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">])</span>

<span class="c1"># 3. we tell the script to run our callback each time a message is received</span>
<span class="n">script</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="n">on_message</span><span class="p">)</span>

<span class="n">script</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="c1"># 4. we do something with the collected data, in this case we just print it</span>
<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">android_view_methods</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

<span class="n">session</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</code></pre></div>
<p>This effectively filters the methods and prints only the ones containing the string "Text":</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="n">frida_python_send</span><span class="p">.</span><span class="na">py</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canResolveTextAlignment</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">canResolveTextDirection</span><span class="p">()</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">setTextAlignment</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">setTextDirection</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">view</span><span class="p">.</span><span class="na">View</span><span class="p">.</span><span class="na">setTooltipText</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">CharSequence</span><span class="p">)</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
</code></pre></div>
<p>In the end, it is up to you to decide where would you like to work with the data. Sometimes it will be more convenient to do it from JavaScript and in other cases Python will be the best choice. Of course you can also send messages from Python to JavaScript by using <code>script.post</code>. Refer to the Frida docs for more information about <a href="https://www.frida.re/docs/messages/#sending-messages-from-a-target-process" title="Sending messages from a target process">sending</a> and <a href="https://www.frida.re/docs/messages/#receiving-messages-in-a-target-process" title="Receiving messages in a target process">receiving</a> messages.</p>
<h3 id="frida-codeshare">Frida CodeShare<a class="headerlink" href="#frida-codeshare" title="Permanent link">&para;</a></h3>
<p><a href="https://codeshare.frida.re/" title="Frida CodeShare">Frida CodeShare</a> is a repository containing a collection of ready-to-run Frida scripts which can enormously help when performing concrete tasks both on Android as on iOS as well as also serve as inspiration to build your own scripts. Two representative examples are:</p>
<ul>
<li>Universal Android SSL Pinning Bypass with Frida - <a href="https://codeshare.frida.re/@pcipolloni/universal-android-ssl-pinning-bypass-with-frida/">https://codeshare.frida.re/@pcipolloni/universal-android-ssl-pinning-bypass-with-frida/</a></li>
<li>ObjC method observer - <a href="https://codeshare.frida.re/@mrmacete/objc-method-observer/">https://codeshare.frida.re/@mrmacete/objc-method-observer/</a></li>
</ul>
<p>Using them is as simple as including the <code>--codeshare &lt;handler&gt;</code> flag and a handler when using the Frida CLI. For example, to use "ObjC method observer", enter the following:</p>
<div class="highlight"><pre><span></span><code>$ frida --codeshare mrmacete/objc-method-observer -f YOUR_BINARY
</code></pre></div>
<h3 id="ghidra">Ghidra<a class="headerlink" href="#ghidra" title="Permanent link">&para;</a></h3>
<p>Ghidra is an open source software reverse engineering (SRE) suite of tools developed by the United State of America's National Security Agency's (NSA) Research Directorate. Ghidra is a versatile tool which comprises of a disassembler, decompiler and a built-in scripting engine for advanced usage. Please refer to the <a href="https://ghidra-sre.org/InstallationGuide.html" title="Ghidra Installation Guide">installation guide</a> on how to install it and also look at the <a href="https://ghidra-sre.org/CheatSheet.html" title="Cheat Sheet">cheat sheet</a> for a first overview of available commands and shortcuts. In this section, we will have walk-through on how to create a project, view disassembly and decompiled code for a binary.</p>
<p>Start Ghidra using <code>ghidraRun</code> (*nix) or <code>ghidraRun.bat</code> (Windows), depending on the platform you are on. Once Ghidra is fired up, create a new project by specifying the project directory. You will be greeted by a window as shown below:</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_new_project.png" width="100%" /></p>
<p>In your new <strong>Active Project</strong> you can import an app binary by going to <strong>File</strong> -&gt; <strong>Import File</strong> and choosing the desired file.</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_import_binary.png" width="100%" /></p>
<p>If the file can be properly processed, Ghidra will show meta-information about the binary before starting the analysis.</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_elf_import.png" width="100%" /></p>
<p>To get the disassembled code for the binary file chosen above, double click the imported file from the <strong>Active Project</strong> window. Click <strong>yes</strong> and <strong>analyze</strong> for auto-analysis on the subsequent windows. Auto-analysis will take some time depending on the size of the binary, the progress can be tracked in the bottom right corner of the code browser window. Once auto-analysis is completed you can start exploring the binary.</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_main_window.png" width="100%" /></p>
<p>The most important windows to explore a binary in Ghidra are the <strong>Listing</strong> (Disassembly) window, the <strong>Symbol Tree</strong> window and the <strong>Decompiler</strong> window, which shows the decompiled version of the function selected for disassembly. The <strong>Display Function Graph</strong> option shows control flow graph of the selected function.</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_function_graph.png" width="100%" /></p>
<p>There are many other functionalities available in Ghidra and most of them can be explored by opening the <strong>Window</strong> menu. For example, if you want to examine the strings present in the binary, open the <strong>Defined Strings</strong> option. We will discuss other advanced functionalities while analyzing various binaries for Android and iOS platforms in the coming chapters.</p>
<p><img src="../../assets/Images/Chapters/0x04c/Ghidra_string_window.png" width="100%" /></p>
<h3 id="hopper-commercial-tool">Hopper (Commercial Tool)<a class="headerlink" href="#hopper-commercial-tool" title="Permanent link">&para;</a></h3>
<p>A reverse engineering tool for macOS and Linux used to disassemble, decompile and debug 32/64bits Intel Mac, Linux, Windows and iOS executables - <a href="https://www.hopperapp.com/">https://www.hopperapp.com/</a></p>
<h3 id="ida-pro-commercial-tool">IDA Pro (Commercial Tool)<a class="headerlink" href="#ida-pro-commercial-tool" title="Permanent link">&para;</a></h3>
<p>A Windows, Linux or macOS hosted multi-processor disassembler and debugger - <a href="https://www.hex-rays.com/products/ida/index.shtml">https://www.hex-rays.com/products/ida/index.shtml</a></p>
<h3 id="lief">LIEF<a class="headerlink" href="#lief" title="Permanent link">&para;</a></h3>
<p>The purpose of LIEF is to provide a cross platform library to parse, modify and abstract ELF, PE and MachO formats. With it you can, for instance, inject a certain library as a dependency of a native library, which an application already loads by default. - <a href="https://lief.quarkslab.com/">https://lief.quarkslab.com/</a></p>
<h3 id="mobsf">MobSF<a class="headerlink" href="#mobsf" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF" title="MobSF">MobSF</a> (Mobile Security Framework) is an automated, all-in-one mobile application pentesting framework capable of performing static and dynamic analysis. The easiest way of getting MobSF started is via Docker.</p>
<div class="highlight"><pre><span></span><code>$ docker pull opensecurity/mobile-security-framework-mobsf
$ docker run -it -p <span class="m">8000</span>:8000 opensecurity/mobile-security-framework-mobsf:latest
</code></pre></div>
<p>Or install and start it locally on your host computer by running:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Setup</span>
git clone https://github.com/MobSF/Mobile-Security-Framework-MobSF.git
<span class="nb">cd</span> Mobile-Security-Framework-MobSF
./setup.sh <span class="c1"># For Linux and Mac</span>
setup.bat <span class="c1"># For Windows</span>

<span class="c1"># Installation process</span>
./run.sh <span class="c1"># For Linux and Mac</span>
run.bat <span class="c1"># For Windows</span>
</code></pre></div>
<p>Once you have MobSF up and running you can open it in your browser by navigating to <a href="http://127.0.0.1:8000">http://127.0.0.1:8000</a>. Simply drag the APK you want to analyze into the upload area and MobSF will start its job.</p>
<h4 id="mobsf-for-android">MobSF for Android<a class="headerlink" href="#mobsf-for-android" title="Permanent link">&para;</a></h4>
<p>After MobSF is done with its analysis, you will receive a one-page overview of all the tests that were executed. The page is split up into multiple sections giving some first hints on the attack surface of the application.</p>
<p><img src="../../assets/Images/Chapters/0x05b/mobsf_android.png" width="100%" /></p>
<p>The following is displayed:</p>
<ul>
<li>Basic information about the app and its binary file.</li>
<li>Some options to:</li>
<li>View the <code>AndroidManifest.xml</code> file.</li>
<li>View the IPC components of the app.</li>
<li>Signer certificate.</li>
<li>App permissions.</li>
<li>A security analysis showing known defects e.g. if the app backups are enabled.</li>
<li>List of libraries used by the app binary and list of all files inside the unzipped APK.</li>
<li>Malware analysis that checks for malicious URLs.</li>
</ul>
<p>Refer to <a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF/wiki/1.-Documentation" title="MobSF documentation">MobSF documentation</a> for more details.</p>
<h4 id="mobsf-for-ios">MobSF for iOS<a class="headerlink" href="#mobsf-for-ios" title="Permanent link">&para;</a></h4>
<p>By running MobSF locally on a macOS host you'll benefit from a slightly better class-dump output.</p>
<p>Once you have MobSF up and running you can open it in your browser by navigating to <a href="http://127.0.0.1:8000">http://127.0.0.1:8000</a>. Simply drag the IPA you want to analyze into the upload area and MobSF will start its job.</p>
<p>After MobSF is done with its analysis, you will receive a one-page overview of all the tests that were executed. The page is split up into multiple sections giving some first hints on the attack surface of the application.</p>
<p><img src="../../assets/Images/Chapters/0x06b/mobsf_ios.png" width="100%" /></p>
<p>The following is displayed:</p>
<ul>
<li>Basic information about the app and its binary file.</li>
<li>Some options to:</li>
<li>View the <code>Info.plist</code> file.</li>
<li>View the strings contained in the app binary.</li>
<li>Download a class-dump, if the app was written in Objective-C; if it is written in Swift no class-dump can be created.</li>
<li>List all Purpose Strings extracted from the <code>Info.plist</code> which give some hints on the app's permissions.</li>
<li>Exceptions in the App Transport Security (ATS) configuration will be listed.</li>
<li>A brief binary analysis showing if free binary security features are activated or e.g. if the binary makes use of banned APIs.</li>
<li>List of libraries used by the app binary and list of all files inside the unzipped IPA.</li>
</ul>
<blockquote>
<p>In contrast to the Android use case, MobSF does not offer any dynamic analysis features for iOS apps.</p>
</blockquote>
<p>Refer to <a href="https://mobsf.github.io/docs" title="MobSF documentation">MobSF documentation</a> for more details.</p>
<h3 id="nm">nm<a class="headerlink" href="#nm" title="Permanent link">&para;</a></h3>
<p>nm is a tool that displays the name list (symbol table) of the given binary. You can find more information for the <a href="https://ftp.gnu.org/old-gnu/Manuals/binutils-2.12/html_node/binutils_4.html" title="nm -binutils">Android (GNU)</a> version and <a href="http://www.manpagez.com/man/1/nm/osx-10.12.6.php" title="nm">for iOS</a>.</p>
<h3 id="objection">Objection<a class="headerlink" href="#objection" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/sensepost/objection" title="Objection on GitHub">Objection</a> is a "runtime mobile exploration toolkit, powered by Frida". Its main goal is to allow security testing on non-rooted devices through an intuitive interface.</p>
<p>Objection achieves this goal by providing you with the tools to easily inject the Frida gadget into an application by repackaging it. This way, you can deploy the repackaged app to the non-rooted/non-jailbroken device by sideloading it. Objection also provides a REPL that allows you to interact with the application, giving you the ability to perform any action that the application can perform.</p>
<p>Objection can be installed through pip as described on <a href="https://github.com/sensepost/objection/wiki/Installation" title="Objection Wiki - Installation">Objection's Wiki</a>.</p>
<div class="highlight"><pre><span></span><code>$ pip3 install objection
</code></pre></div>
<h4 id="objection-for-android">Objection for Android<a class="headerlink" href="#objection-for-android" title="Permanent link">&para;</a></h4>
<p>Objection offers several features specific to Android. A full list of the features of Objection can be found on the project's homepage, but here are a few interesting ones:</p>
<ul>
<li>Repackage applications to include the Frida gadget</li>
<li>Disable SSL pinning for popular methods</li>
<li>Access application storage to download or upload files</li>
<li>Execute custom Frida scripts</li>
<li>List the Activities, Services and Broadcast receivers</li>
<li>Start Activities</li>
</ul>
<p>The ability to perform advanced dynamic analysis on non-rooted devices is one of the features that makes Objection incredibly useful. An application may contain advanced RASP controls which detect your rooting method and injecting a frida-gadget may be the easiest way to bypass those controls. Furthermore, the included Frida scripts make it very easy to quickly analyze an application, or get around basic security controls.</p>
<p>Finally, in case you do have access to a rooted device, Objection can connect directly to the running Frida server to provide all its functionality without needing to repackage the application. However, if you want to test on a non-rooted device, you will first need to include the Frida gadget in the application. The <a href="https://github.com/sensepost/objection/wiki/Patching-Android-Applications" title="Patching Android Applications">Objection Wiki</a> describes the needed steps in detail, but after making the right preparations, you'll be able to patch an APK by calling the objection command:</p>
<div class="highlight"><pre><span></span><code>$ objection patchapk --source app-release.apk
</code></pre></div>
<p>The patched application then needs to be installed using adb, as explained in "Basic Testing Operations - Installing Apps".</p>
<h5 id="using-objection-on-android">Using Objection on Android<a class="headerlink" href="#using-objection-on-android" title="Permanent link">&para;</a></h5>
<p>Starting up Objection depends on whether you've patched the APK or whether you are using a rooted device running Frida-server. For running a patched APK, objection will automatically find any attached devices and search for a listening Frida gadget. However, when using frida-server, you need to explicitly tell frida-server which application you want to analyze.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Connecting to a patched APK</span>
objection explore

<span class="c1"># Find the correct name using frida-ps</span>
$ frida-ps -Ua <span class="p">|</span> grep -i telegram
<span class="m">30268</span>  Telegram                               org.telegram.messenger

<span class="c1"># Connecting to the Telegram app through Frida-server</span>
$ objection --gadget<span class="o">=</span><span class="s2">&quot;org.telegram.messenger&quot;</span> explore
</code></pre></div>
<p>Once you are in the Objection REPL, you can execute any of the available commands. Below is an overview of some of the most useful ones:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Show the different storage locations belonging to the app</span>
$ env

<span class="c1"># Disable popular ssl pinning methods</span>
$ android sslpinning disable

<span class="c1"># List items in the keystore</span>
$ android keystore list

<span class="c1"># Try to circumvent root detection</span>
$ android root disable
</code></pre></div>
<p>More information on using the Objection REPL can be found on the <a href="https://github.com/sensepost/objection/wiki/Using-objection" title="Using Objection">Objection Wiki</a></p>
<h4 id="objection-for-ios">Objection for iOS<a class="headerlink" href="#objection-for-ios" title="Permanent link">&para;</a></h4>
<p>Objection offers several features specific to iOS. A full list of the features of Objection can be found on the project's homepage, but here are a few interesting ones:</p>
<ul>
<li>Repackage applications to include the Frida gadget</li>
<li>Disable SSL pinning for popular methods</li>
<li>Access application storage to download or upload files</li>
<li>Execute custom Frida scripts</li>
<li>Dump the Keychain</li>
<li>Read plist files</li>
</ul>
<p>All these tasks and more can be easily done by using the commands in objection's REPL. For example, you can obtain the classes used in an app, functions of classes or information about the bundles of an app by running:</p>
<div class="highlight"><pre><span></span><code>OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">12</span>.0<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ios hooking list classes</span>
OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">12</span>.0<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ios hooking list class_methods &lt;ClassName&gt;</span>
OWASP.iGoat-Swift on <span class="o">(</span>iPhone: <span class="m">12</span>.0<span class="o">)</span> <span class="o">[</span>usb<span class="o">]</span> <span class="c1"># ios bundles list_bundles</span>
</code></pre></div>
<p>The ability to perform advanced dynamic analysis on non-jailbroken devices is one of the features that makes Objection incredibly useful. It is not always possible to jailbreak the latest version of iOS, or you may have an application with advanced jailbreak detection mechanisms. Furthermore, the included Frida scripts make it very easy to quickly analyze an application, or get around basic security controls.</p>
<p>Finally, in case you do have access to a jailbroken device, Objection can connect directly to the running Frida server to provide all its functionality without needing to repackage the application. However, if you want to test on a non-jailbroken device, you will first need to include the Frida gadget in the application. The <a href="https://github.com/sensepost/objection/wiki/Patching-iOS-Applications" title="Patching iOS Applications">Objection Wiki</a> describes the needed steps in detail, but after making the right preparations, you'll be able to patch an IPA by calling the objection command:</p>
<div class="highlight"><pre><span></span><code>$ objection patchipa --source my-app.ipa --codesign-signature 0C2E8200Dxxxx
</code></pre></div>
<p>Finally, the application needs to be sideloaded and run with debugging communication enabled. Detailed steps can be found on the <a href="https://github.com/sensepost/objection/wiki/Running-Patched-iOS-Applications" title="Running Patched iOS Applications">Objection Wiki</a>, but for macOS users it can easily be done by using ios-deploy:</p>
<div class="highlight"><pre><span></span><code>$ ios-deploy --bundle Payload/my-app.app -W -d
</code></pre></div>
<h5 id="using-objection-on-ios">Using Objection on iOS<a class="headerlink" href="#using-objection-on-ios" title="Permanent link">&para;</a></h5>
<p>Starting up Objection depends on whether you've patched the IPA or whether you are using a jailbroken device running Frida-server. For running a patched IPA, objection will automatically find any attached devices and search for a listening Frida gadget. However, when using frida-server, you need to explicitly tell frida-server which application you want to analyze.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Connecting to a patched IPA</span>
$ objection explore

<span class="c1"># Using frida-ps to get the correct application name</span>
$ frida-ps -Ua <span class="p">|</span> grep -i Telegram
<span class="m">983</span>  Telegram

<span class="c1"># Connecting to the Telegram app through Frida-server</span>
$ objection --gadget<span class="o">=</span><span class="s2">&quot;Telegram&quot;</span> explore
</code></pre></div>
<p>Once you are in the Objection REPL, you can execute any of the available commands. Below is an overview of some of the most useful ones:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Show the different storage locations belonging to the app</span>
$ env

<span class="c1"># Disable popular ssl pinning methods</span>
$ ios sslpinning disable

<span class="c1"># Dump the Keychain</span>
$ ios keychain dump

<span class="c1"># Dump the Keychain, including access modifiers. The result will be written to the host in myfile.json</span>
$ ios keychain dump --json &lt;myfile.json&gt;

<span class="c1"># Show the content of a plist file</span>
$ ios plist cat &lt;myfile.plist&gt;
</code></pre></div>
<p>More information on using the Objection REPL can be found on the <a href="https://github.com/sensepost/objection/wiki/Using-objection" title="Using Objection">Objection Wiki</a></p>
<h3 id="r2frida">r2frida<a class="headerlink" href="#r2frida" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/nowsecure/r2frida" title="r2frida on Github">r2frida</a> is a project that allows radare2 to connect to Frida, effectively merging the powerful reverse engineering capabilities of radare2 with the dynamic instrumentation toolkit of Frida. r2frida can be used in both on Android and iOS, allowing you to:</p>
<ul>
<li>Attach radare2 to any local process or remote frida-server via USB or TCP.</li>
<li>Read/Write memory from the target process.</li>
<li>Load Frida information such as maps, symbols, imports, classes and methods into radare2.</li>
<li>Call r2 commands from Frida as it exposes the r2pipe interface into the Frida Javascript API.</li>
</ul>
<p>Please refer to <a href="https://github.com/nowsecure/r2frida/blob/master/README.md#installation" title="r2frida installation instructions">r2frida's official installation instructions</a>.</p>
<p>With frida-server running, you should now be able to attach to it using the pid, spawn path, host and port, or device-id. For example, to attach to PID 1234:</p>
<div class="highlight"><pre><span></span><code>$ r2 frida://1234
</code></pre></div>
<p>For more examples on how to connect to frida-server, <a href="https://github.com/nowsecure/r2frida/blob/master/README.md#usage" title="r2frida usage">see the usage section in the r2frida's README page</a>.</p>
<blockquote>
<p>The following examples were executed using an Android app but also apply to iOS apps.</p>
</blockquote>
<p>Once in the r2frida session, all commands start with <code>\</code> or <code>=!</code>. For example, in radare2 you'd run <code>i</code> to display the binary information, but in r2frida you'd use <code>\i</code>.</p>
<blockquote>
<p>See all options with <code>r2 frida://?</code>.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>
arch                x86
bits                <span class="m">64</span>
os                  linux
pid                 <span class="m">2218</span>
uid                 <span class="m">1000</span>
objc                <span class="nb">false</span>
runtime             V8
java                <span class="nb">false</span>
cylang              <span class="nb">false</span>
pageSize            <span class="m">4096</span>
pointerSize         <span class="m">8</span>
codeSigningPolicy   optional
isDebuggerAttached  <span class="nb">false</span>
</code></pre></div>
<p>To search in memory for a specific keyword, you may use the search command <code>\/</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\/</span> unacceptable
Searching <span class="m">12</span> bytes: <span class="m">75</span> 6e <span class="m">61</span> <span class="m">63</span> <span class="m">63</span> <span class="m">65</span> <span class="m">70</span> <span class="m">74</span> <span class="m">61</span> <span class="m">62</span> 6c <span class="m">65</span>
Searching <span class="m">12</span> bytes <span class="k">in</span> <span class="o">[</span>0x0000561f05ebf000-0x0000561f05eca000<span class="o">]</span>
...
Searching <span class="m">12</span> bytes <span class="k">in</span> <span class="o">[</span>0xffffffffff600000-0xffffffffff601000<span class="o">]</span>
hits: <span class="m">23</span>
0x561f072d89ee hit12_0 unacceptable policyunsupported md algorithmvar bad valuec
0x561f0732a91a hit12_1 unacceptableSearching <span class="m">12</span> bytes: <span class="m">75</span> 6e <span class="m">61</span> <span class="m">63</span> <span class="m">63</span> <span class="m">65</span> <span class="m">70</span> <span class="m">74</span> <span class="m">61</span>
</code></pre></div>
<p>To output the search results in JSON format, we simply add <code>j</code> to our previous search command (just as we do in the r2 shell). This can be used in most of the commands:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\/</span>j unacceptable
Searching <span class="m">12</span> bytes: <span class="m">75</span> 6e <span class="m">61</span> <span class="m">63</span> <span class="m">63</span> <span class="m">65</span> <span class="m">70</span> <span class="m">74</span> <span class="m">61</span> <span class="m">62</span> 6c <span class="m">65</span>
Searching <span class="m">12</span> bytes <span class="k">in</span> <span class="o">[</span>0x0000561f05ebf000-0x0000561f05eca000<span class="o">]</span>
...
Searching <span class="m">12</span> bytes <span class="k">in</span> <span class="o">[</span>0xffffffffff600000-0xffffffffff601000<span class="o">]</span>
hits: <span class="m">23</span>
<span class="o">{</span><span class="s2">&quot;address&quot;</span>:<span class="s2">&quot;0x561f072c4223&quot;</span>,<span class="s2">&quot;size&quot;</span>:12,<span class="s2">&quot;flag&quot;</span>:<span class="s2">&quot;hit14_1&quot;</span>,<span class="s2">&quot;content&quot;</span>:<span class="s2">&quot;unacceptable \</span>
<span class="s2">policyunsupported md algorithmvar bad valuec0&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;address&quot;</span>:<span class="s2">&quot;0x561f072c4275&quot;</span>, <span class="se">\</span>
<span class="s2">&quot;size&quot;</span>:12,<span class="s2">&quot;flag&quot;</span>:<span class="s2">&quot;hit14_2&quot;</span>,<span class="s2">&quot;content&quot;</span>:<span class="s2">&quot;unacceptableSearching 12 bytes: 75 6e 61 \</span>
<span class="s2">63 63 65 70 74 61&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;address&quot;</span>:<span class="s2">&quot;0x561f072c42c8&quot;</span>,<span class="s2">&quot;size&quot;</span>:12,<span class="s2">&quot;flag&quot;</span>:<span class="s2">&quot;hit14_3&quot;</span>, <span class="se">\</span>
<span class="s2">&quot;content&quot;</span>:<span class="s2">&quot;unacceptableSearching 12 bytes: 75 6e 61 63 63 65 70 74 61 &quot;</span><span class="o">}</span>,
...
</code></pre></div>
<p>To list the loaded libraries use the command <code>\il</code> and filter the results using the internal grep from radare2 with the command <code>~</code>. For example, the following command will list the loaded libraries matching the keywords <code>keystore</code>, <code>ssl</code> and <code>crypto</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>l~keystore,ssl,crypto
0x00007f3357b8e000 libssl.so.1.1
0x00007f3357716000 libcrypto.so.1.1
</code></pre></div>
<p>Similarly, to list the exports and filter the results by a specific keyword:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\i</span>E libssl.so.1.1~CIPHER
0x7f3357bb7ef0 f SSL_CIPHER_get_bits
0x7f3357bb8260 f SSL_CIPHER_find
0x7f3357bb82c0 f SSL_CIPHER_get_digest_nid
0x7f3357bb8380 f SSL_CIPHER_is_aead
0x7f3357bb8270 f SSL_CIPHER_get_cipher_nid
0x7f3357bb7ed0 f SSL_CIPHER_get_name
0x7f3357bb8340 f SSL_CIPHER_get_auth_nid
0x7f3357bb7930 f SSL_CIPHER_description
0x7f3357bb8300 f SSL_CIPHER_get_kx_nid
0x7f3357bb7ea0 f SSL_CIPHER_get_version
0x7f3357bb7f10 f SSL_CIPHER_get_id
</code></pre></div>
<p>To list or set a breakpoint use the command db. This is useful when analyzing/modifying memory:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\d</span>b
</code></pre></div>
<p>Finally, remember that you can also run Frida JavaScript code with <code>\.</code> plus the name of the script:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000000<span class="o">]</span>&gt; <span class="se">\.</span> agent.js
</code></pre></div>
<p>You can find more examples on <a href="https://github.com/enovella/r2frida-wiki" title="Using r2frida">how to use r2frida</a> on their Wiki project.</p>
<h3 id="radare2">radare2<a class="headerlink" href="#radare2" title="Permanent link">&para;</a></h3>
<h4 id="radare2-android">radare2 (Android)<a class="headerlink" href="#radare2-android" title="Permanent link">&para;</a></h4>
<p><a href="https://rada.re/r/" title="Radare2 official website">radare2</a> (r2) is a popular open source reverse engineering framework for disassembling, debugging, patching and analyzing binaries that is scriptable and supports many architectures and file formats including Android and iOS apps. For Android, Dalvik DEX (odex, multidex), ELF (executables, .so, ART) and Java (JNI and Java classes) are supported. It also contains several useful scripts that can help you during mobile application analysis as it offers low level disassembling and safe static analysis that comes in handy when traditional tools fail.</p>
<p>radare2 implements a rich command line interface (CLI) where you can perform the mentioned tasks. However, if you're not really comfortable using the CLI for reverse engineering you may want to consider using the Web UI (via the <code>-H</code> flag) or the even more convenient Qt and C++ GUI version called <a href="https://github.com/radareorg/cutter" title="Cutter">Cutter</a>. Do keep in mind that the CLI, and more concretely its Visual Mode and its scripting capabilities (<a href="https://github.com/radare/radare2-r2pipe" title="r2pipe">r2pipe</a>), are the core of radare2's power and it's definitely worth learning how to use it.</p>
<h5 id="installing-radare2">Installing radare2<a class="headerlink" href="#installing-radare2" title="Permanent link">&para;</a></h5>
<p>Please refer to <a href="https://github.com/radare/radare2/blob/master/README.md" title="radare2 installation instructions">radare2's official installation instructions</a>. We highly recommend to always install radare2 from the GitHub version instead of via common package managers such as APT. Radare2 is in very active development, which means that third party repositories are often outdated.</p>
<h5 id="using-radare2">Using radare2<a class="headerlink" href="#using-radare2" title="Permanent link">&para;</a></h5>
<p>The radare2 framework comprises a set of small utilities that can be used from the r2 shell or independently as CLI tools. These utilities include <code>rabin2</code>, <code>rasm2</code>, <code>rahash2</code>, <code>radiff2</code>, <code>rafind2</code>, <code>ragg2</code>, <code>rarun2</code>, <code>rax2</code>, and of course <code>r2</code>, which is the main one.</p>
<p>For example, you can use <code>rafind2</code> to read strings directly from an encoded Android Manifest (AndroidManifest.xml):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Permissions</span>
$ rafind2 -ZS permission AndroidManifest.xml
<span class="c1"># Activities</span>
$ rafind2 -ZS activity AndroidManifest.xml
<span class="c1"># Content providers</span>
$ rafind2 -ZS provider AndroidManifest.xml
<span class="c1"># Services</span>
$ rafind2 -ZS service AndroidManifest.xml
<span class="c1"># Receivers</span>
$ rafind2 -ZS receiver AndroidManifest.xml
</code></pre></div>
<p>Or use <code>rabin2</code> to get information about a binary file:</p>
<div class="highlight"><pre><span></span><code>$ rabin2 -I UnCrackable-Level1/classes.dex
arch     dalvik
baddr    0x0
binsz    <span class="m">5528</span>
bintype  class
bits     <span class="m">32</span>
canary   <span class="nb">false</span>
retguard <span class="nb">false</span>
class    <span class="m">035</span>
crypto   <span class="nb">false</span>
endian   little
havecode <span class="nb">true</span>
laddr    0x0
lang     dalvik
linenum  <span class="nb">false</span>
lsyms    <span class="nb">false</span>
machine  Dalvik VM
maxopsz  <span class="m">16</span>
minopsz  <span class="m">1</span>
nx       <span class="nb">false</span>
os       linux
pcalign  <span class="m">0</span>
pic      <span class="nb">false</span>
relocs   <span class="nb">false</span>
sanitiz  <span class="nb">false</span>
static   <span class="nb">true</span>
stripped <span class="nb">false</span>
subsys   java
va       <span class="nb">true</span>
sha1  <span class="m">12</span>-5508c  b7fafe72cb521450c4470043caa332da61d1bec7
adler32  <span class="m">12</span>-5528c  <span class="m">00000000</span>
</code></pre></div>
<p>Type <code>rabin2 -h</code> to see all options:</p>
<div class="highlight"><pre><span></span><code>$ rabin2 -h
Usage: rabin2 <span class="o">[</span>-AcdeEghHiIjlLMqrRsSUvVxzZ<span class="o">]</span> <span class="o">[</span>-@ at<span class="o">]</span> <span class="o">[</span>-a arch<span class="o">]</span> <span class="o">[</span>-b bits<span class="o">]</span> <span class="o">[</span>-B addr<span class="o">]</span>
              <span class="o">[</span>-C F:C:D<span class="o">]</span> <span class="o">[</span>-f str<span class="o">]</span> <span class="o">[</span>-m addr<span class="o">]</span> <span class="o">[</span>-n str<span class="o">]</span> <span class="o">[</span>-N m:M<span class="o">]</span> <span class="o">[</span>-P<span class="o">[</span>-P<span class="o">]</span> pdb<span class="o">]</span>
              <span class="o">[</span>-o str<span class="o">]</span> <span class="o">[</span>-O str<span class="o">]</span> <span class="o">[</span>-k query<span class="o">]</span> <span class="o">[</span>-D lang symname<span class="o">]</span> file
 -@ <span class="o">[</span>addr<span class="o">]</span>       show section, symbol or import at addr
 -A              list sub-binaries and their arch-bits pairs
 -a <span class="o">[</span>arch<span class="o">]</span>       <span class="nb">set</span> arch <span class="o">(</span>x86, arm, .. or &lt;arch&gt;_&lt;bits&gt;<span class="o">)</span>
 -b <span class="o">[</span>bits<span class="o">]</span>       <span class="nb">set</span> bits <span class="o">(</span><span class="m">32</span>, <span class="m">64</span> ...<span class="o">)</span>
 -B <span class="o">[</span>addr<span class="o">]</span>       override base address <span class="o">(</span>pie bins<span class="o">)</span>
 -c              list classes
 -cc             list classes <span class="k">in</span> header format
 -H              header fields
 -i              imports <span class="o">(</span>symbols imported from libraries<span class="o">)</span>
 -I              binary info
 -j              output <span class="k">in</span> json
 ...
</code></pre></div>
<p>Use the main <code>r2</code> utility to access the <strong>r2 shell</strong>. You can load DEX binaries just like any other binary:</p>
<div class="highlight"><pre><span></span><code>$ r2 classes.dex
</code></pre></div>
<p>Enter <code>r2 -h</code> to see all available options. A very commonly used flag is <code>-A</code>, which triggers an analysis after loading the target binary. However, this should be used sparingly and with small binaries as it is very time and resource consuming. You can learn more about this in the chapter "<a href="../0x05c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on Android</a>".</p>
<p>Once in the r2 shell, you can also access functions offered by the other radare2 utilities. For example, running <code>i</code> will print the information of the binary, exactly as <code>rabin2 -I</code> does.</p>
<p>To print all the strings use <code>rabin2 -Z</code> or the command <code>iz</code> (or the less verbose <code>izq</code>) from the r2 shell.</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; izq
0xc50 <span class="m">39</span> <span class="m">39</span> /dev/com.koushikdutta.superuser.daemon/
0xc79 <span class="m">25</span> <span class="m">25</span> /system/app/Superuser.apk
...
0xd23 <span class="m">44</span> <span class="m">44</span> <span class="nv">5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc</span><span class="o">=</span>
0xd51 <span class="m">32</span> <span class="m">32</span> 8d127684cbc37c17616d806cf50473cc
0xd76 <span class="m">6</span> <span class="m">6</span> &lt;init&gt;
0xd83 <span class="m">10</span> <span class="m">10</span> AES error:
0xd8f <span class="m">20</span> <span class="m">20</span> AES/ECB/PKCS7Padding
0xda5 <span class="m">18</span> <span class="m">18</span> App is debuggable!
0xdc0 <span class="m">9</span> <span class="m">9</span> CodeCheck
0x11ac <span class="m">7</span> <span class="m">7</span> Nope...
0x11bf <span class="m">14</span> <span class="m">14</span> Root detected!
</code></pre></div>
<p>Most of the time you can append special options to your commands such as <code>q</code> to make the command less verbose (quiet) or <code>j</code> to give the output in JSON format (use <code>~{}</code> to prettify the JSON string).</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; izj~<span class="o">{}</span>
<span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">&quot;vaddr&quot;</span>: <span class="m">3152</span>,
    <span class="s2">&quot;paddr&quot;</span>: <span class="m">3152</span>,
    <span class="s2">&quot;ordinal&quot;</span>: <span class="m">1</span>,
    <span class="s2">&quot;size&quot;</span>: <span class="m">39</span>,
    <span class="s2">&quot;length&quot;</span>: <span class="m">39</span>,
    <span class="s2">&quot;section&quot;</span>: <span class="s2">&quot;file&quot;</span>,
    <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;ascii&quot;</span>,
    <span class="s2">&quot;string&quot;</span>: <span class="s2">&quot;L2Rldi9jb20ua291c2hpa2R1dHRhLnN1cGVydXNlci5kYWVtb24v&quot;</span>
  <span class="o">}</span>,
  <span class="o">{</span>
    <span class="s2">&quot;vaddr&quot;</span>: <span class="m">3193</span>,
    <span class="s2">&quot;paddr&quot;</span>: <span class="m">3193</span>,
    <span class="s2">&quot;ordinal&quot;</span>: <span class="m">2</span>,
    <span class="s2">&quot;size&quot;</span>: <span class="m">25</span>,
    <span class="s2">&quot;length&quot;</span>: <span class="m">25</span>,
    <span class="s2">&quot;section&quot;</span>: <span class="s2">&quot;file&quot;</span>,
    <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;ascii&quot;</span>,
    <span class="s2">&quot;string&quot;</span>: <span class="s2">&quot;L3N5c3RlbS9hcHAvU3VwZXJ1c2VyLmFwaw==&quot;</span>
  <span class="o">}</span>,
</code></pre></div>
<p>You can print the class names and their methods with the r2 command <code>ic</code> (<em>information classes</em>).</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; ic
...
0x0000073c <span class="o">[</span>0x00000958 - 0x00000abc<span class="o">]</span>    <span class="m">356</span> class <span class="m">5</span> Lsg/vantagepoint/uncrackable1/MainActivity
:: Landroid/app/Activity<span class="p">;</span>
0x00000958 method <span class="m">0</span> pC   Lsg/vantagepoint/uncrackable1/MainActivity.method.&lt;init&gt;<span class="o">()</span>V
0x00000970 method <span class="m">1</span> P    Lsg/vantagepoint/uncrackable1/MainActivity.method.a<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)</span>V
0x000009c8 method <span class="m">2</span> r    Lsg/vantagepoint/uncrackable1/MainActivity.method.onCreate <span class="o">(</span>Landroid/os/Bundle<span class="p">;</span><span class="o">)</span>V
0x00000a38 method <span class="m">3</span> p    Lsg/vantagepoint/uncrackable1/MainActivity.method.verify <span class="o">(</span>Landroid/view/View<span class="p">;</span><span class="o">)</span>V
0x0000075c <span class="o">[</span>0x00000acc - 0x00000bb2<span class="o">]</span>    <span class="m">230</span> class <span class="m">6</span> Lsg/vantagepoint/uncrackable1/a :: Ljava/lang/Object<span class="p">;</span>
0x00000acc method <span class="m">0</span> sp   Lsg/vantagepoint/uncrackable1/a.method.a<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)</span>Z
0x00000b5c method <span class="m">1</span> sp   Lsg/vantagepoint/uncrackable1/a.method.b<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)[</span>B
</code></pre></div>
<p>You can print the imported methods with the r2 command <code>ii</code> (<em>information imports</em>).</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; ii
<span class="o">[</span>Imports<span class="o">]</span>
Num  Vaddr       Bind      Type Name
...
  <span class="m">29</span> 0x000005cc    NONE    FUNC Ljava/lang/StringBuilder.method.append<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)</span> Ljava/lang/StringBuilder<span class="p">;</span>
  <span class="m">30</span> 0x000005d4    NONE    FUNC Ljava/lang/StringBuilder.method.toString<span class="o">()</span>Ljava/lang/String<span class="p">;</span>
  <span class="m">31</span> 0x000005dc    NONE    FUNC Ljava/lang/System.method.exit<span class="o">(</span>I<span class="o">)</span>V
  <span class="m">32</span> 0x000005e4    NONE    FUNC Ljava/lang/System.method.getenv<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)</span>Ljava/lang/String<span class="p">;</span>
  <span class="m">33</span> 0x000005ec    NONE    FUNC Ljavax/crypto/Cipher.method.doFinal<span class="o">([</span>B<span class="o">)[</span>B
  <span class="m">34</span> 0x000005f4    NONE    FUNC Ljavax/crypto/Cipher.method.getInstance<span class="o">(</span>Ljava/lang/String<span class="p">;</span><span class="o">)</span> Ljavax/crypto/Cipher<span class="p">;</span>
  <span class="m">35</span> 0x000005fc    NONE    FUNC Ljavax/crypto/Cipher.method.init<span class="o">(</span>ILjava/security/Key<span class="p">;</span><span class="o">)</span>V
  <span class="m">36</span> 0x00000604    NONE    FUNC Ljavax/crypto/spec/SecretKeySpec.method.&lt;init&gt;<span class="o">([</span>BLjava/lang/String<span class="p">;</span><span class="o">)</span>V
</code></pre></div>
<p>A common approach when inspecting a binary is to search for something, navigate to it and visualize it in order to interpret the code. One of the ways to find something using radare2 is by filtering the output of specific commands, i.e. to grep them using <code>~</code> plus a keyword (<code>~+</code> for case-insensitive). For example, we might know that the app is verifying something, we can inspect all radare2 flags and see where we find something related to "verify".</p>
<blockquote>
<p>When loading a file, radare2 tags everything it's able to find. These tagged names or references are called flags. You can access them via the command <code>f</code>.</p>
</blockquote>
<p>In this case we will grep the flags using the keyword "verify":</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; f~+verify
0x00000a38 <span class="m">132</span> sym.Lsg_vantagepoint_uncrackable1_MainActivity.method. <span class="se">\</span>
verify_Landroid_view_View__V
0x00000a38 <span class="m">132</span> method.public.Lsg_vantagepoint_uncrackable1_MainActivity. <span class="se">\</span>
Lsg_vantagepoint_uncrackable1
        _MainActivity.method.verify_Landroid_view_View__V
0x00001400 <span class="m">6</span> str.verify
</code></pre></div>
<p>It seems that we've found one method in 0x00000a38 (that was tagged two times) and one string in 0x00001400. Let's navigate (seek) to that method by using its flag:</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x000009c8<span class="o">]</span>&gt; s sym.Lsg_vantagepoint_uncrackable1_MainActivity.method. <span class="se">\</span>
verify_Landroid_view_View__V
</code></pre></div>
<p>And of course you can also use the disassembler capabilities of r2 and print the disassembly with the command <code>pd</code> (or <code>pdf</code> if you know you're already located in a function).</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>0x00000a38<span class="o">]</span>&gt; pd
</code></pre></div>
<p>r2 commands normally accept options (see <code>pd?</code>), e.g. you can limit the opcodes displayed by appending a number ("N") to the command <code>pd N</code>.</p>
<p><img src="../../assets/Images/Chapters/0x05b/r2_pd_10.png" width="100%" /></p>
<p>Instead of just printing the disassembly to the console you may want to enter the so-called <strong>Visual Mode</strong> by typing <code>V</code>.</p>
<p><img src="../../assets/Images/Chapters/0x05b/r2_visualmode_hex.png" width="100%" /></p>
<p>By default, you will see the hexadecimal view. By typing <code>p</code> you can switch to different views, such as the disassembly view:</p>
<p><img src="../../assets/Images/Chapters/0x05b/r2_visualmode_disass.png" width="100%" /></p>
<p>Radare2 offers a <strong>Graph Mode</strong> that is very useful to follow the flow of the code. You can access it from the Visual Mode by typing <code>V</code>:</p>
<p><img src="../../assets/Images/Chapters/0x05b/r2_graphmode.png" width="100%" /></p>
<p>This is only a selection of some radare2 commands to start getting some basic information from Android binaries. Radare2 is very powerful and has dozens of commands that you can find on the <a href="https://book.rada.re/basic_commands/intro.html" title="radare2 command documentation">radare2 command documentation</a>. Radare2 will be used throughout the guide for different purposes such as reversing code, debugging or performing binary analysis. We will also use it in combination with other frameworks, especially Frida (see the r2frida section for more information).</p>
<p>Please refer to the chapter "<a href="../0x05c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on Android</a>" for more detailed use of radare2 on Android, especially when analyzing native libraries. You may also want to read the <a href="https://book.rada.re/" title="Radare2 book">official radare2 book</a>.</p>
<h4 id="radare2-ios">Radare2 (iOS)<a class="headerlink" href="#radare2-ios" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/radare/radare2" title="Radare2">Radare2</a> is a complete framework for reverse-engineering and analyzing binaries. The installation instructions can be found in the GitHub repository. To learn more on radare2 you may want to read the <a href="https://book.rada.re/" title="Radare2 book">official radare2 book</a>.</p>
<h3 id="rms-runtime-mobile-security">RMS Runtime Mobile Security<a class="headerlink" href="#rms-runtime-mobile-security" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security" title="Runtime Mobile Security (RMS)">RMS - Runtime Mobile Security</a> is a runtime mobile application analysis toolkit, supporting Android and iOS Apps. It offers a web GUI and is written in Python.</p>
<p>It's leveraging a running Frida server on a jailbroken device with the following out-of-box functionalities:</p>
<ul>
<li>Execute popular Frida scripts</li>
<li>Execute custom Frida scripts</li>
<li>Dump all the loaded classes and relative methods</li>
<li>Hook methods on the fly</li>
<li>(Android) Monitor Android APIs and usage of native APIs</li>
</ul>
<p>The installation instructions and "how-to guide" of RMS can be found in the <a href="https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security" title="Github Repo of RMS">Readme of the Github repo</a>.</p>
<h2 id="tools-for-android">Tools for Android<a class="headerlink" href="#tools-for-android" title="Permanent link">&para;</a></h2>
<h3 id="adb">Adb<a class="headerlink" href="#adb" title="Permanent link">&para;</a></h3>
<p><a href="https://developer.android.com/studio/command-line/adb" title="Android Debug Bridge">adb</a> (Android Debug Bridge), shipped with the Android SDK, bridges the gap between your local development environment and a connected Android device. You'll usually leverage it to test apps on the emulator or a connected device via USB or Wi-Fi. Use the <code>adb devices</code> command to list the connected devices and execute it with the <code>-l</code> argument to retrieve more details on them.</p>
<div class="highlight"><pre><span></span><code>$ adb devices -l
List of devices attached
090c285c0b97f748 device usb:1-1 product:razor model:Nexus_7 device:flo
emulator-5554    device product:sdk_google_phone_x86 model:Android_SDK_built_for_x86 device:generic_x86 transport_id:1
</code></pre></div>
<p>adb provides other useful commands such as <code>adb shell</code> to start an interactive shell on a target and <code>adb forward</code> to forward traffic on a specific host port to a different port on a connect device.</p>
<div class="highlight"><pre><span></span><code>$ adb forward tcp:&lt;host port&gt; tcp:&lt;device port&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code>$ adb -s emulator-5554 shell
root@generic_x86:/ <span class="c1"># ls</span>
acct
cache
charger
config
...
</code></pre></div>
<p>You'll come across different use cases on how you can use adb commands when testing later in this book. Note that you must define the serialnummer of the target device with the <code>-s</code> argument (as shown by the previous code snippet) in case you have multiple devices connected.</p>
<h3 id="android-ndk">Android NDK<a class="headerlink" href="#android-ndk" title="Permanent link">&para;</a></h3>
<p>The Android NDK contains prebuilt versions of the native compiler and toolchain. Both the GCC and Clang compilers have traditionally been supported, but active support for GCC ended with NDK revision 14. The device architecture and host OS determine the appropriate version. The prebuilt toolchains are in the <code>toolchains</code> directory of the NDK, which contains one subdirectory for each architecture.</p>
<table>
<thead>
<tr>
<th>Architecture</th>
<th>Toolchain name</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARM-based</td>
<td>arm-linux-androideabi-&lt;gcc-version&gt;</td>
</tr>
<tr>
<td>x86-based</td>
<td>x86-&lt;gcc-version&gt;</td>
</tr>
<tr>
<td>MIPS-based</td>
<td>mipsel-linux-android-&lt;gcc-version&gt;</td>
</tr>
<tr>
<td>ARM64-based</td>
<td>aarch64-linux-android-&lt;gcc-version&gt;</td>
</tr>
<tr>
<td>X86-64-based</td>
<td>x86_64-&lt;gcc-version&gt;</td>
</tr>
<tr>
<td>MIPS64-based</td>
<td>mips64el-linux-android-&lt;gcc-version&gt;</td>
</tr>
</tbody>
</table>
<p>Besides picking the right architecture, you need to specify the correct sysroot for the native API level you want to target. The sysroot is a directory that contains the system headers and libraries for your target. Native APIs vary by Android API level. Available sysroot directories for each Android API level can be found in <code>$NDK/platforms/</code>. Each API level directory contains subdirectories for the various CPUs and architectures.</p>
<p>One possibility for setting up the build system is exporting the compiler path and necessary flags as environment variables. To make things easier, however, the NDK allows you to create a so-called standalone toolchain, which is a temporary toolchain that incorporates the required settings.</p>
<p>To set up a standalone toolchain, download the <a href="https://developer.android.com/ndk/downloads/index.html#stable-downloads" title="Android NDK Downloads">latest stable version of the NDK</a>. Extract the ZIP file, change into the NDK root directory, and run the following command:</p>
<div class="highlight"><pre><span></span><code>$ ./build/tools/make_standalone_toolchain.py --arch arm --api <span class="m">24</span> --install-dir /tmp/android-7-toolchain
</code></pre></div>
<p>This creates a standalone toolchain for Android 7.0 (API level 24) in the directory <code>/tmp/android-7-toolchain</code>. For convenience, you can export an environment variable that points to your toolchain directory, (we'll be using this in the examples). Run the following command or add it to your <code>.bash_profile</code> or other startup script:</p>
<div class="highlight"><pre><span></span><code>$  <span class="nb">export</span> <span class="nv">TOOLCHAIN</span><span class="o">=</span>/tmp/android-7-toolchain
</code></pre></div>
<h3 id="android-sdk">Android SDK<a class="headerlink" href="#android-sdk" title="Permanent link">&para;</a></h3>
<p>Local Android SDK installations are managed via Android Studio. Create an empty project in Android Studio and select <strong>Tools</strong> -&gt; <strong>SDK Manager</strong> to open the SDK Manager GUI. The <strong>SDK Platforms</strong> tab is where you install SDKs for multiple API levels. Recent API levels are:</p>
<ul>
<li>Android 11.0 (API level 30)</li>
<li>Android 10.0 (API level 29)</li>
<li>Android 9.0 (API level 28)</li>
<li>Android 8.1 (API level 27)</li>
<li>Android 8.0 (API level 26)</li>
</ul>
<p>An overview of all Android codenames, their version number and API levels can be found in the <a href="https://source.android.com/setup/start/build-numbers" title="Codenames, Tags, and Build Numbers">Android Developer Documentation</a>.</p>
<p><img src="../../assets/Images/Chapters/0x05c/sdk_manager.jpg" width="100%" /></p>
<p>Installed SDKs are on the following paths:</p>
<p>Windows:</p>
<div class="highlight"><pre><span></span><code>C:<span class="se">\U</span>sers<span class="se">\&lt;</span>username&gt;<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\A</span>ndroid<span class="se">\s</span>dk
</code></pre></div>
<p>MacOS:</p>
<div class="highlight"><pre><span></span><code>/Users/&lt;username&gt;/Library/Android/sdk
</code></pre></div>
<p>Note: On Linux, you need to choose an SDK directory. <code>/opt</code>, <code>/srv</code>, and <code>/usr/local</code> are common choices.</p>
<h3 id="android-studio">Android Studio<a class="headerlink" href="#android-studio" title="Permanent link">&para;</a></h3>
<p>The official IDE for Google's Android operating system, built on JetBrains' IntelliJ IDEA software and designed specifically for Android development - <a href="https://developer.android.com/studio/index.html">https://developer.android.com/studio/index.html</a></p>
<h3 id="android-ssl-trustkiller">Android-SSL-TrustKiller<a class="headerlink" href="#android-ssl-trustkiller" title="Permanent link">&para;</a></h3>
<p>Android-SSL-TrustKiller is a Cydia Substrate Module acting as a blackbox tool to bypass SSL certificate pinning for most applications running on a device - <a href="https://github.com/iSECPartners/Android-SSL-TrustKiller">https://github.com/iSECPartners/Android-SSL-TrustKiller</a></p>
<h3 id="apktool">Apktool<a class="headerlink" href="#apktool" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/iBotPeaches/Apktool">Apktool</a> is used to unpack Android app packages (APKs). Simply unzipping APKs with the standard <code>unzip</code> utility leaves some files unreadable. <code>AndroidManifest.xml</code> is encoded into binary XML format which isn’t readable with a text editor. Also, the app resources are still packaged into a single archive file.</p>
<p>When run with default command line flags, apktool automatically decodes the Android Manifest file to text-based XML format and extracts the file resources (it also disassembles the .DEX files to smali code - a feature that we’ll revisit later in this book).</p>
<p>Among the unpacked files you can usually find (after running <code>apktool d base.apk</code>):</p>
<ul>
<li>AndroidManifest.xml: The decoded Android Manifest file, which can be opened and edited in a text editor.</li>
<li>apktool.yml: file containing information about the output of apktool</li>
<li>original: folder containing the MANIFEST.MF file, which contains information about the files contained in the JAR file</li>
<li>res: directory containing the app’s resources</li>
<li>smali: directory containing the disassembled Dalvik bytecode.</li>
</ul>
<p>You can also use apktool to repackage decoded resources back to binary APK/JAR. See the section "<a href="#exploring-the-app-package" title="Exploring the App Package">Exploring the App Package</a>" later on this chapter and section "<a href="../0x05c-Reverse-Engineering-and-Tampering/#repackaging" title="Repackaging">Repackaging</a>" in the chapter <a href="../0x05c-Reverse-Engineering-and-Tampering/">Tampering and Reverse Engineering on Android</a> for more information and practical examples.</p>
<h3 id="apkx">apkx<a class="headerlink" href="#apkx" title="Permanent link">&para;</a></h3>
<p>apkx is a Python wrapper to popular free DEX converters and Java decompilers. It automates the extraction, conversion, and decompilation of APKs. Install it as follows:</p>
<div class="highlight"><pre><span></span><code>$ git clone https://github.com/b-mueller/apkx
$ <span class="nb">cd</span> apkx
$ sudo ./install.sh
</code></pre></div>
<p>This should copy apkx to <code>/usr/local/bin</code>. See section "<a href="../0x05c-Reverse-Engineering-and-Tampering/#decompiling-java-code" title="Decompiling Java Code">Decompiling Java Code</a>" of the "Reverse Engineering and Tampering" chapter for more information about usage.</p>
<h3 id="busybox">Busybox<a class="headerlink" href="#busybox" title="Permanent link">&para;</a></h3>
<p>Busybox combines multiple common Unix utilities into a small single executable. The utilities included generally have fewer options than their full-featured GNU counterparts, but are sufficient enough to provide a complete environment on a small or embedded system. Busybox can be installed on a rooted device by downloading the Busybox application from Google Play Store. You can also download the binary directly from the <a href="https://busybox.net" title="Busybox Website">Busybox website</a>. Once downloaded, make an <code>adb push busybox /data/local/tmp</code> to have the executable available on your phone. A quick overview of how to install and use Busybox can be found in the <a href="https://busybox.net/FAQ.html#getting_started" title="Busybox FAQ">Busybox FAQ</a>.</p>
<h3 id="bytecode-viewer">Bytecode Viewer<a class="headerlink" href="#bytecode-viewer" title="Permanent link">&para;</a></h3>
<p><a href="https://bytecodeviewer.com/" title="Bytecode Viewer">Bytecode Viewer</a> (BCV) is a free and open source Java decompiler framework running on all operating systems. It is a versatile tool which can be used to decompile Android apps, view APK resources (via apktool) and easily edit APKs (via Smali/Baksmali). Apart from APKs, also DEX, Java Class files and Java Jars can be viewed. One of its major features is the support for multiple Java bytecode decompilers under one GUI. BCV currently includes the Procyon, CFR, Fernflower, Krakatau, and JADX-Core decompilers. These decompilers have different strengths and can be easily leveraged while using BCV, especially when dealing with obfuscated programs.</p>
<h3 id="drozer">Drozer<a class="headerlink" href="#drozer" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/FSecureLABS/drozer" title="Drozer on GitHub">Drozer</a> is an Android security assessment framework that allows you to search for security vulnerabilities in apps and devices by assuming the role of a third-party app interacting with the other application's IPC endpoints and the underlying OS.</p>
<p>The advantage of using drozer consists on its ability to automate several tasks and that it can be expanded through modules. The modules are very helpful and they cover different categories including a scanner category that allows you to scan for known defects with a simple command such as the module <code>scanner.provider.injection</code> which detects SQL injections in content providers in all the apps installed in the system. Without drozer, simple tasks such as listing the app's permissions require several steps that include decompiling the APK and manually analyzing the results.</p>
<h4 id="installing-drozer">Installing Drozer<a class="headerlink" href="#installing-drozer" title="Permanent link">&para;</a></h4>
<p>You can refer to <a href="https://github.com/FSecureLABS/drozer" title="Drozer on GitHub">drozer GitHub page</a> (for Linux and Windows, for macOS please refer to this <a href="https://fi5t.xyz/en/posts/drozer-on-mac/" title="(not)Unique experience blog - Installing Drozer on macOS Catalina">blog post</a>) and the <a href="https://labs.f-secure.com/tools/drozer/" title="Drozer Website">drozer website</a> for prerequisites and installation instructions.</p>
<h4 id="using-drozer">Using Drozer<a class="headerlink" href="#using-drozer" title="Permanent link">&para;</a></h4>
<p>Before you can start using drozer, you'll also need the drozer agent that runs on the Android device itself. Download the latest drozer agent <a href="https://github.com/FSecureLABS/drozer/releases/" title="drozer GitHub releases">from the GitHub releases page</a> and install it with <code>adb install drozer.apk</code>.</p>
<p>Once the setup is completed you can start a session to an emulator or a device connected per USB by running <code>adb forward tcp:31415 tcp:31415</code> and <code>drozer console connect</code>. This is called direct mode and you can see the full instructions in the <a href="https://labs.f-secure.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf" title="Starting a Session">User Guide in section "Starting a Session"</a>. An alternative is to run Drozer in infrastructure mode, where, you are running a drozer server that can handle multiple consoles and agents, and routes sessions between them. You can find the details of how to setup drozer in this mode in the <a href="https://labs.f-secure.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf" title="Infrastructure Mode">"Infrastructure Mode"</a> section of the User Guide.</p>
<p>Now you are ready to begin analyzing apps. A good first step is to enumerate the attack surface of an app which can be done easily with the following command:</p>
<div class="highlight"><pre><span></span><code>$ dz&gt; run app.package.attacksurface &lt;package&gt;
</code></pre></div>
<p>Again, without drozer this would have required several steps. The module <code>app.package.attacksurface</code> lists activities, broadcast receivers, content providers and services that are exported, hence, they are public and can be accessed through other apps. Once we have identified our attack surface, we can interact with the IPC endpoints through drozer without having to write a separate standalone app as it would be required for certain tasks such as communicating with a content provider.</p>
<p>For example, if the app has an exported Activity that leaks sensitive information we can invoke it with the Drozer module <code>app.activity.start</code>:</p>
<div class="highlight"><pre><span></span><code>$ dz&gt; run app.activity.start --component &lt;package&gt; &lt;component name&gt;
</code></pre></div>
<p>This previous command will start the activity, hopefully leaking some sensitive information. Drozer has modules for every type of IPC mechanism. Download <a href="https://github.com/dineshshetty/Android-InsecureBankv2" title="InsecureBankv2 APK">InsecureBankv2</a> if you would like to try the modules with an intentionally vulnerable application that illustrates common problems related to IPC endpoints. Pay close attention to the modules in the scanner category as they are very helpful automatically detecting vulnerabilities even in system packages, specially if you are using a ROM provided by your cellphone company. Even <a href="https://issuetracker.google.com/u/0/issues/36965126" title="SQL injection in Android">SQL injection vulnerabilities in system packages by Google</a> have been identified in the past with drozer.</p>
<h4 id="other-drozer-commands">Other Drozer commands<a class="headerlink" href="#other-drozer-commands" title="Permanent link">&para;</a></h4>
<p>Here's a non-exhaustive list of commands you can use to start exploring on Android:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># List all the installed packages</span>
$ dz&gt; run app.package.list

<span class="c1"># Find the package name of a specific app</span>
$ dz&gt; run app.package.list -f <span class="o">(</span>string to be searched<span class="o">)</span>

<span class="c1"># See basic information</span>
$ dz&gt; run app.package.info -a <span class="o">(</span>package name<span class="o">)</span>

<span class="c1"># Identify the exported application components</span>
$ dz&gt; run app.package.attacksurface <span class="o">(</span>package name<span class="o">)</span>

<span class="c1"># Identify the list of exported Activities</span>
$ dz&gt; run app.activity.info -a <span class="o">(</span>package name<span class="o">)</span>

<span class="c1"># Launch the exported Activities</span>
$ dz&gt; run app.activity.start --component <span class="o">(</span>package name<span class="o">)</span> <span class="o">(</span>component name<span class="o">)</span>

<span class="c1"># Identify the list of exported Broadcast receivers</span>
$ dz&gt; run app.broadcast.info -a <span class="o">(</span>package name<span class="o">)</span>

<span class="c1"># Send a message to a Broadcast receiver</span>
$ dz&gt; run app.broadcast.send --action <span class="o">(</span>broadcast receiver name<span class="o">)</span> -- extra <span class="o">(</span>number of arguments<span class="o">)</span>

<span class="c1"># Detect SQL injections in content providers</span>
$ dz&gt; run scanner.provider.injection -a <span class="o">(</span>package name<span class="o">)</span>
</code></pre></div>
<h4 id="other-drozer-resources">Other Drozer resources<a class="headerlink" href="#other-drozer-resources" title="Permanent link">&para;</a></h4>
<p>Other resources where you might find useful information are:</p>
<ul>
<li><a href="https://labs.f-secure.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf" title="Drozer User Guide">Official drozer User Guide</a>.</li>
<li><a href="https://github.com/FSecureLABS/drozer" title="GitHub repo">drozer GitHub page</a></li>
<li><a href="https://github.com/FSecureLABS/drozer/wiki" title="drozer Wiki">drozer Wiki</a></li>
</ul>
<h3 id="gplaycli">gplaycli<a class="headerlink" href="#gplaycli" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/matlink/gplaycli" title="gplaycli">gplaycli</a> is a Python based CLI tool to search, install and update Android applications from the Google Play Store. Follow the <a href="https://github.com/matlink/gplaycli#installation" title="gplaycli Installation">installation steps</a> and you're ready to run it. gplaycli offers several options, please refer to its help (<code>-h</code>) for more information.</p>
<p>If you're unsure about the package name (or AppID) of an app, you may perform a keyword based search for APKs (<code>-s</code>):</p>
<div class="highlight"><pre><span></span><code>$ gplaycli -s <span class="s2">&quot;google keep&quot;</span>

Title                          Creator     Size      Last Update  AppID                                    Version

Google Keep - notes and lists  Google LLC  <span class="m">15</span>.78MB   <span class="m">4</span> Sep <span class="m">2019</span>   com.google.android.keep                  <span class="m">193510330</span>
Maps - Navigate <span class="p">&amp;</span> Explore      Google LLC  <span class="m">35</span>.25MB   <span class="m">16</span> May <span class="m">2019</span>  com.google.android.apps.maps             <span class="m">1016200134</span>
Google                         Google LLC  <span class="m">82</span>.57MB   <span class="m">30</span> Aug <span class="m">2019</span>  com.google.android.googlequicksearchbox  <span class="m">301008048</span>
</code></pre></div>
<blockquote>
<p>Note that regional (Google Play) restrictions apply when using gplaycli. In order to access apps that are restricted in your country you can use alternative app stores such as the ones described in "<a href="#alternative-app-stores" title="Alternative App Stores">Alternative App Stores</a>".</p>
</blockquote>
<h3 id="house">House<a class="headerlink" href="#house" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/nccgroup/house" title="House">House</a> is a runtime mobile application analysis toolkit for Android apps, developed and maintained by the NCC Group and is written in Python.</p>
<p>It's leveraging a running Frida server on a rooted device or the Frida gadget in a repackaged Android app. The intention of House is to allow an easy way of prototyping Frida scripts via its convenient web GUI.</p>
<p>The installation instructions and "how-to guide" of House can be found in the <a href="https://github.com/nccgroup/house" title="Github Repo of House">Readme of the Github repo</a>.</p>
<h3 id="inspeckage">Inspeckage<a class="headerlink" href="#inspeckage" title="Permanent link">&para;</a></h3>
<p>A tool developed to offer dynamic analysis of Android apps. By applying hooks to functions of the Android API, Inspeckage helps to understand what an Android application is doing at runtime - <a href="https://github.com/ac-pm/Inspeckage">https://github.com/ac-pm/Inspeckage</a></p>
<h3 id="jadx">jadx<a class="headerlink" href="#jadx" title="Permanent link">&para;</a></h3>
<p>jadx (Dex to Java Decompiler) is a command line and <a href="https://github.com/skylot/jadx/wiki/jadx-gui-features-overview" title="jadx gui features overview">GUI tool</a> for producing Java source code from Android DEX and APK files - <a href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a></p>
<h3 id="jdb">jdb<a class="headerlink" href="#jdb" title="Permanent link">&para;</a></h3>
<p>A Java Debugger which allows to set breakpoints and print application variables. jdb uses the JDWP protocol - <a href="https://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html">https://docs.oracle.com/javase/7/docs/technotes/tools/windows/jdb.html</a></p>
<h3 id="justtrustme">JustTrustMe<a class="headerlink" href="#justtrustme" title="Permanent link">&para;</a></h3>
<p>An Xposed Module to bypass SSL certificate pinning - <a href="https://github.com/Fuzion24/JustTrustMe">https://github.com/Fuzion24/JustTrustMe</a></p>
<h3 id="magisk">Magisk<a class="headerlink" href="#magisk" title="Permanent link">&para;</a></h3>
<p><code>Magisk</code> ("Magic Mask") is one way to root your Android device. It's specialty lies in the way the modifications on the system are performed. While other rooting tools alter the actual data on the system partition, Magisk does not (which is called "systemless"). This enables a way to hide the modifications from root-sensitive applications (e.g. for banking or games) and allows using the official Android OTA upgrades without the need to unroot the device beforehand.</p>
<p>You can get familiar with Magisk reading the official <a href="https://topjohnwu.github.io/Magisk/" title="Magisk Documentation">documentation on GitHub</a>. If you don't have Magisk installed, you can find installation instructions in <a href="https://topjohnwu.github.io/Magisk/install.html" title="Magisk Installation">the documentation</a>. If you use an official Android version and plan to upgrade it, Magisk provides a <a href="https://topjohnwu.github.io/Magisk/ota.html" title="OTA Installation">tutorial on GitHub</a>.</p>
<p>Learn more about <a href="#rooting-with-magisk" title="Rooting with Magisk">rooting your device with Magisk</a>.</p>
<h3 id="proguard">Proguard<a class="headerlink" href="#proguard" title="Permanent link">&para;</a></h3>
<p><a href="https://www.guardsquare.com/en/products/proguard" title="ProGuard">ProGuard</a> is a free Java class file shrinker, optimizer, obfuscator, and preverifier. It detects and removes unused classes, fields, methods, and attributes and can also be used to delete logging-related code.</p>
<h3 id="rootcloak-plus">RootCloak Plus<a class="headerlink" href="#rootcloak-plus" title="Permanent link">&para;</a></h3>
<p>A Cydia Substrate Module used to check for commonly known indications of root - <a href="https://github.com/devadvance/rootcloakplus">https://github.com/devadvance/rootcloakplus</a></p>
<h3 id="scrcpy">Scrcpy<a class="headerlink" href="#scrcpy" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/Genymobile/scrcpy" title="Scrcpy">Scrcpy</a> provides display and control of Android devices connected over USB (or <a href="https://www.genymotion.com/blog/open-source-project-scrcpy-now-works-wirelessly/" title="Scrcpy now works wirelessly">TCP/IP</a>). It does not require any root access and it works on GNU/Linux, Windows and macOS.</p>
<h3 id="sslunpinning">SSLUnpinning<a class="headerlink" href="#sslunpinning" title="Permanent link">&para;</a></h3>
<p>An Xposed Module to bypass SSL certificate pinning - <a href="https://github.com/ac-pm/SSLUnpinning_Xposed">https://github.com/ac-pm/SSLUnpinning_Xposed</a></p>
<h3 id="termux">Termux<a class="headerlink" href="#termux" title="Permanent link">&para;</a></h3>
<p>Termux is a terminal emulator for Android that provides a Linux environment that works directly with or without rooting and with no setup required. The installation of additional packages is a trivial task thanks to its own APT package manager (which makes a difference in comparison to other terminal emulator apps). You can search for specific packages by using the command <code>pkg search &lt;pkg_name&gt;</code> and install packages with <code>pkg install &lt;pkg_name&gt;</code>. You can install Termux straight from <a href="https://play.google.com/store/apps/details?id=com.termux" title="Install Termux">Google Play</a>.</p>
<h3 id="xposed">Xposed<a class="headerlink" href="#xposed" title="Permanent link">&para;</a></h3>
<p><a href="http://repo.xposed.info/module/de.robv.android.xposed.installer" title="Xposed Installer">Xposed</a> is a framework that allows to modify the system or application aspect and behavior at runtime, without modifying any Android application package (APK) or re-flashing. Technically, it is an extended version of Zygote that exports APIs for running Java code when a new process is started. Running Java code in the context of the newly instantiated app makes it possible to resolve, hook, and override Java methods belonging to the app. Xposed uses <a href="https://docs.oracle.com/javase/tutorial/reflect/" title="Reflection Tutorial">reflection</a> to examine and modify the running app. Changes are applied in memory and persist only during the process' runtime since the application binaries are not modified.</p>
<p>To use Xposed, you need to first install the Xposed framework on a rooted device as explained on <a href="https://www.xda-developers.com/xposed-framework-hub/" title="Xposed framework hub from XDA">XDA-Developers Xposed framework hub</a>. Modules can be installed through the Xposed Installer app, and they can be toggled on and off through the GUI.</p>
<p>Note: given that a plain installation of the Xposed framework is easily detected with SafetyNet, we recommend using Magisk to install Xposed. This way, applications with SafetyNet attestation should have a higher chance of being testable with Xposed modules.</p>
<p>Xposed has been compared to Frida. When you run Frida server on a rooted device, you will end up with a similarly effective setup. Both frameworks deliver a lot of value when you want to do dynamic instrumentation. When Frida crashes the app, you can try something similar with Xposed. Next, similar to the abundance of Frida scripts, you can easily use one of the many modules that come with Xposed, such as the earlier discussed module to bypass SSL pinning (<a href="https://github.com/Fuzion24/JustTrustMe" title="JustTrustMe">JustTrustMe</a> and <a href="https://github.com/ac-pm/SSLUnpinning_Xposed" title="SSL Unpinning">SSLUnpinning</a>). Xposed includes other modules, such as <a href="https://github.com/ac-pm/Inspeckage" title="Inspeckage">Inspeckage</a> which allow you to do more in depth application testing as well. On top of that, you can create your own modules as well to patch often used security mechanisms of Android applications.</p>
<p>Xposed can also be installed on an emulator through the following script:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="nb">echo</span> <span class="s2">&quot;Start your emulator with &#39;emulator -avd NAMEOFX86A8.0 -writable-system -selinux permissive -wipe-data&#39;&quot;</span>
adb root <span class="o">&amp;&amp;</span> adb remount
adb install SuperSU<span class="se">\ </span>v2.79.apk <span class="c1">#binary can be downloaded from http://www.supersu.com/download</span>
adb push root_avd-master/SuperSU/x86/su /system/xbin/su
adb shell chmod <span class="m">0755</span> /system/xbin/su
adb shell setenforce <span class="m">0</span>
adb shell su --install
adb shell su --daemon<span class="p">&amp;</span>
adb push busybox /data/busybox <span class="c1">#binary can be downloaded from https://busybox.net/</span>
<span class="c1"># adb shell &quot;mount -o remount,rw /system &amp;&amp; mv /data/busybox /system/bin/busybox &amp;&amp; chmod 755 /system/bin/busybox &amp;&amp; /system/bin/busybox --install /system/bin&quot;</span>
adb shell chmod <span class="m">755</span> /data/busybox
adb shell <span class="s1">&#39;sh -c &quot;./data/busybox --install /data&quot;&#39;</span>
adb shell <span class="s1">&#39;sh -c &quot;mkdir /data/xposed&quot;&#39;</span>
adb push xposed8.zip /data/xposed/xposed.zip <span class="c1">#can be downloaded from https://dl-xda.xposed.info/framework/</span>
adb shell chmod <span class="m">0755</span> /data/xposed
adb shell <span class="s1">&#39;sh -c &quot;./data/unzip /data/xposed/xposed.zip -d /data/xposed/&quot;&#39;</span>
adb shell <span class="s1">&#39;sh -c &quot;cp /data/xposed/xposed/META-INF/com/google/android/*.* /data/xposed/xposed/&quot;&#39;</span>
<span class="nb">echo</span> <span class="s2">&quot;Now adb shell and do &#39;su&#39;, next: go to ./data/xposed/xposed, make flash-script.sh executable and run it in that directory after running SUperSU&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Next, restart emulator&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Next, adb install XposedInstaller_3.1.5.apk&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Next, run installer and then adb reboot&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Want to use it again? Start your emulator with &#39;emulator -avd NAMEOFX86A8.0 -writable-system -selinux permissive&#39;&quot;</span>
</code></pre></div>
<p>Please note that Xposed, at the time of this writing, does not work on Android 9 (API level 28). However, it was unofficially ported in 2019 under the name EdXposed, supporting Android 8-10 (API level 26 till 29). You can find the code and usage examples at <a href="https://github.com/ElderDrivers/EdXposed" title="EdXposed">EdXposed</a> Github repo.</p>
<h2 id="tools-for-ios">Tools for iOS<a class="headerlink" href="#tools-for-ios" title="Permanent link">&para;</a></h2>
<h3 id="bfinject">bfinject<a class="headerlink" href="#bfinject" title="Permanent link">&para;</a></h3>
<p>A tool that loads arbitrary dylibs into running App Store apps. It has built-in support for decrypting App Store apps, and comes bundled with iSpy and Cycript - <a href="https://github.com/BishopFox/bfinject">https://github.com/BishopFox/bfinject</a></p>
<h3 id="binarycookiereader">BinaryCookieReader<a class="headerlink" href="#binarycookiereader" title="Permanent link">&para;</a></h3>
<p>A tool to dump all the cookies from the binary Cookies.binarycookies file - <a href="https://github.com/as0ler/BinaryCookieReader/blob/master/BinaryCookieReader.py">https://github.com/as0ler/BinaryCookieReader/blob/master/BinaryCookieReader.py</a></p>
<h3 id="burp-suite-mobile-assistant">Burp Suite Mobile Assistant<a class="headerlink" href="#burp-suite-mobile-assistant" title="Permanent link">&para;</a></h3>
<p>A tool to bypass certificate pinning and is able to inject into apps - <a href="https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant">https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant</a></p>
<h3 id="class-dump">class-dump<a class="headerlink" href="#class-dump" title="Permanent link">&para;</a></h3>
<p><a href="http://stevenygard.com/projects/class-dump/" title="class-dump">class-dump by Steve Nygard</a> is a command line utility for examining the Objective-C runtime information stored in Mach-O (Mach object) files. It generates declarations for the classes, categories, and protocols.</p>
<h3 id="class-dump-z">class-dump-z<a class="headerlink" href="#class-dump-z" title="Permanent link">&para;</a></h3>
<p><a href="https://code.google.com/archive/p/networkpx/wikis/class_dump_z.wiki" title="class-dump-z">class-dump-z</a> is class-dump re-written from scratch in C++, avoiding the use of dynamic calls. Removing these unnecessary calls makes class-dump-z nearly 10 times faster than its predecessor.</p>
<h3 id="class-dump-dyld">class-dump-dyld<a class="headerlink" href="#class-dump-dyld" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/limneos/classdump-dyld/" title="class-dump-dyld">class-dump-dyld by Elias Limneos</a> allows symbols to be dumped and retrieved directly from the shared cache, eliminating the necessity of extracting the files first. It can generate header files from app binaries, libraries, frameworks, bundles, or the whole dyld_shared_cache. Directories or the entirety of dyld_shared_cache can be recursively mass-dumped.</p>
<h3 id="clutch">Clutch<a class="headerlink" href="#clutch" title="Permanent link">&para;</a></h3>
<p>Clutch decrypts iOS applications and dumps specified bundleID into binary or IPA file - <a href="https://github.com/KJCracks/Clutch">https://github.com/KJCracks/Clutch</a></p>
<h3 id="cyberduck">Cyberduck<a class="headerlink" href="#cyberduck" title="Permanent link">&para;</a></h3>
<p>Libre FTP, SFTP, WebDAV, S3, Azure &amp; OpenStack Swift browser for Mac and Windows - <a href="https://cyberduck.io">https://cyberduck.io</a></p>
<h3 id="cycript">Cycript<a class="headerlink" href="#cycript" title="Permanent link">&para;</a></h3>
<p>Cydia Substrate (formerly called MobileSubstrate) is the standard framework for developing Cydia runtime patches (the so-called "Cydia Substrate Extensions") on iOS. It comes with Cynject, a tool that provides code injection support for C.</p>
<p>Cycript is a scripting language developed by Jay Freeman (aka Saurik). It injects a JavaScriptCore VM into a running process. Via the Cycript interactive console, users can then manipulate the process with a hybrid Objective-C++ and JavaScript syntax. Accessing and instantiating Objective-C classes inside a running process is also possible.</p>
<p>In order to install Cycript, first download, unpack, and install the SDK.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#on iphone</span>
$ wget https://cydia.saurik.com/api/latest/3 -O cycript.zip <span class="o">&amp;&amp;</span> unzip cycript.zip
$ sudo cp -a Cycript.lib/*.dylib /usr/lib
$ sudo cp -a Cycript.lib/cycript-apl /usr/bin/cycript
</code></pre></div>
<p>To spawn the interactive Cycript shell, run "./cycript" or "cycript" if Cycript is on your path.</p>
<div class="highlight"><pre><span></span><code>$ cycript
cy#
</code></pre></div>
<p>To inject into a running process, we first need to find the process ID (PID). Run the application and make sure the app is in the foreground. Running <code>cycript -p &lt;PID&gt;</code> injects Cycript into the process. To illustrate, we will inject into SpringBoard (which is always running).</p>
<div class="highlight"><pre><span></span><code>$ ps -ef <span class="p">|</span> grep SpringBoard
<span class="m">501</span> <span class="m">78</span> <span class="m">1</span> <span class="m">0</span> <span class="m">0</span>:00.00 ?? <span class="m">0</span>:10.57 /System/Library/CoreServices/SpringBoard.app/SpringBoard
$ ./cycript -p <span class="m">78</span>
cy#
</code></pre></div>
<p>One of the first things you can try out is to get the application instance (<code>UIApplication</code>), you can use Objective-C syntax:</p>
<div class="highlight"><pre><span></span><code>cy# <span class="o">[</span>UIApplication sharedApplication<span class="o">]</span>
cy# var <span class="nv">a</span> <span class="o">=</span> <span class="o">[</span>UIApplication sharedApplication<span class="o">]</span>
</code></pre></div>
<p>Use that variable now to get the application's delegate class:</p>
<div class="highlight"><pre><span></span><code>cy# a.delegate
</code></pre></div>
<p>Let's try to trigger an alert message on SpringBoard with Cycript.</p>
<div class="highlight"><pre><span></span><code>cy# <span class="nv">alertView</span> <span class="o">=</span> <span class="o">[[</span>UIAlertView alloc<span class="o">]</span> initWithTitle:@<span class="s2">&quot;OWASP MSTG&quot;</span> message:@<span class="s2">&quot;Mobile Security Testing Guide&quot;</span>  delegate:nil cancelButtonitle:@<span class="s2">&quot;OK&quot;</span> otherButtonTitles:nil<span class="o">]</span>
<span class="c1">#&quot;&lt;UIAlertView: 0x1645c550; frame = (0 0; 0 0); layer = &lt;CALayer: 0x164df160&gt;&gt;&quot;</span>
cy# <span class="o">[</span>alertView show<span class="o">]</span>
cy# <span class="o">[</span>alertView release<span class="o">]</span>
</code></pre></div>
<p><img src="../../assets/Images/Chapters/0x06c/cycript_sample.png" width="400px" /></p>
<p>Find the app's document directory with Cycript:</p>
<div class="highlight"><pre><span></span><code>cy# <span class="o">[[</span>NSFileManager defaultManager<span class="o">]</span> URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask<span class="o">][</span><span class="m">0</span><span class="o">]</span>
<span class="c1">#&quot;file:///var/mobile/Containers/Data/Application/A8AE15EE-DC8B-4F1C-91A5-1FED35212DF/Documents/&quot;</span>
</code></pre></div>
<p>The command <code>[[UIApp keyWindow] recursiveDescription].toString()</code> returns the view hierarchy of <code>keyWindow</code>. The description of every subview and sub-subview of <code>keyWindow</code> is shown. The indentation space reflects the relationships between views. For example, <code>UILabel</code>, <code>UITextField</code>, and <code>UIButton</code> are subviews of <code>UIView</code>.</p>
<div class="highlight"><pre><span></span><code>cy# [[UIApp keyWindow] recursiveDescription].toString()
`<span class="nt">&lt;UIWindow:</span> <span class="err">0x16e82190;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">0;</span> <span class="err">320</span> <span class="err">568);</span> <span class="na">gestureRecognizers =</span> <span class="s">&lt;NSArray:</span> <span class="err">0x16e80ac0</span><span class="nt">&gt;</span>; layer = <span class="nt">&lt;UIWindowLayer:</span> <span class="err">0x16e63ce0</span><span class="nt">&gt;</span>&gt;
  | <span class="nt">&lt;UIView:</span> <span class="err">0x16e935f0;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">0;</span> <span class="err">320</span> <span class="err">568);</span> <span class="na">autoresize =</span> <span class="s">W+H;</span> <span class="na">layer =</span> <span class="s">&lt;CALayer:</span> <span class="err">0x16e93680</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;UILabel:</span> <span class="err">0x16e8f840;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">40;</span> <span class="err">82</span> <span class="err">20.5);</span> <span class="na">text =</span> <span class="s">&#39;i am groot!&#39;</span><span class="err">;</span> <span class="na">hidden =</span> <span class="s">YES;</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">autoresize =</span> <span class="s">RM+BM;</span> <span class="na">userInteractionEnabled =</span> <span class="s">NO;</span> <span class="na">layer =</span> <span class="s">&lt;_UILabelLayer:</span> <span class="err">0x16e8f920</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;UILabel:</span> <span class="err">0x16e8e030;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">110.5;</span> <span class="err">320</span> <span class="err">20.5);</span> <span class="na">text =</span> <span class="s">&#39;A Secret Is Found In The ...&#39;</span><span class="err">;</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">autoresize =</span> <span class="s">RM+BM;</span> <span class="na">userInteractionEnabled =</span> <span class="s">NO;</span> <span class="na">layer =</span> <span class="s">&lt;_UILabelLayer:</span> <span class="err">0x16e8e290</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;UITextField:</span> <span class="err">0x16e8fbd0;</span> <span class="na">frame =</span> <span class="s">(8</span> <span class="err">141;</span> <span class="err">304</span> <span class="err">30);</span> <span class="na">text =</span> <span class="s">&#39;&#39;</span><span class="err">;</span> <span class="na">clipsToBounds =</span> <span class="s">YES;</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">autoresize =</span> <span class="s">RM+BM;</span> <span class="na">gestureRecognizers =</span> <span class="s">&lt;NSArray:</span> <span class="err">0x16e94550</span><span class="nt">&gt;</span>; layer = <span class="nt">&lt;CALayer:</span> <span class="err">0x16e8fea0</span><span class="nt">&gt;</span>&gt;
  |    |    | <span class="nt">&lt;_UITextFieldRoundedRectBackgroundViewNeue:</span> <span class="err">0x16e92770;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">0;</span> <span class="err">304</span> <span class="err">30);</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">autoresize =</span> <span class="s">W+H;</span> <span class="na">userInteractionEnabled =</span> <span class="s">NO;</span> <span class="na">layer =</span> <span class="s">&lt;CALayer:</span> <span class="err">0x16e92990</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;UIButton:</span> <span class="err">0x16d901e0;</span> <span class="na">frame =</span> <span class="s">(8</span> <span class="err">191;</span> <span class="err">304</span> <span class="err">30);</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">autoresize =</span> <span class="s">RM+BM;</span> <span class="na">layer =</span> <span class="s">&lt;CALayer:</span> <span class="err">0x16d90490</span><span class="nt">&gt;</span>&gt;
  |    |    | <span class="nt">&lt;UIButtonLabel:</span> <span class="err">0x16e72b70;</span> <span class="na">frame =</span> <span class="s">(133</span> <span class="err">6;</span> <span class="err">38</span> <span class="err">18);</span> <span class="na">text =</span> <span class="s">&#39;Verify&#39;</span><span class="err">;</span> <span class="na">opaque =</span> <span class="s">NO;</span> <span class="na">userInteractionEnabled =</span> <span class="s">NO;</span> <span class="na">layer =</span> <span class="s">&lt;_UILabelLayer:</span> <span class="err">0x16e974b0</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;_UILayoutGuide:</span> <span class="err">0x16d92a00;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">0;</span> <span class="err">0</span> <span class="err">20);</span> <span class="na">hidden =</span> <span class="s">YES;</span> <span class="na">layer =</span> <span class="s">&lt;CALayer:</span> <span class="err">0x16e936b0</span><span class="nt">&gt;</span>&gt;
  |    | <span class="nt">&lt;_UILayoutGuide:</span> <span class="err">0x16d92c10;</span> <span class="na">frame =</span> <span class="s">(0</span> <span class="err">568;</span> <span class="err">0</span> <span class="err">0);</span> <span class="na">hidden =</span> <span class="s">YES;</span> <span class="na">layer =</span> <span class="s">&lt;CALayer:</span> <span class="err">0x16d92cb0</span><span class="nt">&gt;</span>&gt;`
</code></pre></div>
<p>You can also use Cycript's built-in functions such as <code>choose</code> which searches the heap for instances of the given Objective-C class:</p>
<div class="highlight"><pre><span></span><code>cy# choose<span class="o">(</span>SBIconModel<span class="o">)</span>
<span class="o">[</span><span class="c1">#&quot;&lt;SBIconModel: 0x1590c8430&gt;&quot;]</span>
</code></pre></div>
<p>Learn more in the <a href="http://www.cycript.org/manual/" title="Cycript Manual">Cycript Manual</a>.</p>
<h3 id="cydia">Cydia<a class="headerlink" href="#cydia" title="Permanent link">&para;</a></h3>
<p>Cydia is an alternative app store developed by Jay Freeman (aka "saurik") for jailbroken devices. It provides a graphical user interface and a version of the Advanced Packaging Tool (APT). You can easily access many "unsanctioned" app packages through Cydia. Most jailbreaks install Cydia automatically.</p>
<p>Many tools on a jailbroken device can be installed by using Cydia, which is the unofficial AppStore for iOS devices and allows you to manage repositories. In Cydia you should add (if not already done by default) the following repositories by navigating to <strong>Sources</strong> -&gt; <strong>Edit</strong>, then clicking <strong>Add</strong> in the top left:</p>
<ul>
<li><a href="http://apt.thebigboss.org/repofiles/cydia/">http://apt.thebigboss.org/repofiles/cydia/</a>: One of the most popular repositories is BigBoss, which contains various packages, such as the BigBoss Recommended Tools package.</li>
<li><a href="https://cydia.akemi.ai/">https://cydia.akemi.ai/</a>: Add "Karen's Repo" to get the AppSync package.</li>
<li><a href="https://build.frida.re">https://build.frida.re</a>: Install Frida by adding the repository to Cydia.</li>
<li><a href="https://repo.chariz.io">https://repo.chariz.io</a>: Useful when managing your jailbreak on iOS 11.</li>
<li><a href="https://apt.bingner.com/">https://apt.bingner.com/</a>: Another repository, with quiet a few good tools, is Elucubratus, which gets installed when you install Cydia on iOS 12 using Unc0ver.</li>
</ul>
<blockquote>
<p>In case you are using the Sileo App Store, please keep in mind that the Sileo Compatibility Layer shares your sources between Cydia and Sileo, however, Cydia is unable to remove sources added in Sileo, and <a href="https://www.idownloadblog.com/2019/01/11/install-sileo-package-manager-on-unc0ver-jailbreak/" title="You can now install the Sileo package manager on the unc0ver jailbreak">Sileo is unable to remove sources added in Cydia</a>. Keep this in mind when you’re trying to remove sources.</p>
</blockquote>
<p>After adding all the suggested repositories above you can install the following useful packages from Cydia to get started:</p>
<ul>
<li>adv-cmds: Advanced command line, which includes tools such as finger, fingerd, last, lsvfs, md, and ps.</li>
<li>AppList: Allows developers to query the list of installed apps and provides a preference pane based on the list.</li>
<li>Apt: Advanced Package Tool, which you can use to manage the installed packages similarly to DPKG, but in a more friendly way. This allows you to install, uninstall, upgrade, and downgrade packages from your Cydia repositories. Comes from Elucubratus.</li>
<li>AppSync Unified: Allows you to sync and install unsigned iOS applications.</li>
<li>BigBoss Recommended Tools: Installs many useful command line tools for security testing including standard Unix utilities that are missing from iOS, including wget, unrar, less, and sqlite3 client.</li>
<li>class-dump: A command line tool for examining the Objective-C runtime information stored in Mach-O files and generating header files with class interfaces.</li>
<li>class-dump-z: A command line tool for examining the Swift runtime information stored in Mach-O files and generating header files with class interfaces. This is not available via Cydia, therefore please refer to <a href="https://iosgods.com/topic/6706-how-to-install-class-dump-z-on-any-64bit-idevices-how-to-use-it/" title="class-dump-z installation steps">installation steps</a> in order to get class-dump-z running on your iOS device. Note that class-dump-z is not maintained and does not work well with Swift. It is recommended to use <a href="#dsdump" title="dsdump">dsdump</a> instead.</li>
<li>Clutch: Used to decrypt an app executable.</li>
<li>Cycript: Is an inlining, optimizing, Cycript-to-JavaScript compiler and immediate-mode console environment that can be injected into running processes (associated to Substrate).</li>
<li>Cydia Substrate: A platform that makes developing third-party iOS add-ons easier via dynamic app manipulation or introspection.</li>
<li>cURL: Is a well known http client which you can use to download packages faster to your device. This can be a great help when you need to install different versions of Frida-server on your device for instance.</li>
<li>Darwin CC Tools: A useful set of tools like nm, and strip that are capable of auditing mach-o files.</li>
<li>IPA Installer Console: Tool for installing IPA application packages from the command line. After installing two commands will be available <code>installipa</code> and <code>ipainstaller</code> which are both the same.</li>
<li>Frida: An app you can use for dynamic instrumentation. Please note that Frida has changed its implementation of its APIs over time, which means that some scripts might only work with specific versions of the Frida-server (which forces you to update/downgrade the version also on macOS). Running Frida Server installed via APT or Cydia is recommended. Upgrading/downgrading afterwards can be done, by following the instructions of <a href="https://github.com/AloneMonkey/frida-ios-dump/issues/65#issuecomment-490790602" title="Resolving Frida version">this Github issue</a>.</li>
<li>Grep: Handy tool to filter lines.</li>
<li>Gzip: A well known ZIP utility.</li>
<li>PreferenceLoader: A Substrate-based utility that allows developers to add entries to the Settings application, similar to the SettingsBundles that App Store apps use.</li>
<li>SOcket CAT: a utility with which you can connect to sockets to read and write messages. This can come in handy if you want to trace the syslog on iOS 12 devices.</li>
</ul>
<p>Besides Cydia there are several other open source tools available and should be installed, such as <a href="https://github.com/iSECPartners/Introspy-iOS" title="Introspy-iOS">Introspy</a>.</p>
<p>Besides Cydia you can also ssh into your iOS device and you can install the packages directly via apt-get, like for example adv-cmds.</p>
<div class="highlight"><pre><span></span><code>$ apt-get update
$ apt-get install adv-cmds
</code></pre></div>
<h3 id="dsdump">dsdump<a class="headerlink" href="#dsdump" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/DerekSelander/dsdump" title="dsdump">dsdump</a> is a tool to dump Objective-C classes and Swift type descriptors (classes, structs, enums). It only supports Swift version 5 or higher and does not support ARM 32-bit binaries.</p>
<p>The following example shows how you can dump Objective-C classes and Swift type descriptors of an iOS application.</p>
<p>First verify if the app's main binary is a FAT binary containing ARM64:</p>
<div class="highlight"><pre><span></span><code>$ otool -hv <span class="o">[</span>APP_MAIN_BINARY_FILE<span class="o">]</span>
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
   MH_MAGIC     ARM         V7  0x00     EXECUTE    <span class="m">39</span>       <span class="m">5016</span>   NOUNDEFS DYLDLINK TWOLEVEL PIE
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64   ARM64        ALL  0x00     EXECUTE    <span class="m">38</span>       <span class="m">5728</span>   NOUNDEFS DYLDLINK TWOLEVEL PIE
</code></pre></div>
<p>If yes, then we specify the "--arch" parameter to "arm64", otherwise it is not needed if the binary only contains an ARM64 binary.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dump the Objective-C classes to a temporary file</span>
$ dsdump --objc --color --verbose<span class="o">=</span><span class="m">5</span> --arch arm64 --defined <span class="o">[</span>APP_MAIN_BINARY_FILE<span class="o">]</span> &gt; /tmp/OBJC.txt

<span class="c1"># Dump the Swift type descriptors to a temporary file if the app is implemented in Swift</span>
$ dsdump --swift --color --verbose<span class="o">=</span><span class="m">5</span> --arch arm64 --defined <span class="o">[</span>APP_MAIN_BINARY_FILE<span class="o">]</span> &gt; /tmp/SWIFT.txt
</code></pre></div>
<p>You can find more information about the inner workings of dsdump and how to programmatically inspect a Mach-O binary to display the compiled Swift types and Objective-C classes in <a href="https://derekselander.github.io/dsdump/" title="Building a class-dump in 2020">this article</a>.</p>
<h3 id="dumpdecrypted">Dumpdecrypted<a class="headerlink" href="#dumpdecrypted" title="Permanent link">&para;</a></h3>
<p>Dumpdecrypted dumps decrypted mach-o files from encrypted iPhone applications from memory to disk - <a href="https://github.com/stefanesser/dumpdecrypted">https://github.com/stefanesser/dumpdecrypted</a></p>
<h3 id="filezilla">FileZilla<a class="headerlink" href="#filezilla" title="Permanent link">&para;</a></h3>
<p>A solution supporting FTP, SFTP, and FTPS (FTP over SSL/TLS) - <a href="https://filezilla-project.org/download.php?show_all=1">https://filezilla-project.org/download.php?show_all=1</a></p>
<p>Make sure that the following is installed on your system:</p>
<h3 id="frida-cycript">Frida-cycript<a class="headerlink" href="#frida-cycript" title="Permanent link">&para;</a></h3>
<p>A fork of Cycript including a brand new runtime called Mjølner powered by Frida. This enables frida-cycript to run on all the platforms and architectures maintained by frida-core - <a href="https://github.com/nowsecure/frida-cycript">https://github.com/nowsecure/frida-cycript</a></p>
<h3 id="frida-ios-dump">Frida-ios-dump<a class="headerlink" href="#frida-ios-dump" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/AloneMonkey/frida-ios-dump" title="Frida-ios-dump">Frida-ios-dump</a> is a Python script that helps you retrieve the decrypted version of an iOS app (IPA) from an iOS device. It supports both Python 2 and Python 3 and requires Frida running on your iOS device (jailbroken or not). This tool uses Frida's <a href="https://www.frida.re/docs/javascript-api/#memory" title="Frida Memory API">Memory API</a> to dump the memory of the running app and recreate an IPA file. Because the code is extracted from memory, it is automatically decrypted. Please refer to the section <a href="#using-frida-ios-dump" title="Using Frida-ios-dump">"Using Frida-ios-dump"</a> for detailed instructions on how to use it.</p>
<h3 id="fridpa">Fridpa<a class="headerlink" href="#fridpa" title="Permanent link">&para;</a></h3>
<p>An automated wrapper script for patching iOS applications (IPA files) and work on non-jailbroken device - <a href="https://github.com/tanprathan/Fridpa">https://github.com/tanprathan/Fridpa</a></p>
<h3 id="gdb">gdb<a class="headerlink" href="#gdb" title="Permanent link">&para;</a></h3>
<p>A tool to perform runtime analysis of iOS applications - <a href="https://cydia.radare.org/pool/main/g/gdb/">https://cydia.radare.org/pool/main/g/gdb/</a></p>
<h3 id="ifunbox">iFunBox<a class="headerlink" href="#ifunbox" title="Permanent link">&para;</a></h3>
<p><a href="http://www.i-funbox.com/" title="iFunBox">iFunBox</a> is a file and app management tool that supports iOS. You can <a href="http://www.i-funbox.com/en_download.html" title="iFunBox">download it for Windows and macOS</a>.</p>
<p>It has several features, like app installation, access the app sandbox without jailbreak and others.</p>
<h3 id="introspy-ios">Introspy-iOS<a class="headerlink" href="#introspy-ios" title="Permanent link">&para;</a></h3>
<p>Blackbox tool to help understand what an iOS application is doing at runtime and assist in the identification of potential security issues - <a href="https://github.com/iSECPartners/Introspy-iOS">https://github.com/iSECPartners/Introspy-iOS</a></p>
<h3 id="iosbackup">iOSbackup<a class="headerlink" href="#iosbackup" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/avibrazil/iOSbackup"><code>iOSbackup</code></a> is a Python 3 class that reads and extracts files from a password-encrypted iOS backup created by iTunes on Mac and Windows.</p>
<h3 id="ios-deploy">ios-deploy<a class="headerlink" href="#ios-deploy" title="Permanent link">&para;</a></h3>
<p>With <a href="https://github.com/ios-control/ios-deploy" title="ios-deploy">ios-deploy</a> you can install and debug iOS apps from the command line, without using Xcode. It can be installed via brew on macOS:</p>
<div class="highlight"><pre><span></span><code>$ brew install ios-deploy
</code></pre></div>
<p>Alternatively:</p>
<div class="highlight"><pre><span></span><code>$ git clone https://github.com/ios-control/ios-deploy.git
$ <span class="nb">cd</span> ios-deploy/
$ xcodebuild
$ <span class="nb">cd</span> build/Release
$ ./ios-deploy
$ ln -s &lt;your-path-to-ios-deploy&gt;/build/Release/ios-deploy /usr/local/bin/ios-deploy
</code></pre></div>
<p>The last line creates a symbolic link and makes the executable available system-wide. Reload your shell to make the new commands available:</p>
<div class="highlight"><pre><span></span><code>zsh: <span class="c1"># . ~/.zshrc</span>
bash: <span class="c1"># . ~/.bashrc</span>
</code></pre></div>
<h3 id="iproxy">iProxy<a class="headerlink" href="#iproxy" title="Permanent link">&para;</a></h3>
<p>A tool used to connect via SSH to a jailbroken iPhone via USB - <a href="https://github.com/tcurdt/iProxy">https://github.com/tcurdt/iProxy</a></p>
<h3 id="itunnel">itunnel<a class="headerlink" href="#itunnel" title="Permanent link">&para;</a></h3>
<p>A tool used to forward SSH via USB - <a href="https://code.google.com/p/iphonetunnel-usbmuxconnectbyport/downloads/list">https://code.google.com/p/iphonetunnel-usbmuxconnectbyport/downloads/list</a></p>
<h3 id="keychain-dumper">Keychain-Dumper<a class="headerlink" href="#keychain-dumper" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/mechanico/Keychain-Dumper" title="keychain-dumper">Keychain-dumper</a> is an iOS tool to check which keychain items are available to an attacker once an iOS device has been jailbroken. The easiest way to get the tool is to download the binary from its GitHub repo and run it from your device:</p>
<div class="highlight"><pre><span></span><code>$ git clone https://github.com/ptoomey3/Keychain-Dumper
$ scp -P <span class="m">2222</span> Keychain-Dumper/keychain_dumper root@localhost:/tmp/
$ ssh -p <span class="m">2222</span> root@localhost
iPhone:~ root# chmod +x /tmp/keychain_dumper
iPhone:~ root# /tmp/keychain_dumper
</code></pre></div>
<p>For usage instructions please refer to the <a href="https://github.com/mechanico/Keychain-Dumper" title="keychain-dumper">Keychain-dumper</a> GitHub page.</p>
<h3 id="lldb">lldb<a class="headerlink" href="#lldb" title="Permanent link">&para;</a></h3>
<p>A debugger by Apple’s Xcode used for debugging iOS applications - <a href="https://lldb.llvm.org/">https://lldb.llvm.org/</a></p>
<h3 id="machooview">MachoOView<a class="headerlink" href="#machooview" title="Permanent link">&para;</a></h3>
<p><a href="https://sourceforge.net/projects/machoview/" title="MachOView">MachoOView</a> is a useful visual Mach-O file browser that also allows in-file editing of ARM binaries.</p>
<h3 id="optool">optool<a class="headerlink" href="#optool" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/alexzielenski/optool">optool</a> is a tool which interfaces with MachO binaries in order to insert/remove load commands, strip code signatures, resign, and remove aslr.</p>
<p>To install it:</p>
<div class="highlight"><pre><span></span><code>$ git clone https://github.com/alexzielenski/optool.git
$ <span class="nb">cd</span> optool/
$ git submodule update --init --recursive
$ xcodebuild
$ ln -s &lt;your-path-to-optool&gt;/build/Release/optool /usr/local/bin/optool
</code></pre></div>
<p>The last line creates a symbolic link and makes the executable available system-wide. Reload your shell to make the new commands available:</p>
<div class="highlight"><pre><span></span><code>zsh: <span class="c1"># . ~/.zshrc</span>
bash: <span class="c1"># . ~/.bashrc</span>
</code></pre></div>
<h3 id="otool">otool<a class="headerlink" href="#otool" title="Permanent link">&para;</a></h3>
<p><a href="http://www.manpagez.com/man/1/otool/" title="otool">otool</a> is a tool for displaying specific parts of object files or libraries. It works with Mach-O files and universal file formats.</p>
<h3 id="passionfruit">Passionfruit<a class="headerlink" href="#passionfruit" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/chaitin/passionfruit/" title="Passionfruit">Passionfruit</a> is an iOS app blackbox assessment tool that is using the Frida server on the iOS device and visualizes many standard app data via Vue.js-based GUI. It can be installed with npm.</p>
<div class="highlight"><pre><span></span><code>$ npm install -g passionfruit
$ passionfruit
listening on http://localhost:31337
</code></pre></div>
<p>When you execute the command <code>passionfruit</code> a local server will be started on port 31337. Connect your jailbroken device with the Frida server running, or a non-jailbroken device with a repackaged app including Frida to your macOS device via USB. Once you click on the "iPhone" icon you will get an overview of all installed apps:</p>
<p><img src="../../assets/Images/Chapters/0x06b/Passionfruit.png" width="100%" /></p>
<p>With Passionfruit it's possible to explore different kinds of information concerning an iOS app. Once you selected the iOS app you can perform many tasks such as:</p>
<ul>
<li>Get information about the binary</li>
<li>View folders and files used by the application and download them</li>
<li>Inspect the Info.plist</li>
<li>Get a UI Dump of the app screen shown on the iOS device</li>
<li>List the modules that are loaded by the app</li>
<li>Dump class names</li>
<li>Dump keychain items</li>
<li>Access to NSLog traces</li>
</ul>
<h3 id="plutil">Plutil<a class="headerlink" href="#plutil" title="Permanent link">&para;</a></h3>
<p>A program that can convert .plist files between a binary version and an XML version - <a href="https://www.theiphonewiki.com/wiki/Plutil">https://www.theiphonewiki.com/wiki/Plutil</a></p>
<h3 id="sileo">Sileo<a class="headerlink" href="#sileo" title="Permanent link">&para;</a></h3>
<p>Since iOS 11 jailbreaks are introducing <a href="https://cydia-app.com/sileo/" title="Sileo">Sileo</a>, which is a new jailbreak app-store for iOS devices. The jailbreak <a href="https://chimera.sh/" title="Chimera">Chimera</a> for iOS 12 is also relying on Sileo as a package manager.</p>
<h3 id="simctl">simctl<a class="headerlink" href="#simctl" title="Permanent link">&para;</a></h3>
<p>simctl is an Xcode tool that allows you to interact with iOS simulators via the command line to e.g. manage simulators, launch apps, take screenshots or collect their logs.</p>
<h3 id="ssl-kill-switch-2">SSL Kill Switch 2<a class="headerlink" href="#ssl-kill-switch-2" title="Permanent link">&para;</a></h3>
<p>Blackbox tool to disable SSL certificate validation - including certificate pinning - within iOS and macOS Apps - <a href="https://github.com/nabla-c0d3/ssl-kill-switch2">https://github.com/nabla-c0d3/ssl-kill-switch2</a></p>
<h3 id="swift-demangle">swift-demangle<a class="headerlink" href="#swift-demangle" title="Permanent link">&para;</a></h3>
<p>swift-demangle is an Xcode tool that demangles Swift symbols. For more information run <code>xcrun swift-demangle -help</code> once installed.</p>
<h3 id="tableplus">TablePlus<a class="headerlink" href="#tableplus" title="Permanent link">&para;</a></h3>
<p><a href="https://tableplus.io/" title="TablePlus">TablePlus</a> is a tool for Windows and macOS to inspect database files, like Sqlite and others. This can be very useful during iOS engagements when dumping the database files from the iOS device and analyzing the content of them with a GUI tool.</p>
<h3 id="usbmuxd">Usbmuxd<a class="headerlink" href="#usbmuxd" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/libimobiledevice/usbmuxd" title="usbmuxd">usbmuxd</a> is a socket daemon that monitors USB iPhone connections. You can use it to map the mobile device's localhost listening sockets to TCP ports on your host computer. This allows you to conveniently SSH into your iOS device without setting up an actual network connection. When usbmuxd detects an iPhone running in normal mode, it connects to the phone and begins relaying requests that it receives via <code>/var/run/usbmuxd</code>.</p>
<h3 id="weak-classdump">Weak Classdump<a class="headerlink" href="#weak-classdump" title="Permanent link">&para;</a></h3>
<p>A Cycript script that generates a header file for the class passed to the function. Most useful when classdump or dumpdecrypted cannot be used, when binaries are encrypted etc - <a href="https://github.com/limneos/weak_classdump">https://github.com/limneos/weak_classdump</a></p>
<h3 id="xcode">Xcode<a class="headerlink" href="#xcode" title="Permanent link">&para;</a></h3>
<p>Xcode is an Integrated Development Environment (IDE) for macOS that contains a suite of tools for developing software for macOS, iOS, watchOS, and tvOS. You can <a href="https://developer.apple.com/xcode/ide/" title="Apple Xcode IDE">download Xcode for free from the official Apple website</a>. Xcode will offer you different tools and functions to interact with an iOS device that can be helpful during a penetration test, such as analyzing logs or sideloading of apps.</p>
<h3 id="xcode-command-line-tools">Xcode Command Line Tools<a class="headerlink" href="#xcode-command-line-tools" title="Permanent link">&para;</a></h3>
<p>After installing <a href="#xcode">Xcode</a>, in order to make all development tools available systemwide, it is recommended to install the Xcode Command Line Tools package. This will be handy during testing of iOS apps as some of the tools (e.g. objection) are also relying on the availability of this package. You can <a href="https://developer.apple.com/download/more/" title="Apple iOS SDK">download it from the official Apple website</a> or install it straight away from your terminal:</p>
<div class="highlight"><pre><span></span><code>$ xcode-select --install
</code></pre></div>
<h3 id="xcrun">xcrun<a class="headerlink" href="#xcrun" title="Permanent link">&para;</a></h3>
<p><a href="http://www.manpagez.com/man/1/xcrun/" title="xcrun man page"><code>xcrun</code></a> can be used invoke Xcode developer tools from the command-line, without having them in the path. For example you may want to use it to locate and run swift-demangle or simctl.</p>
<h2 id="tools-for-network-interception-and-monitoring">Tools for Network Interception and Monitoring<a class="headerlink" href="#tools-for-network-interception-and-monitoring" title="Permanent link">&para;</a></h2>
<h3 id="android-tcpdump">Android tcpdump<a class="headerlink" href="#android-tcpdump" title="Permanent link">&para;</a></h3>
<p>A command line packet capture utility for Android - <a href="https://www.androidtcpdump.com">https://www.androidtcpdump.com</a></p>
<h3 id="bettercap">bettercap<a class="headerlink" href="#bettercap" title="Permanent link">&para;</a></h3>
<p>A powerful framework which aims to offer to security researchers and reverse engineers an easy to use, all-in-one solution for Wi-Fi, Bluetooth Low Energy, wireless HID hijacking and Ethernet networks reconnaissance. It can be used during network penetration tests in order to simulate a man-in-the-middle (MITM) attack. This is achieved by executing <a href="https://en.wikipedia.org/wiki/ARP_spoofing" title="ARP poisoning/spoofing">ARP poisoning or spoofing</a> to the target computers. When such an attack is successful, all packets between two computers are redirected to a third computer that acts as the man-in-the-middle and is able to intercept the traffic for analysis.</p>
<blockquote>
<p>bettercap is a powerful tool to execute MITM attacks and should be preferred nowadays, instead of ettercap. See also <a href="https://www.bettercap.org/legacy/#why-another-mitm-tool" title="Why another MITM tool?">Why another MITM tool?</a> on the bettercap site.</p>
</blockquote>
<p>bettercap is available for all major Linux and Unix operating systems and should be part of their respective package installation mechanisms. You need to install it on your host computer that will act as the MITM. On macOS it can be installed by using brew.</p>
<div class="highlight"><pre><span></span><code>$ brew install bettercap
</code></pre></div>
<p>For Kali Linux you can install bettercap with <code>apt-get</code>:</p>
<div class="highlight"><pre><span></span><code>$ apt-get update
$ apt-get install bettercap
</code></pre></div>
<p>There are installation instructions as well for Ubuntu Linux 18.04 on <a href="https://linuxhint.com/install-bettercap-on-ubuntu-18-04-and-use-the-events-stream/" title="Install Bettercap on Ubuntu 18.04">LinuxHint</a>.</p>
<h3 id="burp-suite">Burp Suite<a class="headerlink" href="#burp-suite" title="Permanent link">&para;</a></h3>
<p>Burp Suite is an integrated platform for performing security testing mobile and web applications - <a href="https://portswigger.net/burp/releases">https://portswigger.net/burp/releases</a></p>
<p>Its tools work together seamlessly to support the entire testing process, from initial mapping and analysis of attack surfaces to finding and exploiting security vulnerabilities. Burp Proxy operates as a web proxy server for Burp Suite, which is positioned as a man-in-the-middle between the browser and web server(s). Burp Suite allows you to intercept, inspect, and modify incoming and outgoing raw HTTP traffic.</p>
<p>Setting up Burp to proxy your traffic is pretty straightforward. We assume that both your device and host computer are connected to a Wi-Fi network that permits client-to-client traffic.</p>
<p>PortSwigger provides good tutorials on setting up both Android as iOS devices to work with Burp:</p>
<ul>
<li><a href="https://support.portswigger.net/customer/portal/articles/1841101-configuring-an-android-device-to-work-with-burp" title="Configuring an Android Device to Work With Burp">Configuring an Android Device to Work With Burp</a>.</li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1841102-installing-burp-s-ca-certificate-in-an-android-device" title="Installing Burp\'s CA Certificate in an Android Device">Installing Burp's CA certificate to an Android device</a>.</li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp" title="Configuring an iOS Device to Work With Burp">Configuring an iOS Device to Work With Burp</a>.</li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device" title="Installing Burp\'s CA Certificate in an iOS Device">Installing Burp's CA certificate to an iOS device</a>.</li>
</ul>
<p>Please refer to the section "Setting up an Interception Proxy" in the <a href="../0x05b-Basic-Security_Testing/#setting-up-an-interception-proxy" title="Setting up an Interception Proxy">Android</a> and <a href="../0x06b-Basic-Security-Testing/#setting-up-an-interception-proxy" title="Setting up an Interception Proxy">iOS</a> "Basic Security Testing" chapters for more information.</p>
<h3 id="mitm-relay">MITM Relay<a class="headerlink" href="#mitm-relay" title="Permanent link">&para;</a></h3>
<p>A script to intercept and modify non-HTTP protocols through Burp and others with support for SSL and STARTTLS interception - <a href="https://github.com/jrmdev/mitm_relay">https://github.com/jrmdev/mitm_relay</a></p>
<h3 id="owasp-zap">OWASP ZAP<a class="headerlink" href="#owasp-zap" title="Permanent link">&para;</a></h3>
<p><a href="https://owasp.org/www-project-zap/" title="OWASP ZAP">OWASP ZAP</a> (Zed Attack Proxy) is a free security tool which helps to automatically find security vulnerabilities in web applications and web services - <a href="https://github.com/zaproxy/zaproxy">https://github.com/zaproxy/zaproxy</a></p>
<h3 id="tcpdump">tcpdump<a class="headerlink" href="#tcpdump" title="Permanent link">&para;</a></h3>
<p>A command line packet capture utility - <a href="https://www.tcpdump.org/">https://www.tcpdump.org/</a></p>
<h3 id="wireshark">Wireshark<a class="headerlink" href="#wireshark" title="Permanent link">&para;</a></h3>
<p>An open-source packet analyzer - <a href="https://www.wireshark.org/download.html">https://www.wireshark.org/download.html</a></p>
<h2 id="vulnerable-applications">Vulnerable applications<a class="headerlink" href="#vulnerable-applications" title="Permanent link">&para;</a></h2>
<p>The applications listed below can be used as training materials. Note: only the MSTG apps and Crackmes are tested and maintained by the MSTG project.</p>
<h3 id="android">Android<a class="headerlink" href="#android" title="Permanent link">&para;</a></h3>
<ul>
<li>Crackmes: A set of apps to test your Android application hacking skills - <a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes">https://github.com/OWASP/owasp-mstg/tree/master/Crackmes</a></li>
<li>AndroGoat: An open source vulnerable/insecure app using Kotlin. This app has a wide range of vulnerabilities related to certificate pinning, custom URL schemes, Android Network Security Configuration, WebViews, root detection and over 20 other vulnerabilities - <a href="https://github.com/satishpatnayak/AndroGoat">https://github.com/satishpatnayak/AndroGoat</a></li>
<li>DVHMA: A hybrid mobile app (for Android) that intentionally contains vulnerabilities - <a href="https://github.com/logicalhacking/DVHMA">https://github.com/logicalhacking/DVHMA</a></li>
<li>Digitalbank: A vulnerable app created in 2015, which can be used on older Android platforms - <a href="https://github.com/CyberScions/Digitalbank">https://github.com/CyberScions/Digitalbank</a></li>
<li>DIVA Android: An app intentionally designed to be insecure which has received updates in 2016 and contains 13 different challenges - <a href="https://github.com/payatu/diva-android">https://github.com/payatu/diva-android</a></li>
<li>DodoVulnerableBank: An insecure Android app from 2015 - <a href="https://github.com/CSPF-Founder/DodoVulnerableBank">https://github.com/CSPF-Founder/DodoVulnerableBank</a></li>
<li>InsecureBankv2: A vulnerable Android app made for security enthusiasts and developers to learn the Android insecurities by testing a vulnerable application. It has been updated in 2018 and contains a lot of vulnerabilities - <a href="https://github.com/dineshshetty/Android-InsecureBankv2">https://github.com/dineshshetty/Android-InsecureBankv2</a></li>
<li>MSTG Android app: Java - A vulnerable Android app with vulnerabilities similar to the test cases described in this document - <a href="https://github.com/OWASP/MSTG-Hacking-Playground/tree/master/Android/MSTG-Android-Java-App">https://github.com/OWASP/MSTG-Hacking-Playground/tree/master/Android/MSTG-Android-Java-App</a></li>
<li>MSTG Android app: Kotlin - A vulnerable Android app with vulnerabilities similar to the test cases described in this document - <a href="https://github.com/OWASP/MSTG-Hacking-Playground/tree/master/Android/MSTG-Android-Kotlin-App">https://github.com/OWASP/MSTG-Hacking-Playground/tree/master/Android/MSTG-Android-Kotlin-App</a></li>
</ul>
<h3 id="ios">iOS<a class="headerlink" href="#ios" title="Permanent link">&para;</a></h3>
<ul>
<li>Crackmes: A set of applications to test your iOS application hacking skills - <a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes">https://github.com/OWASP/owasp-mstg/tree/master/Crackmes</a></li>
<li>Myriam: A vulnerable iOS app with iOS security challenges - <a href="https://github.com/GeoSn0w/Myriam">https://github.com/GeoSn0w/Myriam</a></li>
<li>DVIA: A vulnerable iOS app written in Objective-C which provides a platform to mobile security enthusiasts/professionals or students to test their iOS penetration testing skills - <a href="http://damnvulnerableiosapp.com/">http://damnvulnerableiosapp.com/</a></li>
<li>DVIA-v2: A vulnerable iOS app, written in Swift with over 15 vulnerabilities - <a href="https://github.com/prateek147/DVIA-v2">https://github.com/prateek147/DVIA-v2</a></li>
<li>iGoat: An iOS Objective-C app serving as a learning tool for iOS developers (iPhone, iPad, etc.) and mobile app pentesters. It was inspired by the WebGoat project, and has a similar conceptual flow to it - <a href="https://github.com/owasp/igoat">https://github.com/owasp/igoat</a></li>
<li>iGoat-Swift: A Swift version of original iGoat project - <a href="https://github.com/owasp/igoat-swift">https://github.com/owasp/igoat-swift</a></li>
<li>UnSAFE Bank: UnSAFE Bank is a core virtual banking application designed with the aim to incorporate the cyber security risks and various test cases such that newbie, developers, and security analysts can learn, hack and improvise their vulnerability assessment and penetration testing skills. - <a href="https://github.com/lucideus-repo/UnSAFE_Bank">https://github.com/lucideus-repo/UnSAFE_Bank</a></li>
</ul>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0x07-Appendix/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Appendix" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Appendix
            </div>
          </div>
        </a>
      
      
        
        <a href="../0x09-Suggested-Reading/" class="md-footer__link md-footer__link--next" aria-label="Next: Suggested Reading" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Suggested Reading
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <div style="float: left; padding-right: 1em;">
  <a href="https://www.owasp.org"><img src="https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/OWASP_logo_white.png?raw=true" width="100px" /></a>
</div>
<span>
  &#169; OWASP Foundation 2022. This work is licensed under 
  <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>. For any reuse or distribution, you must make clear to others the license terms of this work.
</span>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://owasp.slack.com/messages/project-mobile_omtg/details/" target="_blank" rel="noopener" title="owasp.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/OWASP_MSTG" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/OWASP/owasp-mstg/discussions" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.instant", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "navigation.top"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>